' Gambas class file

Private $sDevice As String
Private $sValue As String

Private asx As String

Public Sub Run(sDevice As String) As String

  $sDevice = sDevice
  modGeneralMain.GetOpenModalForm(Me)

  If Me.ShowModal() Then Return $sValue

End

Public Sub WebContainer4_Render()

  Print "<div id='my-qr-reader'></div>"

End

' Public Sub WebTextBox1_Activate()
'
'   btnselect_Click()
'
' End

Public Sub btnselect_Click()

  WebTextBox1.SetFocus
  asx = "$_(" & JS(WebTextBox1.Name & ":entry") & ").value = qrvalue;"
  asx = asx & " gw.update(" & JS(WebTextBox1.Name) & ", 'text', qrvalue);"
  Me.Exec(asx)

End

Public Sub btnclose_Click()

  $sValue = WebTextBox1.Text
  If $sValue Then
    Me.Close(True)
  Else
    Me.Close()
  Endif

End

Public Sub WebTimer1_Timer()

  WebTimer1.Enabled = False
  WebForm.Current.Reload()

End
