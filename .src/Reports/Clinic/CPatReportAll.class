' Gambas class file

Private encid As String
Private $status As String

Public Sub _new(xencid As String)

  encid = xencid
  $status = modPatient.CurrentAdmissionStatus(encid)

End

Private Sub AddPatReportColl(sChapter As String, sObservation As String)

  Select $status
    Case "Recorded", "Registered", "Admitted"
    Case Else
      modPatReportAll.$patReportColl.Add(sObservation, encid & "|" & sChapter)
  End Select

End

Private Function AddCustomReport(stChapter As String, stObservation As String) As String[]

  Dim asx As New String[0]

  If Len(Trim(stObservation)) Then
    With asx
      If modBasic.$MedRepoBody = "Paragraph" Then
        .Add("<b>" & stChapter & "</b><br>" & modString.TextToHTML(stObservation))
      Else
        .Add(stChapter)
        .Add(modString.TextToHTML(stObservation))
      Endif
    End With
  Endif

  Return asx

End

''=============================== Public ============================================================
''--------------- Attached: General -----------------------
Public Function AddCourseOfTreatment(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Course of Treatment"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modClinicReport.GetCourseOfTreatment(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddBedTransition(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Bed Transitions"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientTransition(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddChiefComplaints(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Chief Complaints"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modClinicReport.GetPatientChiefComplaintsReport(encid, True))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddPatDemographics(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Demographics"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modClinicReport.GetPatientDemographicReport(encid, True))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddCauseofAdmission(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Cause of Admission"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetPatientHistoryReport(encid, "Cause of Admission")
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddHistoryAllTypes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "History"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modClinicReport.GetPatientHistoryAllTypes(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddConsultationAll(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Consultations"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatient.GetPatientCOnsultList(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddProvisionalDiagnosis(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Provisional Diagnosis"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatient.PatientFindingList(encid, "Provisional Diagnosis"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddFinalDiagnosis(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Final Diagnosis"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatient.PatientFindingList(encid, "Final Diagnosis"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDrugAllergy(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Drug Allergy"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatient.PatientFindingList(encid, "Allergic Drugs"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddTreatmentAdvised(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Treatment Advised"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modClinicReport.GetRequestMedString(encid, "Medicines", True)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddUnavailableMeds(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Unavailable Medicines"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modClinicReport.NonAvailableMedString(encid, "Medicines", True)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddOutpatientAdvice(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Outpatient Advice"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetPatientNotesAllTypes(encid, "Outpatient Notes").Join(gb.NewLine)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddOrderForNewVisit(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Orders for New Visit"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetPastBillingOrders(encid)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddPlannedProcedures(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Planned Procedures"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatReports.GetPatProcedureList(encid, "Procedures", "Planned"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''------------------ Attached: Lab/Radio/Exam
Public Function AddExaminationsAll(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim categList As String[]
  Dim xcateg As String
  Dim xlist As String[]
  Dim xexams As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Clinical Findings"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    xexams = New String[]
    categList = ["ABC Examinations", "Essential Examinations", "Physician Examinations", "Nursing Examinations", "Discharge Examinations"]
    For Each xcateg In categList
      xlist = modPatReports.PaientSelExamNameArray(encid, xcateg)
      If xlist And If xlist.Count Then
        xexams.Add(xcateg & gb.NewLine & modClinicReport.GetExaminationHTMLProfile(encid, xlist))
      Endif
    Next
    stObservation = modString.GetHTMLListFormat(xexams)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)

  Return asx

End

Public Function AddStructuredExamAll(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim xexams As String[]

  Dim xphys As String
  Dim xdepat As String
  Dim xdigno As String

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Structured Finding"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    xexams = New String[]
    xphys = modClinicReport.GetRecommendedExam(encid, "Physician Examinations")
    If Len(Trim(xphys)) Then
      xexams.Add(xphys & gb.NewLine)
    Endif
    xdepat = modClinicReport.GetRecommendedExam(encid, "Departmental")
    If Len(Trim(xdepat)) Then
      xexams.Add(xdepat & gb.NewLine)
    Endif
    xdigno = modClinicReport.GetRecommendedExam(encid, "Diagnostic Examinations")
    If Len(Trim(xdigno)) Then
      xexams.Add(xdigno & gb.NewLine)
    Endif
    If xexams.Count Then
      stObservation = xexams.Join("<br>")
    Else
      stObservation = ""
    Endif
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)

  Return asx

End

''---------------------- Attached: Services ------------------------------
Public Function AddMajorProcedures(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Major Procedures"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatSurgery.PatSelectProcedureString(encid, "Procedures", "Done")
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddMinorProcedures(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Minor Procedures"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatReports.GetPatProcedureList(encid, "Minor Procedures", "Done"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddEquipmentsUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Equipments Used"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientEquipmentUse(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddEventProfile(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Event Timings"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientEventProfile(encid, "Events"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDevicesUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Devices Used"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientEventProfile(encid, "Devices"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddMedicationUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Medication Used"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPharmacy.NurDosingString(encid)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddVaccinesUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Vaccines used"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPharmacy.GetVaccineUsed(encid, False, False)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddNutritionUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Nutrition Consumed"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    ''stObservation = modPharmacy.NurDosingString(encid)
    ' AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''-------------------------- Attached: Inpatient -------------------
Public Function AddInpatientNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Inpatient Notes"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientNotesAllTypes(encid, "Inpatient Notes"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddTherapeuticPlanning(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Medical Planning"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientPlanningReport(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddIPMonitoring(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "IP Monitoring"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientMonitorReport(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDischargeNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Discharge Notes"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientNotesAllTypes(encid, "Discharge Notes"))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDeliveryProfile(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Delivery Profile"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modString.GetHTMLListFormat(modPatReports.DeliveryReportbyMother(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDischargeMedication(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Discharge Medication"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modClinicReport.DischargeMedString(encid)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''----------
Public Function AddLaboratoryTests(strUnit As String, Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Laboratory Tests"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetlaboratoryHTMLProfile(encid, modLabTest.PaientAllTestNameArray(encid), strUnit)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddCompleteLaboratory(strUnit As String, Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Laboratory Reports"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetCompleteLabTestByEnc(encid, strUnit)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddRadioFindings(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Radiological Findings"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetRadiologyHTMLProfile(encid, modRadioTest.PaientAllRadioNameArray(encid))
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddCompleteRadiology(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Radiological Reports"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetCompleteRadioTestByEnc(encid)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddGlassPrescription(Optional sTitle As String) As String[]

  Dim sExamList As String[] = ["Prescribed Glass", "Prescribed Glass Source", "Prescribed Glass Remarks"]
  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Glass Prescription"
  Endif

  If modPatReportAll.$patReportColl.Exist(encid & "|" & stChapter) Then
    stObservation = modPatReportAll.$patReportColl[encid & "|" & stChapter]
  Else
    stObservation = modPatReports.GetFormattedExaminationReport(encid, sExamList)
    AddPatReportColl(stChapter, stObservation)
  Endif

  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End
