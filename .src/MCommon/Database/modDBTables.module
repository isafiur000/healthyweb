' Gambas module file

Public $DbFormat As String
Public $DbEngine As String  ''InnoDB  ''HEAP

''====================== FIXED TABLES: CAN BE PUT REMOTELY ============================
''---------------------------- For CreateDatabaseForSish_Medicine( ----------------------------
Public Sub CREATEtblmedcategory($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedcategory") Then
    hTable = $con.Tables.Add("tblmedcategory", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flclass", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsensidrugs($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsensidrugs") Then
    hTable = $con.Tables.Add("tblsensidrugs", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flclass", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblchemclass($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblchemclass") Then
    hTable = $con.Tables.Add("tblchemclass", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flclass", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldosageforms($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldosageforms") Then
    hTable = $con.Tables.Add("tbldosageforms", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flforms", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmanufacturer($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmanufacturer") Then
    hTable = $con.Tables.Add("tblmanufacturer", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextradepartment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextradepartment") Then
    hTable = $con.Tables.Add("tblextradepartment", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flddepart", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedgroup") Then
    hTable = $con.Tables.Add("tblmedgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldmedgroup", db.String, 200)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcode($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcode") Then
    hTable = $con.Tables.Add("tblcode", $DbEngine)
    hTable.Fields.Add("fldcodename", db.String, 150)
    hTable.Fields.Add("fldrecaddose", db.Float)
    hTable.Fields.Add("fldrecaddoseunit", db.String, 25)
    hTable.Fields.Add("fldrecadfreq", db.Integer)
    hTable.Fields.Add("fldrecpeddose", db.Float)
    hTable.Fields.Add("fldrecpeddoseunit", db.String, 25)
    hTable.Fields.Add("fldrecpedfreq", db.Integer)
    hTable.Fields.Add("fldchemclass", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldprn", db.String, 25)
    hTable.Fields.Add("flddrugdetail", db.String, 255)
    hTable.Fields.Add("fldhelppage", db.String, 100)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldplasmaprotein", db.Float)
    hTable.Fields.Add("fldeliminhalflife", db.Float)
    hTable.Fields.Add("fldvoldistribution", db.Float)
    hTable.Fields.Add("fldeliminhepatic", db.Float)
    hTable.Fields.Add("fldeliminrenal", db.Float)
    hTable.Fields.Add("fldmechaction", db.String, 255)
    hTable.Fields.Add("fldsensname", db.String, 250)
    hTable.Fields.Add("fldrisklevel", db.String, 100)
    hTable.Fields.Add("fldvaccine", db.Boolean)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldcodename"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcodelimit($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcodelimit") Then
    hTable = $con.Tables.Add("tblcodelimit", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcodename", db.String, 200)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldmaxfreq", db.Integer)
    hTable.Fields.Add("fldmaxundose", db.Float)
    hTable.Fields.Add("fldmaxundoseunit", db.String, 25)
    hTable.Fields.Add("fldmaxdaladdose", db.Float)
    hTable.Fields.Add("fldmaxdaladdoseunit", db.String, 25)
    hTable.Fields.Add("fldmindaladdose", db.Float)
    hTable.Fields.Add("fldmindaladdoseunit", db.String, 25)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcompatdrug($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcompatdrug") Then
    hTable = $con.Tables.Add("tblcompatdrug", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcompatfluid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcompatfluid") Then
    hTable = $con.Tables.Add("tblcompatfluid", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldilutionfluid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldilutionfluid") Then
    hTable = $con.Tables.Add("tbldilutionfluid", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblincompatdrug($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblincompatdrug") Then
    hTable = $con.Tables.Add("tblincompatdrug", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblincompatfluid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblincompatfluid") Then
    hTable = $con.Tables.Add("tblincompatfluid", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblreconstfluid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblreconstfluid") Then
    hTable = $con.Tables.Add("tblreconstfluid", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldrug($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldrug") Then
    hTable = $con.Tables.Add("tbldrug", $DbEngine)
    hTable.Fields.Add("flddrug", db.String, 200)
    hTable.Fields.Add("fldcodename", db.String, 150)
    hTable.Fields.Add("fldstrength", db.Float)
    hTable.Fields.Add("fldstrunit", db.String, 25)
    hTable.Fields.Add("fldroute", db.String, 20)
    hTable.Fields.Add("flddoseunit", db.String, 100)
    hTable.Fields.Add("fldhelppage", db.String, 100)
    hTable.Fields.Add("fldciyear", db.Float)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flddrug"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblinjection($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblinjection") Then
    hTable = $con.Tables.Add("tblinjection", $DbEngine)
    hTable.Fields.Add("fldinjection", db.String, 255)
    hTable.Fields.Add("fldlabel", db.String, 250)
    hTable.Fields.Add("fldreconst", db.String, 255)
    hTable.Fields.Add("fldreconstroom", db.Float)
    hTable.Fields.Add("fldreconstcool", db.Float)
    hTable.Fields.Add("flddilution", db.String, 255)
    hTable.Fields.Add("flddilutionroom", db.Float)
    hTable.Fields.Add("flddilutioncool", db.Float)
    hTable.Fields.Add("fldrateadmin", db.String, 250)
    hTable.Fields.Add("fldsiteadmin", db.String, 250)
    hTable.Fields.Add("fldrouteadmin", db.String, 50)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldinjection"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbllabel($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbllabel") Then
    hTable = $con.Tables.Add("tbllabel", $DbEngine)
    hTable.Fields.Add("fldlabel", db.String, 225)
    hTable.Fields.Add("flddrug", db.String, 200)
    hTable.Fields.Add("fldroute", db.String, 20)
    hTable.Fields.Add("fldopinfo", db.String, 255)
    hTable.Fields.Add("fldipinfo", db.String, 255)
    hTable.Fields.Add("fldasepinfo", db.String, 255)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldmedinfo", db.String, 10000)
    Else
      hTable.Fields.Add("fldmedinfo", db.String)
    Endif
    hTable.Fields.Add("fldsubroute", db.String, 50)
    hTable.Fields.Add("fldfinalstr", db.Float)
    hTable.Fields.Add("fldopfont", db.String, 200)
    hTable.Fields.Add("fldosmolality", db.Float)
    hTable.Fields.Add("fldenergy", db.Float)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldlabel"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
    modDBApp.ChangeSingleCOlumnCOllation($con, "tbllabel", "fldopinfo", "VARCHAR( 255 )", "utf8mb4", "utf8mb4_unicode_ci")
  Endif

End

Public Sub CREATEtblmedbrand($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedbrand") Then
    hTable = $con.Tables.Add("tblmedbrand", $DbEngine)
    hTable.Fields.Add("fldbrandid", db.String, 250)
    hTable.Fields.Add("flddrug", db.String, 200)
    hTable.Fields.Add("flddosageform", db.String, 50)
    hTable.Fields.Add("fldbrand", db.String, 50)
    hTable.Fields.Add("fldmanufacturer", db.String, 200)
    hTable.Fields.Add("flddetail", db.String, 255)
    hTable.Fields.Add("fldstandard", db.String, 25)
    hTable.Fields.Add("fldpackvol", db.Float)
    hTable.Fields.Add("fldvolunit", db.String, 25)
    hTable.Fields.Add("fldpacksize", db.Integer)
    hTable.Fields.Add("fldmaxqty", db.Float)
    hTable.Fields.Add("fldminqty", db.Float)
    hTable.Fields.Add("fldleadtime", db.Integer)
    hTable.Fields.Add("fldpreservative", db.String, 250)
    hTable.Fields.Add("fldnarcotic", db.String, 10)
    hTable.Fields.Add("fldtabbreak", db.String, 10)
    hTable.Fields.Add("flddeflabel", db.String, 10)
    hTable.Fields.Add("fldactive", db.String, 10)
    hTable.Fields.Add("fldtaxcode", db.String, 150)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldbrandid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblregimen($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblregimen") Then
    hTable = $con.Tables.Add("tblregimen", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldroute", db.String, 25)
    hTable.Fields.Add("fldcodename", db.String, 150)
    hTable.Fields.Add("flddisease", db.String, 255)
    hTable.Fields.Add("flddosetype", db.String, 25)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldgender", db.String, 25)
    hTable.Fields.Add("flddose", db.Float)
    hTable.Fields.Add("flddoseunit", db.String, 25)
    hTable.Fields.Add("fldfreq", db.String, 50)
    hTable.Fields.Add("fldday", db.Integer)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedhepatic($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedhepatic") Then
    hTable = $con.Tables.Add("tblmedhepatic", $DbEngine)
    hTable.Fields.Add("medid", db.Serial)
    hTable.Fields.Add("fldcodename", db.String, 150)
    hTable.Fields.Add("fldcondition", db.String, 50)
    hTable.Fields.Add("fldoutput", db.String, 255)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["medid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldcodename_fldcondition", ["fldcodename", "fldcondition"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedinteraction($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedinteraction") Then
    hTable = $con.Tables.Add("tblmedinteraction", $DbEngine)
    hTable.Fields.Add("medid", db.Serial)
    hTable.Fields.Add("fldcodename", db.String, 150)
    hTable.Fields.Add("fldcondition", db.String, 150)
    hTable.Fields.Add("fldoutput", db.String, 255)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["medid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldcodename_fldcondition", ["fldcodename", "fldcondition"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedpregnancy($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedpregnancy") Then
    hTable = $con.Tables.Add("tblmedpregnancy", $DbEngine)
    hTable.Fields.Add("medid", db.Serial)
    hTable.Fields.Add("fldcodename", db.String, 150)
    hTable.Fields.Add("fldcondition", db.String, 50)
    hTable.Fields.Add("fldoutput", db.String, 255)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["medid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldcodename_fldcondition", ["fldcodename", "fldcondition"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedrenal($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedrenal") Then
    hTable = $con.Tables.Add("tblmedrenal", $DbEngine)
    hTable.Fields.Add("medid", db.Serial)
    hTable.Fields.Add("fldcodename", db.String, 150)
    hTable.Fields.Add("fldgfrfrom", db.Float)
    hTable.Fields.Add("fldgfrto", db.Float)
    hTable.Fields.Add("fldoutput", db.String, 255)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["medid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldcodename_fldgfrfrom", ["fldcodename", "fldgfrfrom"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedcontraindication($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedcontraindication") Then
    hTable = $con.Tables.Add("tblmedcontraindication", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedadveffect($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedadveffect") Then
    hTable = $con.Tables.Add("tblmedadveffect", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedmonitor($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedmonitor") Then
    hTable = $con.Tables.Add("tblmedmonitor", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbllocallabel($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbllocallabel") Then
    hTable = $con.Tables.Add("tbllocallabel", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldengcode", db.String, 150)
    hTable.Fields.Add("fldengdire", db.String, 255)
    hTable.Fields.Add("fldfont", db.String, 255)
    hTable.Fields.Add("fldlocaldire", db.String, 255)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
    modDBApp.ChangeSingleCOlumnCOllation($con, "tbllocallabel", "fldlocaldire", "VARCHAR( 255 )", "utf8mb4", "utf8mb4_unicode_ci")
  Endif

End

Public Sub CREATEtblsurgicalname($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsurgicalname") Then
    hTable = $con.Tables.Add("tblsurgicalname", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsurgcateg", db.String, 25)
    hTable.Fields.Add("fldsurgname", db.String, 125)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsuturetype($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsuturetype") Then
    hTable = $con.Tables.Add("tblsuturetype", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsuturetype", db.String, 250)
    hTable.Fields.Add("fldsuturecode", db.String, 25)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsurgicals($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsurgicals") Then
    hTable = $con.Tables.Add("tblsurgicals", $DbEngine)
    hTable.Fields.Add("fldsurgid", db.String, 200)
    hTable.Fields.Add("fldsurgname", db.String, 125)
    hTable.Fields.Add("fldsurgcateg", db.String, 25)
    hTable.Fields.Add("fldsurgsize", db.String, 25)
    hTable.Fields.Add("fldsurgtype", db.String, 25)
    hTable.Fields.Add("fldsurgcode", db.String, 25)
    hTable.Fields.Add("fldsurgdetail", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldsurgid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsurgbrand($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsurgbrand") Then
    hTable = $con.Tables.Add("tblsurgbrand", $DbEngine)
    hTable.Fields.Add("fldbrandid", db.String, 250)
    hTable.Fields.Add("fldsurgid", db.String, 200)
    hTable.Fields.Add("fldbrand", db.String, 50)
    hTable.Fields.Add("fldmanufacturer", db.String, 200)
    hTable.Fields.Add("flddetail", db.String, 255)
    hTable.Fields.Add("fldstandard", db.String, 25)
    hTable.Fields.Add("flddepart", db.String, 200)
    hTable.Fields.Add("fldmaxqty", db.Float)
    hTable.Fields.Add("fldminqty", db.Float)
    hTable.Fields.Add("fldleadtime", db.Integer)
    hTable.Fields.Add("fldtaxcode", db.String, 150)
    hTable.Fields.Add("fldactive", db.String, 10)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldbrandid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextra($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextra") Then
    hTable = $con.Tables.Add("tblextra", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldextraid", db.String, 200)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextrabrand($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextrabrand") Then
    hTable = $con.Tables.Add("tblextrabrand", $DbEngine)
    hTable.Fields.Add("fldbrandid", db.String, 250)
    hTable.Fields.Add("fldextraid", db.String, 200)
    hTable.Fields.Add("fldbrand", db.String, 50)
    hTable.Fields.Add("fldpackvol", db.Float)
    hTable.Fields.Add("fldvolunit", db.String, 25)
    hTable.Fields.Add("fldmanufacturer", db.String, 200)
    hTable.Fields.Add("flddepart", db.String, 200)
    hTable.Fields.Add("flddetail", db.String, 255)
    hTable.Fields.Add("fldstandard", db.String, 25)
    hTable.Fields.Add("fldmaxqty", db.Float)
    hTable.Fields.Add("fldminqty", db.Float)
    hTable.Fields.Add("fldleadtime", db.Integer)
    hTable.Fields.Add("fldtaxcode", db.String, 150)
    hTable.Fields.Add("fldactive", db.String, 10)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldbrandid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''--- not coding
Public Sub CREATEtblproductgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblproductgroup") Then
    hTable = $con.Tables.Add("tblproductgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldmedgroup", db.String, 150)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldroute", db.String, 25)
    hTable.Fields.Add("flditem", db.String, 255)
    hTable.Fields.Add("flddose", db.Float)
    hTable.Fields.Add("flddoseunit", db.String, 25)
    hTable.Fields.Add("fldfreq", db.String, 50)
    hTable.Fields.Add("fldday", db.Integer)
    hTable.Fields.Add("fldqty", db.Float)
    hTable.Fields.Add("fldstart", db.Integer)
    hTable.Fields.Add("fldadvice", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmedregimen($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedregimen") Then
    hTable = $con.Tables.Add("tblmedregimen", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldroute", db.String, 25)
    hTable.Fields.Add("fldbrandid", db.String, 150)
    hTable.Fields.Add("flddose", db.Float)
    hTable.Fields.Add("fldfreq", db.String, 50)
    hTable.Fields.Add("fldday", db.Integer)
    hTable.Fields.Add("fldqty", db.Integer)
    hTable.Fields.Add("fldusage", db.String, 150)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''---- diet
Public Sub CREATEtblfoodlist($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfoodlist") Then
    hTable = $con.Tables.Add("tblfoodlist", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldfood", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfoodtype($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfoodtype") Then
    hTable = $con.Tables.Add("tblfoodtype", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldfoodtype", db.String, 200)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfoodcontent($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfoodcontent") Then
    hTable = $con.Tables.Add("tblfoodcontent", $DbEngine)
    hTable.Fields.Add("fldfoodid", db.String, 250)
    hTable.Fields.Add("fldfood", db.String, 150)
    hTable.Fields.Add("fldsource", db.String, 250)
    hTable.Fields.Add("fldformat", db.String, 150)
    hTable.Fields.Add("fldfoodtype", db.String, 50)
    hTable.Fields.Add("fldfoodcode", db.String, 100)
    hTable.Fields.Add("fldfluid", db.Float)
    hTable.Fields.Add("fldenergy", db.Float)
    hTable.Fields.Add("fldprotein", db.Float)
    hTable.Fields.Add("fldproteincont", db.String, 250)
    hTable.Fields.Add("fldsugar", db.Float)
    hTable.Fields.Add("fldsugarcont", db.String, 250)
    hTable.Fields.Add("fldlipid", db.Float)
    hTable.Fields.Add("fldlipidcont", db.String, 250)
    hTable.Fields.Add("fldmineral", db.Float)
    hTable.Fields.Add("fldfibre", db.Float)

    hTable.Fields.Add("fldcalcium", db.Float)
    hTable.Fields.Add("fldphosphorous", db.Float)
    hTable.Fields.Add("fldiron", db.Float)
    hTable.Fields.Add("fldcarotene", db.Float)
    hTable.Fields.Add("fldthiamine", db.Float)
    hTable.Fields.Add("fldriboflavin", db.Float)
    hTable.Fields.Add("fldniacin", db.Float)
    hTable.Fields.Add("fldpyridoxine", db.Float)
    hTable.Fields.Add("fldfreefolic", db.Float)
    hTable.Fields.Add("fldtotalfolic", db.Float)
    hTable.Fields.Add("fldvitaminc", db.Float)

    hTable.Fields.Add("fldprep", db.String, 255)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldfoodid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfoodmix($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfoodmix") Then
    hTable = $con.Tables.Add("tblfoodmix", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("fldtitle", db.String, 200)
    hTable.Fields.Add("fldstatus", db.String, 100)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfoodgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfoodgroup") Then
    hTable = $con.Tables.Add("tblfoodgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("flditemname", db.String, 200)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("fldprep", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 100)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldietgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldietgroup") Then
    hTable = $con.Tables.Add("tbldietgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("flditemtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemqty", db.Float)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblnutrition($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblnutrition") Then
    hTable = $con.Tables.Add("tblnutrition", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldfluid", db.Float)
    hTable.Fields.Add("fldprotein", db.Float)
    hTable.Fields.Add("fldlipid", db.Float)
    hTable.Fields.Add("flddextrose", db.Float)
    hTable.Fields.Add("fldnne", db.Float)
    hTable.Fields.Add("fldsodium", db.Float)
    hTable.Fields.Add("fldpotassium", db.Float)
    hTable.Fields.Add("fldvitamin", db.Float)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------------------FOR CreateDatabaseForSish_Pathology---------------------------
Public Sub CREATEtblpathocategory($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpathocategory") Then
    hTable = $con.Tables.Add("tblpathocategory", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flclass", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbodyfluid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbodyfluid") Then
    hTable = $con.Tables.Add("tblbodyfluid", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldfluid", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsurveillance($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsurveillance") Then
    hTable = $con.Tables.Add("tblsurveillance", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 250)
    hTable.Fields.Add("flddisease", db.String, 250)
    hTable.Fields.Add("fldcodeid", db.String, 250)
    hTable.Fields.Add("fldcodenew", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbilldisease($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbilldisease") Then
    hTable = $con.Tables.Add("tblbilldisease", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 250)
    hTable.Fields.Add("flddisease", db.String, 250)
    hTable.Fields.Add("fldcodeid", db.String, 250)
    hTable.Fields.Add("fldcodenew", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblethnicgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblethnicgroup") Then
    hTable = $con.Tables.Add("tblethnicgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroupname", db.String, 250)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldiagnogroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldiagnogroup") Then
    hTable = $con.Tables.Add("tbldiagnogroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroupname", db.String, 250)
    hTable.Fields.Add("fldformat", db.String, 150)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldcodeid", db.String, 25)
    hTable.Fields.Add("fldcodenew", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsymptoms($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsymptoms") Then
    hTable = $con.Tables.Add("tblsymptoms", $DbEngine)
    hTable.Fields.Add("fldsymptom", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldcode", db.String, 150)
    hTable.Fields.Add("fldsymdetail", db.String, 250)
    hTable.PrimaryKey = ["fldsymptom"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsubsymptoms($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsubsymptoms") Then
    hTable = $con.Tables.Add("tblsubsymptoms", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsymptom", db.String, 250)
    hTable.Fields.Add("fldsubsymptom", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpathosymp($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpathosymp") Then
    hTable = $con.Tables.Add("tblpathosymp", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldparenttype", db.String, 25)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldrelation", db.String, 25)
    hTable.Fields.Add("fldvalquali", db.String, 250)
    hTable.Fields.Add("fldvalquanti", db.Float)
    hTable.Fields.Add("fldsympfreq", db.String, 25)
    hTable.Fields.Add("fldbaserate", db.Float)
    hTable.Fields.Add("fldnegrate", db.Float)
    hTable.Fields.Add("fldhitrate", db.Float)
    hTable.Fields.Add("fldfalserate", db.Float)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsyndromes($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsyndromes") Then
    hTable = $con.Tables.Add("tblsyndromes", $DbEngine)
    hTable.Fields.Add("fldsyndrome", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldsymcode", db.String, 250)
    hTable.PrimaryKey = ["fldsyndrome"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpathotest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpathotest") Then
    hTable = $con.Tables.Add("tblpathotest", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldparenttype", db.String, 25)
    hTable.Fields.Add("fldtestcategory", db.String, 100)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldrelation", db.String, 25)
    hTable.Fields.Add("fldvalquali", db.String, 250)
    hTable.Fields.Add("fldvalquanti", db.Float)
    hTable.Fields.Add("fldtesttype", db.String, 50)
    hTable.Fields.Add("fldtestunit", db.String, 25)
    hTable.Fields.Add("fldbaserate", db.Float)
    hTable.Fields.Add("fldnegrate", db.Float)
    hTable.Fields.Add("fldhitrate", db.Float)
    hTable.Fields.Add("fldfalserate", db.Float)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpathoexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpathoexam") Then
    hTable = $con.Tables.Add("tblpathoexam", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldparenttype", db.String, 25)
    hTable.Fields.Add("fldexamcategory", db.String, 100)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldrelation", db.String, 25)
    hTable.Fields.Add("fldvalquali", db.String, 250)
    hTable.Fields.Add("fldvalquanti", db.Float)
    hTable.Fields.Add("fldexamtype", db.String, 50)
    hTable.Fields.Add("fldbaserate", db.Float)
    hTable.Fields.Add("fldnegrate", db.Float)
    hTable.Fields.Add("fldhitrate", db.Float)
    hTable.Fields.Add("fldfalserate", db.Float)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltriage($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltriage") Then
    hTable = $con.Tables.Add("tbltriage", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("flddiagnotype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldrelation", db.String, 25)
    hTable.Fields.Add("fldvalquali", db.String, 250)
    hTable.Fields.Add("fldvalquanti", db.Float)
    hTable.Fields.Add("flddiagnounit", db.String, 100)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldbaserate", db.Float)
    hTable.Fields.Add("fldhitrate", db.Float)
    hTable.Fields.Add("fldfalserate", db.Float)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblaiquery($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblaiquery") Then
    hTable = $con.Tables.Add("tblaiquery", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtype", db.String, 250)
    hTable.Fields.Add("fldquery", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------------------FOR CreateDatabaseForSish_Diagnostic---------------------------
Public Sub CREATEtblsysconst($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsysconst") Then
    hTable = $con.Tables.Add("tblsysconst", $DbEngine)
    hTable.Fields.Add("fldsysconst", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 50)
    hTable.PrimaryKey = ["fldsysconst"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblagegroups($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblagegroups") Then
    hTable = $con.Tables.Add("tblagegroups", $DbEngine)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("fldlower", db.Float)
    hTable.Fields.Add("fldhigher", db.Float)
    hTable.PrimaryKey = ["fldgroup"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltestmethod($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltestmethod") Then
    hTable = $con.Tables.Add("tbltestmethod", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldmethod", db.String, 150)
    hTable.Fields.Add("fldcateg", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblorganism($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblorganism") Then
    hTable = $con.Tables.Add("tblorganism", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldorganism", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsampletype($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsampletype") Then
    hTable = $con.Tables.Add("tblsampletype", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsampletype", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltestcondition($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltestcondition") Then
    hTable = $con.Tables.Add("tbltestcondition", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestcondition", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbllabchemical($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbllabchemical") Then
    hTable = $con.Tables.Add("tbllabchemical", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("flditemtype", db.String, 150)
    hTable.Fields.Add("flditem", db.String, 255)
    hTable.Fields.Add("fldamt", db.Float)
    hTable.Fields.Add("fldunit", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltestmachine($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltestmachine") Then
    hTable = $con.Tables.Add("tbltestmachine", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestid", db.String, 250)
    hTable.Fields.Add("fldvendor", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmachinemethod($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmachinemethod") Then
    hTable = $con.Tables.Add("tblmachinemethod", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldmachine", db.String, 250)
    hTable.Fields.Add("fldethod", db.String, 250)
    hTable.Fields.Add("fldvendor", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltest") Then
    hTable = $con.Tables.Add("tbltest", $DbEngine)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldcaption", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldsysconst", db.String, 250)
    hTable.Fields.Add("fldspecimen", db.String, 250)
    hTable.Fields.Add("fldspecmcode", db.String, 250)
    hTable.Fields.Add("fldcollection", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 5000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldsensitivity", db.Float)
    hTable.Fields.Add("fldspecificity", db.Float)
    hTable.Fields.Add("fldtestorder", db.Integer)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldcomment", db.String, 5000)
    Else
      hTable.Fields.Add("fldcomment", db.String)
    Endif
    hTable.Fields.Add("fldoption", db.String, 50)
    hTable.Fields.Add("fldcritical", db.Float)
    hTable.PrimaryKey = ["fldtestid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltestoption($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltestoption") Then
    hTable = $con.Tables.Add("tbltestoption", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldscale", db.Float)
    hTable.Fields.Add("fldscalegroup", db.String, 250)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltestlimit($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltestlimit") Then
    hTable = $con.Tables.Add("tbltestlimit", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldmethod", db.String, 250)
    hTable.Fields.Add("fldminimum", db.Float)
    hTable.Fields.Add("fldmaximum", db.Float)
    hTable.Fields.Add("fldsensitivity", db.Float)
    hTable.Fields.Add("fldspecificity", db.Float)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldconvfactor", db.Float)
    hTable.Fields.Add("fldsinormal", db.Float)
    hTable.Fields.Add("fldsihigh", db.Float)
    hTable.Fields.Add("fldsilow", db.Float)
    hTable.Fields.Add("fldsiunit", db.String, 25)
    hTable.Fields.Add("fldmetnormal", db.Float)
    hTable.Fields.Add("fldmethigh", db.Float)
    hTable.Fields.Add("fldmetlow", db.Float)
    hTable.Fields.Add("fldmetunit", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltestcomment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltestcomment") Then
    hTable = $con.Tables.Add("tbltestcomment", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldmax", db.Float)
    hTable.Fields.Add("fldmin", db.Float)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("fldunit", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcodehypo($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcodehypo") Then
    hTable = $con.Tables.Add("tblcodehypo", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcodehyper($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcodehyper") Then
    hTable = $con.Tables.Add("tblcodehyper", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsyndrohypo($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsyndrohypo") Then
    hTable = $con.Tables.Add("tblsyndrohypo", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsyndrohyper($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsyndrohyper") Then
    hTable = $con.Tables.Add("tblsyndrohyper", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltestquali($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltestquali") Then
    hTable = $con.Tables.Add("tbltestquali", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldsubtest", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 10000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsubtestquali($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsubtestquali") Then
    hTable = $con.Tables.Add("tblsubtestquali", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldsubtest", db.String, 200)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldscale", db.Float)
    hTable.Fields.Add("fldscalegroup", db.String, 250)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblantipanel($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblantipanel") Then
    hTable = $con.Tables.Add("tblantipanel", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("flditemname", db.String, 200)
    hTable.Fields.Add("fldspecimen", db.String, 250)
    hTable.Fields.Add("fldactive", db.String, 50)

    hTable.Fields.Add("fldsensimax", db.Float)
    hTable.Fields.Add("fldsensimin", db.Float)
    hTable.Fields.Add("fldintermax", db.Float)
    hTable.Fields.Add("fldintermin", db.Float)
    hTable.Fields.Add("fldresismax", db.Float)
    hTable.Fields.Add("fldresismin", db.Float)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblgrouptest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblgrouptest") Then
    hTable = $con.Tables.Add("tblgrouptest", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroupname", db.String, 200)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldtesttype", db.String, 50)
    hTable.Fields.Add("fldactive", db.String, 100)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblstructexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblstructexam") Then
    hTable = $con.Tables.Add("tblstructexam", $DbEngine)
    hTable.Fields.Add("fldheadcode", db.String, 250)
    ' hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldclass", db.String, 250)
    hTable.Fields.Add("fldsubclass", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("flditemid", db.Integer)
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("flditemoption", db.String, 150)
    hTable.Fields.Add("fldheadid", db.Integer)
    hTable.Fields.Add("fldhead", db.String, 250)
    hTable.Fields.Add("fldsysconst", db.String, 250)
    hTable.Fields.Add("fldtesttype", db.String, 50)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    hTable.Fields.Add("fldreferencee", db.String, 150)
    hTable.Fields.Add("fldclininfo", db.String, 255)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddefault", db.String, 5000)
    Else
      hTable.Fields.Add("flddefault", db.String)
    Endif
    hTable.Fields.Add("fldunique", db.Boolean)
    hTable.Fields.Add("fldlock", db.Boolean)
    hTable.PrimaryKey = ["fldheadcode"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblstructexamoption($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblstructexamoption") Then
    hTable = $con.Tables.Add("tblstructexamoption", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    ' hTable.Fields.Add("fldclass", db.String, 250)
    ' hTable.Fields.Add("fldsubclass", db.String, 250)
    ' hTable.Fields.Add("fldcategory", db.String, 250)
    ' hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldhead", db.String, 250)
    hTable.Fields.Add("fldheadcode", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.Fields.Add("fldlock", db.Boolean)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcompexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcompexam") Then
    hTable = $con.Tables.Add("tblcompexam", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldsysconst", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    hTable.Fields.Add("fldoptionlist", db.String)
    hTable.Fields.Add("fldgroupname", db.String, 150)
    hTable.Fields.Add("fldexamorder", db.Integer)
    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldeptexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldeptexam") Then
    hTable = $con.Tables.Add("tbldeptexam", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldsysconst", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    hTable.Fields.Add("fldexamorder", db.Integer)
    hTable.Fields.Add("flddept", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldeptexamoption($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldeptexamoption") Then
    hTable = $con.Tables.Add("tbldeptexamoption", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("flddept", db.String, 200)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblgroupexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblgroupexam") Then
    hTable = $con.Tables.Add("tblgroupexam", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroupname", db.String, 200)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblexam") Then
    hTable = $con.Tables.Add("tblexam", $DbEngine)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldsysconst", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 5000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldsensitivity", db.Float)
    hTable.Fields.Add("fldspecificity", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldcomment", db.String, 5000)
    Else
      hTable.Fields.Add("fldcomment", db.String)
    Endif
    hTable.Fields.Add("fldoption", db.String, 50)
    hTable.Fields.Add("fldcritical", db.Float)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.PrimaryKey = ["fldexamid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblexamoption($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblexamoption") Then
    hTable = $con.Tables.Add("tblexamoption", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldscale", db.Float)
    hTable.Fields.Add("fldscalegroup", db.String, 250)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblexamlimit($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblexamlimit") Then
    hTable = $con.Tables.Add("tblexamlimit", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldmethod", db.String, 250)
    hTable.Fields.Add("fldminimum", db.Float)
    hTable.Fields.Add("fldmaximum", db.Float)
    hTable.Fields.Add("fldsensitivity", db.Float)
    hTable.Fields.Add("fldspecificity", db.Float)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldnormal", db.Float)
    hTable.Fields.Add("fldhigh", db.Float)
    hTable.Fields.Add("fldlow", db.Float)
    hTable.Fields.Add("fldunit", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblexamcomment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblexamcomment") Then
    hTable = $con.Tables.Add("tblexamcomment", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldmax", db.Float)
    hTable.Fields.Add("fldmin", db.Float)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcodebrady($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcodebrady") Then
    hTable = $con.Tables.Add("tblcodebrady", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcodetachy($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcodetachy") Then
    hTable = $con.Tables.Add("tblcodetachy", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    SetMedSyncTable(hTable)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsyndrobrady($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsyndrobrady") Then
    hTable = $con.Tables.Add("tblsyndrobrady", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsyndrotachy($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsyndrotachy") Then
    hTable = $con.Tables.Add("tblsyndrotachy", $DbEngine)
    hTable.Fields.Add("flid", db.Serial)
    hTable.Fields.Add("fldparent", db.String, 255)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldchild", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.PrimaryKey = ["flid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldparent_fldchild", ["fldparent", "fldchild"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblexamquali($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblexamquali") Then
    hTable = $con.Tables.Add("tblexamquali", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldsubexam", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 10000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsubexamquali($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsubexamquali") Then
    hTable = $con.Tables.Add("tblsubexamquali", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldsubexam", db.String, 200)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldscale", db.Float)
    hTable.Fields.Add("fldscalegroup", db.String, 250)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblradio($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblradio") Then
    hTable = $con.Tables.Add("tblradio", $DbEngine)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldcaption", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldsysconst", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 5000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldsensitivity", db.Float)
    hTable.Fields.Add("fldspecificity", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldcomment", db.String, 5000)
    Else
      hTable.Fields.Add("fldcomment", db.String)
    Endif
    hTable.Fields.Add("fldoption", db.String, 50)
    hTable.Fields.Add("fldcritical", db.Float)
    hTable.PrimaryKey = ["fldexamid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblradiooption($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblradiooption") Then
    hTable = $con.Tables.Add("tblradiooption", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldscale", db.Float)
    hTable.Fields.Add("fldscalegroup", db.String, 250)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblradiolimit($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblradiolimit") Then
    hTable = $con.Tables.Add("tblradiolimit", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldmethod", db.String, 250)
    hTable.Fields.Add("fldminimum", db.Float)
    hTable.Fields.Add("fldmaximum", db.Float)
    hTable.Fields.Add("fldsensitivity", db.Float)
    hTable.Fields.Add("fldspecificity", db.Float)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldnormal", db.Float)
    hTable.Fields.Add("fldhigh", db.Float)
    hTable.Fields.Add("fldlow", db.Float)
    hTable.Fields.Add("fldunit", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblradiocomment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblradiocomment") Then
    hTable = $con.Tables.Add("tblradiocomment", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldmax", db.Float)
    hTable.Fields.Add("fldmin", db.Float)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblradioquali($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblradioquali") Then
    hTable = $con.Tables.Add("tblradioquali", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldsubexam", db.String, 200)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 10000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsubradioquali($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsubradioquali") Then
    hTable = $con.Tables.Add("tblsubradioquali", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldexamid", db.String, 200)
    hTable.Fields.Add("fldsubexam", db.String, 200)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldscale", db.Float)
    hTable.Fields.Add("fldscalegroup", db.String, 250)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblgroupradio($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblgroupradio") Then
    hTable = $con.Tables.Add("tblgroupradio", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroupname", db.String, 200)
    hTable.Fields.Add("fldtestid", db.String, 200)
    hTable.Fields.Add("fldtesttype", db.String, 50)
    hTable.Fields.Add("fldptsex", db.String, 100)
    hTable.Fields.Add("fldactive", db.String, 100)
    hTable.Fields.Add("fldquota", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblprocname($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblprocname") Then
    hTable = $con.Tables.Add("tblprocname", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldprocname", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblgroupproc($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblgroupproc") Then
    hTable = $con.Tables.Add("tblgroupproc", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroupname", db.String, 200)
    hTable.Fields.Add("fldprocname", db.String, 200)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldemographic($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldemographic") Then
    hTable = $con.Tables.Add("tbldemographic", $DbEngine)
    hTable.Fields.Add("flddemoid", db.String, 200)
    hTable.Fields.Add("fldoption", db.String, 50)
    hTable.Fields.Add("flddefault", db.String, 250)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["flddemoid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldemogoption($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldemogoption") Then
    hTable = $con.Tables.Add("tbldemogoption", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flddemoid", db.String, 200)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcomplaints($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcomplaints") Then
    hTable = $con.Tables.Add("tblcomplaints", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsymptom", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldischarge($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldischarge") Then
    hTable = $con.Tables.Add("tbldischarge", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.Fields.Add("fldformat", db.String, 150)
    hTable.Fields.Add("fldgender", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 5000)
      hTable.Fields.Add("fldoptions", db.String, 5000)
    Else
      hTable.Fields.Add("flddetail", db.String)
      hTable.Fields.Add("fldoptions", db.String)
    Endif
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblhistory($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblhistory") Then
    hTable = $con.Tables.Add("tblhistory", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.Fields.Add("fldformat", db.String, 150)
    hTable.Fields.Add("fldgender", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 5000)
      hTable.Fields.Add("fldoptions", db.String, 5000)
    Else
      hTable.Fields.Add("flddetail", db.String)
      hTable.Fields.Add("fldoptions", db.String)
    Endif
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldelivery($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldelivery") Then
    hTable = $con.Tables.Add("tbldelivery", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldelcomplication($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldelcomplication") Then
    hTable = $con.Tables.Add("tbldelcomplication", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldeldeformity($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldeldeformity") Then
    hTable = $con.Tables.Add("tbldeldeformity", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldellabour($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldellabour") Then
    hTable = $con.Tables.Add("tbldellabour", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblreferlist($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblreferlist") Then
    hTable = $con.Tables.Add("tblreferlist", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldlocation", db.String, 250)
    hTable.Fields.Add("fldcode", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblprocedure($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblprocedure") Then
    hTable = $con.Tables.Add("tblprocedure", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblprocedureuser($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblprocedureuser") Then
    hTable = $con.Tables.Add("tblprocedureuser", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblanaesthesia($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblanaesthesia") Then
    hTable = $con.Tables.Add("tblanaesthesia", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblchecklist($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblchecklist") Then
    hTable = $con.Tables.Add("tblchecklist", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtitle", db.String, 150)
    hTable.Fields.Add("fldquery", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblevents($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblevents") Then
    hTable = $con.Tables.Add("tblevents", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.Fields.Add("fldtype", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldevices($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldevices") Then
    hTable = $con.Tables.Add("tbldevices", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.Fields.Add("fldlocat", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblrepomapping($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblrepomapping") Then
    hTable = $con.Tables.Add("tblrepomapping", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcategory", db.String, 200)
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------------------FOR CreateDatabaseForSish_Data---------------------------
Public Sub CREATEtblmedimage($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedimage") Then
    hTable = $con.Tables.Add("tblmedimage", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("fldname", db.String, 250)
    hTable.Fields.Add("fldsubname", db.String, 250)
    hTable.Fields.Add("fldoption", db.String, 150)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("flddet", db.String, 255)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblelectrolyte($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblelectrolyte") Then
    hTable = $con.Tables.Add("tblelectrolyte", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcategory", db.String, 50)
    hTable.Fields.Add("fldsalt", db.String, 250)
    hTable.Fields.Add("fldmg", db.Float)
    hTable.Fields.Add("fldmmol", db.Float)
    hTable.Fields.Add("fldmeq", db.Float)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblresearch($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblresearch") Then
    hTable = $con.Tables.Add("tblresearch", $DbEngine)
    hTable.Fields.Add("fldstudycode", db.String, 150)
    hTable.Fields.Add("fldstudyname", db.String, 250)
    hTable.Fields.Add("fldstudylocat", db.String, 250)
    hTable.Fields.Add("fldsamplesize", db.Integer)
    hTable.Fields.Add("fldstudystart", db.Date)
    hTable.Fields.Add("fldstudyend", db.Date)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldstudysample", db.String, 2000)
      hTable.Fields.Add("fldstudycriteria", db.String, 2000)
    Else
      hTable.Fields.Add("fldstudysample", db.String)
      hTable.Fields.Add("fldstudycriteria", db.String)
    Endif
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldircconsentpic", db.String, 2000)
    Else
      hTable.Fields.Add("fldircconsentpic", db.Blob)
    Endif
    hTable.Fields.Add("fldircconsentlink", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldconsentformpic", db.String, 2000)
    Else
      hTable.Fields.Add("fldconsentformpic", db.Blob)
    Endif
    hTable.Fields.Add("fldconsentformlink", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldiintervireformpic", db.String, 2000)
    Else
      hTable.Fields.Add("fldiintervireformpic", db.Blob)
    Endif
    hTable.Fields.Add("fldinterviewformlink", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.PrimaryKey = ["fldstudycode"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''========================== PATIENT DATA: LOCAL STORAGE ===============================
''----------------------------FOR CreateDatabaseForSish_System---------------------------
Public Sub CREATEtblautoid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblautoid") Then
    hTable = $con.Tables.Add("tblautoid", $DbEngine)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldvalue", db.Long)
    ' hTable.Fields.Add("fldfiscal", db.String, 50)
    hTable.PrimaryKey = ["fldtype"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblinvid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblinvid") Then
    hTable = $con.Tables.Add("tblinvid", $DbEngine)
    hTable.Fields.Add("fldinvcode", db.String, 25)
    hTable.Fields.Add("fldinvsub", db.String, 25)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.PrimaryKey = ["fldinvcode"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatsubs($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatsubs") Then
    hTable = $con.Tables.Add("tblpatsubs", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldpatno", db.String, 50)
    hTable.Fields.Add("fldpatlen", db.Integer)
    hTable.Fields.Add("fldencid", db.String, 50)
    hTable.Fields.Add("fldenclen", db.Integer)
    hTable.Fields.Add("fldbooking", db.String, 50)
    hTable.Fields.Add("fldbooklen", db.Integer)
    hTable.Fields.Add("fldhospcode", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbllock($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbllock") Then
    hTable = $con.Tables.Add("tbllock", $DbEngine)
    hTable.Fields.Add("fldlock", db.String, 50)
    hTable.PrimaryKey = ["fldlock"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfiscalid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfiscalid") Then
    hTable = $con.Tables.Add("tblfiscalid", $DbEngine)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldlabel", db.String, 100)
    hTable.Fields.Add("fldfrom", db.Date)
    hTable.Fields.Add("fldend", db.Date)
    hTable.Fields.Add("fldvalue", db.Long)
    hTable.PrimaryKey = ["fldindex"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfisclosing($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfisclosing") Then
    hTable = $con.Tables.Add("tblfisclosing", $DbEngine)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldfrom", db.Date)
    hTable.Fields.Add("fldend", db.Date)
    hTable.Fields.Add("fldstate", db.String, 75)

    hTable.Fields.Add("fldpatbilling", db.String, 150)
    hTable.Fields.Add("fldpatbilldetail", db.String, 150)
    hTable.Fields.Add("fldtempbilldetail", db.String, 150)
    hTable.Fields.Add("fldpatlabtest", db.String, 150)
    hTable.Fields.Add("fldpatlabsubtest", db.String, 150)
    hTable.Fields.Add("fldpatientexam", db.String, 150)
    hTable.Fields.Add("fldpatientsubexam", db.String, 150)
    hTable.Fields.Add("fldpatradiotest", db.String, 150)
    hTable.Fields.Add("fldpatradiosubtest", db.String, 150)
    hTable.Fields.Add("fldpatdosing", db.String, 150)
    hTable.Fields.Add("fldpatreport", db.String, 150)

    hTable.PrimaryKey = ["fldindex"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblenclock($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblenclock") Then
    hTable = $con.Tables.Add("tblenclock", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldlocktype", db.String, 250)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldiagnoid($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldiagnoid") Then
    hTable = $con.Tables.Add("tbldiagnoid", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtype", db.String, 25)
    hTable.Fields.Add("fldsection", db.String, 100)
    hTable.Fields.Add("fldprefix", db.String, 100)
    hTable.Fields.Add("fldstart", db.Date)
    hTable.Fields.Add("fldclose", db.Date)
    hTable.Fields.Add("fldcode", db.String, 25)
    hTable.Fields.Add("fldvalue", db.Long)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltabsettings($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltabsettings") Then
    hTable = $con.Tables.Add("tbltabsettings", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsettings($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsettings") Then
    hTable = $con.Tables.Add("tblsettings", $DbEngine)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.PrimaryKey = ["fldindex"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblhmissetting($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblhmissetting") Then
    hTable = $con.Tables.Add("tblhmissetting", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldvarval", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblgnupg($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblgnupg") Then
    hTable = $con.Tables.Add("tblgnupg", $DbEngine)
    hTable.Fields.Add("fldkeyid", db.String, 250)
    hTable.Fields.Add("fldkeyname", db.String, 250)
    hTable.Fields.Add("fldfingerprint", db.String, 255)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpublic", db.String, 5000)
      hTable.Fields.Add("fldprivate", db.String, 5000)
    Else
      hTable.Fields.Add("fldpublic", db.Blob)
      hTable.Fields.Add("fldprivate", db.Blob)
    Endif
    hTable.Fields.Add("fldpublink", db.String, 250)
    hTable.Fields.Add("fldprilink", db.String, 250)
    hTable.PrimaryKey = ["fldkeyid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblautoemail($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblautoemail") Then
    hTable = $con.Tables.Add("tblautoemail", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtousers", db.String, 250)
    hTable.Fields.Add("fldcctype", db.String, 50)
    hTable.Fields.Add("fldccusers", db.String, 250)
    hTable.Fields.Add("fldfromhost", db.String, 150)
    hTable.Fields.Add("fldfromuser", db.String, 150)
    hTable.Fields.Add("fldfrompass", db.String, 150)
    hTable.Fields.Add("fldsender", db.String, 150)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldsubject", db.String, 250)
    hTable.Fields.Add("fldcontent", db.String, 250)
    hTable.Fields.Add("fldreport", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcronjob($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcronjob") Then
    hTable = $con.Tables.Add("tblcronjob", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcategory", db.String, 50)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldscript", db.String, 10000)
    Else
      hTable.Fields.Add("fldscript", db.String)
    Endif
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldstatus", db.Boolean)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblirdactivity($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblirdactivity") Then
    hTable = $con.Tables.Add("tblirdactivity", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldfrmname", db.String, 100)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldactivity", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblactivity($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblactivity") Then
    hTable = $con.Tables.Add("tblactivity", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldfrmname", db.String, 100)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldactivity", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbljobrecord($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbljobrecord") Then
    hTable = $con.Tables.Add("tbljobrecord", $DbEngine)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldfrmname", db.String, 100)
    hTable.Fields.Add("fldfrmlabel", db.String, 250)
    hTable.Fields.Add("flduser", db.String, 25)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldentrytime", db.Date)
    hTable.Fields.Add("fldexittime", db.Date)
    hTable.Fields.Add("fldpresent", db.Boolean)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.PrimaryKey = ["fldindex"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsystemlog($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsystemlog") Then
    hTable = $con.Tables.Add("tblsystemlog", $DbEngine)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("flduser", db.String, 25)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldlogin", db.String, 50)
    hTable.Fields.Add("fldentrytime", db.Date)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("flddevicepath", db.String, 250)
    hTable.Fields.Add("fldversion", db.String, 100)
    hTable.Fields.Add("fldmainserver", db.String, 250)
    hTable.Fields.Add("fldreadserver", db.String, 250)
    hTable.Fields.Add("fldfallserver", db.String, 250)
    hTable.Fields.Add("fldftpserver", db.String, 250)
    hTable.PrimaryKey = ["fldindex"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblauthenticate($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblauthenticate") Then
    hTable = $con.Tables.Add("tblauthenticate", $DbEngine)
    hTable.Fields.Add("fldhash", db.String, 250)
    hTable.Fields.Add("fldcode", db.String, 50)
    hTable.PrimaryKey = ["fldhash"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblreposync($con As Connection)

  Dim hTable As Table

  If $DbFormat = "REP" Then
    If Not $con.Tables.Exist("tblreposync") Then
      hTable = $con.Tables.Add("tblreposync", $DbEngine)
      hTable.Fields.Add("fldindex", db.String, 250)
      hTable.Fields.Add("fldtable", db.String, 50)
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldindex"]
      hTable.Update
      modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
    Endif
  Endif

End

Public Sub CREATEtblreportlog($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblreportlog") Then
    hTable = $con.Tables.Add("tblreportlog", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldwindow", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldfile", db.String, 10000)
    Else
      hTable.Fields.Add("fldfile", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmessagelog($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmessagelog") Then
    hTable = $con.Tables.Add("tblmessagelog", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldwindow", db.String, 50)
    hTable.Fields.Add("fldtarget", db.String, 150)
    hTable.Fields.Add("fldmesstext", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)

    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsmslog($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsmslog") Then
    hTable = $con.Tables.Add("tblsmslog", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldwindow", db.String, 50)
    hTable.Fields.Add("fldtarget", db.String, 150)
    hTable.Fields.Add("fldsmstext", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldcomment", db.String, 10000)
    Else
      hTable.Fields.Add("fldcomment", db.String)
    Endif
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("fldsmsdate", db.Date)

    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblstafflist($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblstafflist") Then
    hTable = $con.Tables.Add("tblstafflist", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldptcode", db.String, 250)
    Else
      hTable.Fields.Add("fldptcode", db.String, 250)
    Endif
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldserviceid", db.String, 150)
    hTable.Fields.Add("fldptnamefir", db.String, 150)
    hTable.Fields.Add("fldptnamelast", db.String, 150)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldptaddvill", db.String, 150)
    hTable.Fields.Add("fldptaddward", db.String, 150)
    hTable.Fields.Add("fldptadddist", db.String, 150)
    hTable.Fields.Add("fldptcontact", db.String, 150)
    hTable.Fields.Add("fldptbirday", db.Date)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldptguardian", db.String, 250)
    hTable.Fields.Add("fldrelation", db.String, 250)
    hTable.Fields.Add("fldjoindate", db.Date)
    hTable.Fields.Add("fldenddate", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldpatientval", db.String, 250)
    hTable.Fields.Add("flddisctype", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)

    hTable.Fields.Add("fldcitizen", db.String, 250)
    hTable.Fields.Add("fldcontype", db.String, 200)
    hTable.Fields.Add("fldreligion", db.String, 250)
    hTable.Fields.Add("fldidentify", db.String, 250)
    hTable.Fields.Add("fldgovtaccount", db.String, 250)
    hTable.Fields.Add("fldbankname", db.String, 250)
    hTable.Fields.Add("fldbankaccount", db.String, 250)
    hTable.Fields.Add("fldtaxpercent", db.Float)

    hTable.Fields.Add("flddept", db.String, 250)
    hTable.Fields.Add("fldpost", db.String, 200)  ''designation
    hTable.Fields.Add("fldrank", db.String, 250)
    hTable.Fields.Add("fldunit", db.String, 250)

    hTable.Fields.Add("fldremark", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldptcode"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldpatientval", ["fldpatientval"], True)
    hTable.Indexes.Add(hTable.Name & "_flduserid", ["flduserid"], True)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsociallist($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsociallist") Then
    hTable = $con.Tables.Add("tblsociallist", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldptcode", db.String, 250)
    Else
      hTable.Fields.Add("fldptcode", db.String, 250)
    Endif
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldserviceid", db.String, 150)
    hTable.Fields.Add("fldptnamefir", db.String, 150)
    hTable.Fields.Add("fldptnamelast", db.String, 150)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldptaddvill", db.String, 150)
    hTable.Fields.Add("fldptaddward", db.String, 150)
    hTable.Fields.Add("fldptadddist", db.String, 150)
    hTable.Fields.Add("fldptcontact", db.String, 150)
    hTable.Fields.Add("fldptbirday", db.Date)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldptguardian", db.String, 250)
    hTable.Fields.Add("fldrelation", db.String, 250)
    hTable.Fields.Add("fldjoindate", db.Date)
    hTable.Fields.Add("fldenddate", db.Date)
    hTable.Fields.Add("fldactivity", db.String, 25)
    hTable.Fields.Add("fldpatientval", db.String, 250)
    hTable.Fields.Add("flddisctype", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)

    hTable.Fields.Add("fldcitizen", db.String, 250)
    hTable.Fields.Add("fldidentify", db.String, 250)
    hTable.Fields.Add("fldscheme", db.String, 200)
    hTable.Fields.Add("fldservice", db.String, 250)

    hTable.Fields.Add("fldreferhosp", db.String, 250)
    hTable.Fields.Add("fldreferdist", db.String, 250)
    hTable.Fields.Add("fldreferdate", db.Date)
    hTable.Fields.Add("fldsocialmode", db.String, 250)
    hTable.Fields.Add("fldcreditlim", db.Float)
    hTable.Fields.Add("fldcreditdate", db.Date)
    hTable.Fields.Add("flddisclimit", db.Float)
    hTable.Fields.Add("flddiscdate", db.Date)

    hTable.Fields.Add("fldremark", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldptcode"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldpatientval_flddisctype", ["fldpatientval", "flddisctype"], True)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbluser($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbluser") Then
    hTable = $con.Tables.Add("tbluser", $DbEngine)
    hTable.Fields.Add("flduserid", db.String, 20)
    hTable.Fields.Add("fldusername", db.String, 250)
    hTable.Fields.Add("fldpass", db.String, 250)
    hTable.Fields.Add("fldroot", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldcode", db.Integer)
    hTable.Fields.Add("fldfromdate", db.Date)
    hTable.Fields.Add("fldtodate", db.Date)
    hTable.Fields.Add("fldusercode", db.String, 250)
    hTable.Fields.Add("fldcontact", db.String, 150)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)

    hTable.Fields.Add("fldfaculty", db.Boolean)
    hTable.Fields.Add("fldpayable", db.Boolean)
    hTable.Fields.Add("fldreferral", db.Boolean)
    hTable.Fields.Add("fldopconsult", db.Boolean)
    hTable.Fields.Add("fldipconsult", db.Boolean)
    hTable.Fields.Add("fldonline", db.Boolean)
    hTable.Fields.Add("fldsigna", db.Boolean)
    hTable.Fields.Add("fldreport", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["flduserid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblusercategory($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblusercategory") Then
    hTable = $con.Tables.Add("tblusercategory", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmiscategory($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmiscategory") Then
    hTable = $con.Tables.Add("tblmiscategory", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldparam", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbluserimage($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbluserimage") Then
    hTable = $con.Tables.Add("tbluserimage", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblreportuser($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblreportuser") Then
    hTable = $con.Tables.Add("tblreportuser", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldname", db.String, 150)
    hTable.Fields.Add("fldnamefont", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldsigimage", db.String, 10000)
    Else
      hTable.Fields.Add("fldsigimage", db.Blob)
    Endif
    hTable.Fields.Add("fldtitle", db.String, 150)
    hTable.Fields.Add("flddetail", db.String, 250)
    hTable.Fields.Add("flddefault", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblkey($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblkey") Then
    hTable = $con.Tables.Add("tblkey", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("key1", db.String, 250)
    hTable.Fields.Add("key2", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblnewkey($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblnewkey") Then
    hTable = $con.Tables.Add("tblnewkey", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("key1", db.String, 250)
    hTable.Fields.Add("key2", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbluseraccess($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbluseraccess") Then
    hTable = $con.Tables.Add("tbluseraccess", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldaccess", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcompaccess($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcompaccess") Then
    hTable = $con.Tables.Add("tblcompaccess", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmacaccess($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmacaccess") Then
    hTable = $con.Tables.Add("tblmacaccess", $DbEngine)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostpass", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldcompname", db.String, 250)
    hTable.Fields.Add("fldaccess", db.String, 50)
    hTable.Fields.Add("fldiptype", db.String, 50)
    hTable.Fields.Add("fldcode", db.Integer)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldhostmac"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbluserformaccess($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbluserformaccess") Then
    hTable = $con.Tables.Add("tbluserformaccess", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldcategory", db.String, 50)
    hTable.Fields.Add("fldformname", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblclinicentry($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblclinicentry") Then
    hTable = $con.Tables.Add("tblclinicentry", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldaccess", db.String, 250)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpersonal($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpersonal") Then
    hTable = $con.Tables.Add("tblpersonal", $DbEngine)
    hTable.Fields.Add("perid", db.Serial)
    hTable.Fields.Add("fldcateg", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldblob", db.String, 10000)
    Else
      hTable.Fields.Add("fldblob", db.Blob)
    Endif
    hTable.Fields.Add("flddetail", db.String, 250)
    hTable.Fields.Add("fldextension", db.String, 10)
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.PrimaryKey = ["perid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfileshare($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfileshare") Then
    hTable = $con.Tables.Add("tblfileshare", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldshared", db.String, 25)
    hTable.Fields.Add("fldperid", db.Long)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------------------FOR CreateDatabaseForSish_Finance---------------------------
Public Sub CREATEtblsurname($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsurname") Then
    hTable = $con.Tables.Add("tblsurname", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblhospitals($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblhospitals") Then
    hTable = $con.Tables.Add("tblhospitals", $DbEngine)
    hTable.Fields.Add("fldhospcode", db.String, 50)
    hTable.Fields.Add("fldhospname", db.String, 250)
    hTable.Fields.Add("fldaddress", db.String, 250)
    hTable.Fields.Add("fldward", db.String, 150)
    hTable.Fields.Add("fldpality", db.String, 250)
    hTable.Fields.Add("fldprovince", db.String, 250)
    hTable.Fields.Add("flddistrict", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldlatitude", db.Float)
    hTable.Fields.Add("fldlongitude", db.Float)
    hTable.Fields.Add("fldcontact", db.String, 250)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldorgunit", db.String, 250)
    If $DbFormat = "Dashboard" Then
      hTable.Fields.Add("fldverify", db.Boolean)
      hTable.Fields.Add("fldbuilding", db.Float)
      hTable.Fields.Add("fldsanctpos", db.Float)
      hTable.Fields.Add("fldfilledpos", db.Float)
      hTable.Fields.Add("fldcontract", db.Float)
      hTable.Fields.Add("fldsbanum", db.Float)
      hTable.Fields.Add("fldlarcnum", db.Float)
      hTable.Fields.Add("fldimncinum", db.Float)

      hTable.Fields.Add("fldhfbool1", db.Boolean)
      hTable.Fields.Add("fldhfbool2", db.Boolean)
      hTable.Fields.Add("fldhfbool3", db.Boolean)
      hTable.Fields.Add("fldhfbool4", db.Boolean)
      hTable.Fields.Add("fldhfbool5", db.Boolean)
      hTable.Fields.Add("fldhfbool6", db.Boolean)
      hTable.Fields.Add("fldhfbool7", db.Boolean)
      hTable.Fields.Add("fldhfbool8", db.Boolean)
      hTable.Fields.Add("fldhfbool9", db.Boolean)
      hTable.Fields.Add("fldhfbool10", db.Boolean)
      hTable.Fields.Add("fldhfbool11", db.Boolean)
      hTable.Fields.Add("fldhfbool12", db.Boolean)
      hTable.Fields.Add("fldhfbool13", db.Boolean)
      hTable.Fields.Add("fldhfbool14", db.Boolean)
      hTable.Fields.Add("fldhfbool15", db.Boolean)
      hTable.Fields.Add("fldhfbool16", db.Boolean)
      hTable.Fields.Add("fldhfbool17", db.Boolean)
      hTable.Fields.Add("fldhfbool18", db.Boolean)
      hTable.Fields.Add("fldhfbool19", db.Boolean)
      hTable.Fields.Add("fldhfbool20", db.Boolean)
      hTable.Fields.Add("fldhfbool21", db.Boolean)
      hTable.Fields.Add("fldhfbool22", db.Boolean)
      hTable.Fields.Add("fldhfbool23", db.Boolean)
      hTable.Fields.Add("fldhfbool24", db.Boolean)
    Endif
    hTable.PrimaryKey = ["fldhospcode"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmunicipals($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmunicipals") Then
    hTable = $con.Tables.Add("tblmunicipals", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldpality", db.String, 250)
    hTable.Fields.Add("flddistrict", db.String, 250)
    hTable.Fields.Add("fldprovince", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblrelations($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblrelations") Then
    hTable = $con.Tables.Add("tblrelations", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblranks($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblranks") Then
    hTable = $con.Tables.Add("tblranks", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblunits($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblunits") Then
    hTable = $con.Tables.Add("tblunits", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblipdservice($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblipdservice") Then
    hTable = $con.Tables.Add("tblipdservice", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.Fields.Add("flddiagnosis", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblhospbranch($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblhospbranch") Then
    hTable = $con.Tables.Add("tblhospbranch", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldbranch", db.String, 150)
    hTable.Fields.Add("fldcompid", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldepartment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldepartment") Then
    hTable = $con.Tables.Add("tbldepartment", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("flddept", db.String, 150)
    hTable.Fields.Add("fldcateg", db.String, 150)
    hTable.Fields.Add("flddeptcode", db.String, 150)
    hTable.Fields.Add("fldactive", db.String, 50)
    hTable.Fields.Add("fldroom", db.String, 50)
    hTable.Fields.Add("fldhead", db.String, 250)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldinterval", db.Integer)
    hTable.Fields.Add("fldstart", db.Date)

    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldeptgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldeptgroup") Then
    hTable = $con.Tables.Add("tbldeptgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroupname", db.String, 250)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldepartmentbed($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldepartmentbed") Then
    hTable = $con.Tables.Add("tbldepartmentbed", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldbed", db.String, 50)
    Else
      hTable.Fields.Add("fldbed", db.String, 50)
    Endif
    hTable.Fields.Add("flddept", db.String, 50)
    hTable.Fields.Add("fldservice", db.String, 150)
    hTable.Fields.Add("fldoxyport", db.String, 150)
    hTable.Fields.Add("fldventilator", db.String, 150)
    hTable.Fields.Add("fldother", db.String, 150)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldaddservice", db.String, 150)
    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("fldfreedate", db.Date)

    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldbed"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldepartbedcharge($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldepartbedcharge") Then
    hTable = $con.Tables.Add("tbldepartbedcharge", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flddept", db.String, 50)
    hTable.Fields.Add("fldoxyport", db.String, 150)
    hTable.Fields.Add("fldventilator", db.String, 150)
    hTable.Fields.Add("fldother", db.String, 150)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldbedcharge", db.String, 250)
    hTable.Fields.Add("fldconsultcharge", db.String, 250)
    hTable.Fields.Add("fldexititem", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldiscount($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldiscount") Then
    hTable = $con.Tables.Add("tbldiscount", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldtype", db.String, 250)
    Else
      hTable.Fields.Add("fldtype", db.String, 100)
    Endif
    hTable.Fields.Add("fldmode", db.String, 100)
    hTable.Fields.Add("fldpercent", db.Float)
    hTable.Fields.Add("fldamount", db.Float)
    hTable.Fields.Add("fldcredit", db.Float)
    hTable.Fields.Add("fldlimit", db.String, 100)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldacledger", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 150)
    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("fldinvoice", db.String, 25)
    hTable.Fields.Add("fldreserved", db.String, 50)
    hTable.Fields.Add("fldcashincredit", db.Float)
    hTable.Fields.Add("fldyear", db.Date)
    hTable.Fields.Add("fldforce", db.String, 100)
    hTable.Fields.Add("fldqtylimit", db.String, 150)
    hTable.Fields.Add("fldfixdepart", db.String, 150)
    hTable.Fields.Add("fldlockstate", db.String, 100)
    hTable.Fields.Add("fldonline", db.String, 100)
    hTable.Fields.Add("fldoffspring", db.String, 100)
    hTable.Fields.Add("fldbankaccount", db.String, 200)

    hTable.Fields.Add("fldlab", db.Float)
    hTable.Fields.Add("fldradio", db.Float)
    hTable.Fields.Add("fldproc", db.Float)
    hTable.Fields.Add("fldequip", db.Float)
    hTable.Fields.Add("fldservice", db.Float)
    hTable.Fields.Add("fldother", db.Float)
    hTable.Fields.Add("fldmedicine", db.Float)
    hTable.Fields.Add("fldsurgical", db.Float)
    hTable.Fields.Add("fldextra", db.Float)
    hTable.Fields.Add("fldregist", db.Float)

    hTable.Fields.Add("fldcrdlab", db.Float)
    hTable.Fields.Add("fldcrdradio", db.Float)
    hTable.Fields.Add("fldcrdproc", db.Float)
    hTable.Fields.Add("fldcrdequip", db.Float)
    hTable.Fields.Add("fldcrdservice", db.Float)
    hTable.Fields.Add("fldcrdother", db.Float)
    hTable.Fields.Add("fldcrdmedicine", db.Float)
    hTable.Fields.Add("fldcrdsurgical", db.Float)
    hTable.Fields.Add("fldcrdextra", db.Float)

    hTable.Fields.Add("fldqtylab", db.Float)
    hTable.Fields.Add("fldqtyradio", db.Float)
    hTable.Fields.Add("fldqtyproc", db.Float)
    hTable.Fields.Add("fldqtyequip", db.Float)
    hTable.Fields.Add("fldqtyservice", db.Float)
    hTable.Fields.Add("fldqtyother", db.Float)
    hTable.Fields.Add("fldqtymedicine", db.Float)
    hTable.Fields.Add("fldqtysurgical", db.Float)
    hTable.Fields.Add("fldqtyextra", db.Float)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldtype"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblforcediscount($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblforcediscount") Then
    hTable = $con.Tables.Add("tblforcediscount", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flddisctype", db.String, 100)
    hTable.Fields.Add("flddepart", db.String, 100)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblnodiscount($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblnodiscount") Then
    hTable = $con.Tables.Add("tblnodiscount", $DbEngine)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["flditemname"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbllockedservice($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbllockedservice") Then
    hTable = $con.Tables.Add("tbllockedservice", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flddisctype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcustdiscount($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcustdiscount") Then
    hTable = $con.Tables.Add("tblcustdiscount", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("fldpercent", db.Float)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcustquantity($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcustquantity") Then
    hTable = $con.Tables.Add("tblcustquantity", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("fldmaxqty", db.Float)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcustcredit($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcustcredit") Then
    hTable = $con.Tables.Add("tblcustcredit", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("fldpercent", db.Float)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpackgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpackgroup") Then
    hTable = $con.Tables.Add("tblpackgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldpackgroup", db.String, 250)
    hTable.Fields.Add("fldpackage", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblaccdemograp($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblaccdemograp") Then
    hTable = $con.Tables.Add("tblaccdemograp", $DbEngine)
    hTable.Fields.Add("flddemoid", db.String, 200)
    hTable.Fields.Add("fldoption", db.String, 50)
    hTable.Fields.Add("flddefault", db.String, 250)
    hTable.PrimaryKey = ["flddemoid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblaccdemogoption($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblaccdemogoption") Then
    hTable = $con.Tables.Add("tblaccdemogoption", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flddemoid", db.String, 200)
    hTable.Fields.Add("fldanswertype", db.String, 50)
    hTable.Fields.Add("fldanswer", db.String, 250)
    hTable.Fields.Add("fldindex", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbillingset($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbillingset") Then
    hTable = $con.Tables.Add("tblbillingset", $DbEngine)
    hTable.Fields.Add("fldsetname", db.String, 50)
    hTable.PrimaryKey = ["fldsetname"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpackschedule($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpackschedule") Then
    hTable = $con.Tables.Add("tblpackschedule", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldtime", db.String, 50)
    hTable.Fields.Add("fldfromtime", db.Date)
    hTable.Fields.Add("fldtotime", db.Date)
    hTable.Fields.Add("fldday", db.String, 50)
    hTable.Fields.Add("flddaysvalue", db.String, 250)
    hTable.Fields.Add("fldmonth", db.String, 50)
    hTable.Fields.Add("fldmonthsvalue", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbillitem($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbillitem") Then
    hTable = $con.Tables.Add("tblbillitem", $DbEngine)
    hTable.Fields.Add("fldbillitem", db.String, 200)
    hTable.Fields.Add("flditemcateg", db.String, 25)
    hTable.PrimaryKey = ["fldbillitem"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbillsection($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbillsection") Then
    hTable = $con.Tables.Add("tblbillsection", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsection", db.String, 200)
    hTable.Fields.Add("fldcateg", db.String, 100)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcurrency($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcurrency") Then
    hTable = $con.Tables.Add("tblcurrency", $DbEngine)
    hTable.Fields.Add("flditemunit", db.String, 50)
    hTable.Fields.Add("fldconversion", db.Float)
    hTable.PrimaryKey = ["flditemunit"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblservicecheck($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblservicecheck") Then
    hTable = $con.Tables.Add("tblservicecheck", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtitle", db.String, 150)
    hTable.Fields.Add("flditemtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldagegroup", db.String, 25)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblservicecost($con As Connection)

  Dim hTable As Table

  ' If Not $con.Tables.Exist("tbltestcost") Then ''old name
  If Not $con.Tables.Exist("tblservicecost") Then
    hTable = $con.Tables.Add("tblservicecost", $DbEngine)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemcode", db.String, 100)
    hTable.Fields.Add("fldcode", db.String, 50)
    hTable.Fields.Add("fldid", db.Integer)
    hTable.Fields.Add("fldbillitem", db.String, 200)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("flditemcost", db.Float)
    hTable.Fields.Add("flditemunit", db.String, 50)
    hTable.Fields.Add("fldtarget", db.String, 50)  ''Target Comp or rate For
    hTable.Fields.Add("fldstatus", db.String, 50)  ''current status
    hTable.Fields.Add("fldwaitday", db.Integer)

    hTable.Fields.Add("fldgroup", db.String, 50)  ''BRate Plan
    hTable.Fields.Add("fldreport", db.String, 200)  ''Section
    hTable.Fields.Add("fldtaxcode", db.String, 150)
    hTable.Fields.Add("fldeditrate", db.Boolean)
    hTable.Fields.Add("fldeditdisc", db.Boolean)
    hTable.Fields.Add("fldpayable", db.Boolean)
    hTable.Fields.Add("fldpatentry", db.Boolean)

    hTable.Fields.Add("fldhospitalshare", db.Float)
    hTable.Fields.Add("fldinstrumshare", db.Float)
    hTable.Fields.Add("flddepartshare", db.Float)
    hTable.Fields.Add("fldanesthshare", db.Float)
    hTable.Fields.Add("fldothershare", db.Float)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldverifyid", db.String, 25)
      hTable.Fields.Add("fldverifytime", db.Date)
      hTable.Fields.Add("fldnote", db.String, 250)
    Endif
    hTable.PrimaryKey = ["flditemname"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblreportgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblreportgroup") Then
    hTable = $con.Tables.Add("tblreportgroup", $DbEngine)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("fldgroup", db.String, 250)
    hTable.Fields.Add("fldactive", db.String, 50)
    hTable.PrimaryKey = ["flditemname"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmasterdept($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmasterdept") Then
    hTable = $con.Tables.Add("tblmasterdept", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldmaster", db.String, 250)
    hTable.Fields.Add("fldgroup", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcostgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcostgroup") Then
    hTable = $con.Tables.Add("tblcostgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("flditemtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextrasetting($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextrasetting") Then
    hTable = $con.Tables.Add("tblextrasetting", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("flddiscpercent", db.Float)
    hTable.Fields.Add("fldcashmode", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldepconsult($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldepconsult") Then
    hTable = $con.Tables.Add("tbldepconsult", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("flddept", db.String, 50)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldselect", db.String, 25)
    hTable.Fields.Add("fldmethod", db.String, 25)
    hTable.Fields.Add("flddate", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    ' hTable.Fields.Add("fldfromtime", db.Date)
    ' hTable.Fields.Add("fldtotime", db.Date)
    hTable.Fields.Add("fldquota", db.Integer)
    hTable.Fields.Add("fldwebquota", db.Integer)
    hTable.Fields.Add("fldfrom", db.Date)
    hTable.Fields.Add("fldend", db.Date)
    hTable.Fields.Add("fldreason", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblprocedureshare($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblprocedureshare") Then
    hTable = $con.Tables.Add("tblprocedureshare", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsharetype", db.String, 100)
    hTable.Fields.Add("flditemtype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldusertype", db.String, 150)
    hTable.Fields.Add("fldmaxshare", db.Float)
    hTable.Fields.Add("flditemshare", db.Float)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("flditemtax", db.Float)
    hTable.Fields.Add("flddefault", db.String, 150)
    hTable.Fields.Add("fldactive", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblusershare($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblusershare") Then
    hTable = $con.Tables.Add("tblusershare", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsharetype", db.String, 100)
    hTable.Fields.Add("flditemtype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flddepartname", db.String, 50)
    hTable.Fields.Add("fldmaxshare", db.Float)
    hTable.Fields.Add("flditemshare", db.Float)
    hTable.Fields.Add("flditemtax", db.Float)
    hTable.Fields.Add("fldactive", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbluserpay($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbluserpay") Then
    hTable = $con.Tables.Add("tbluserpay", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 200)
    hTable.Fields.Add("flditemshare", db.Float)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("flditemtax", db.Float)
    hTable.Fields.Add("fldactive", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblservicegroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblservicegroup") Then
    hTable = $con.Tables.Add("tblservicegroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("flditemtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemqty", db.Float)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcostbreak($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcostbreak") Then
    hTable = $con.Tables.Add("tblcostbreak", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("flditemtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemrate", db.Float)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblautogroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblautogroup") Then
    hTable = $con.Tables.Add("tblautogroup", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldfollow", db.String, 50)
    hTable.Fields.Add("flditemtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemqty", db.Float)
    hTable.Fields.Add("fldexitemtype", db.String, 100)
    hTable.Fields.Add("fldcutoff", db.Date)
    hTable.Fields.Add("fldpayable", db.String, 50)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfoodorder($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfoodorder") Then
    hTable = $con.Tables.Add("tblfoodorder", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldgroup", db.String, 200)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flditemtype", db.String, 100)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemqty", db.Float)
    hTable.Fields.Add("fldpayable", db.String, 50)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltaxgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltaxgroup") Then
    hTable = $con.Tables.Add("tbltaxgroup", $DbEngine)
    hTable.Fields.Add("fldgroup", db.String, 150)
    hTable.Fields.Add("fldtaxper", db.Float)
    hTable.PrimaryKey = ["fldgroup"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldiscgroup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldiscgroup") Then
    hTable = $con.Tables.Add("tbldiscgroup", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldgroup", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcashvendor($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcashvendor") Then
    hTable = $con.Tables.Add("tblcashvendor", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldvendor", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbljournal($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbljournal") Then
    hTable = $con.Tables.Add("tbljournal", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("flddebitcateg", db.String, 250)
    hTable.Fields.Add("flddebitlfno", db.String, 250)
    hTable.Fields.Add("fldcreditcateg", db.String, 250)
    hTable.Fields.Add("fldcreditlfno", db.String, 250)
    hTable.Fields.Add("fldamt", db.Float)
    hTable.Fields.Add("flddate", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldreference", db.String, 50)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblacledger($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblacledger") Then
    hTable = $con.Tables.Add("tblacledger", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldacledger", db.String, 250)
    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("fldledgerid", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcategorylist($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcategorylist") Then
    hTable = $con.Tables.Add("tblcategorylist", $DbEngine)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldpackage", db.String, 250)
    hTable.Fields.Add("fldhiderank", db.Boolean)
    hTable.Fields.Add("fldhideunit", db.Boolean)
    hTable.PrimaryKey = ["fldcategory"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblschemecategory($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblschemecategory") Then
    hTable = $con.Tables.Add("tblschemecategory", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldpackage", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextrapayers($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextrapayers") Then
    hTable = $con.Tables.Add("tblextrapayers", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldpayername", db.String, 250)
    hTable.Fields.Add("fldpayeradd", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextrapayitems($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextrapayitems") Then
    hTable = $con.Tables.Add("tblextrapayitems", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblassetsname($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblassetsname") Then
    hTable = $con.Tables.Add("tblassetsname", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldgroup", db.String, 250)
    hTable.Fields.Add("fldledger", db.String, 250)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblassetsentry($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblassetsentry") Then
    hTable = $con.Tables.Add("tblassetsentry", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldgroup", db.String, 250)
    hTable.Fields.Add("fldspecs", db.String, 250)
    hTable.Fields.Add("fldcode", db.String, 250)
    hTable.Fields.Add("fldmanufacturer", db.String, 250)
    hTable.Fields.Add("fldmodel", db.String, 250)
    hTable.Fields.Add("fldserial", db.String, 250)

    hTable.Fields.Add("fldledger", db.String, 250)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("fldpurdate", db.Date)
    hTable.Fields.Add("fldpayment", db.String, 50)
    hTable.Fields.Add("fldqty", db.Integer)
    hTable.Fields.Add("fldunit", db.String, 50)
    hTable.Fields.Add("flditemrate", db.Float)
    hTable.Fields.Add("fldtaxamt", db.Float)
    hTable.Fields.Add("flddiscamt", db.Float)
    hTable.Fields.Add("fldexpense", db.Float)
    hTable.Fields.Add("fldditemamt", db.Float)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldcondition", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("fldrepairdate", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''---------------------------- For CreateDatabaseForSish_Inventory ----------------------------
Public Sub CREATEtblentry($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblentry") Then
    hTable = $con.Tables.Add("tblentry", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldstockno", db.Long)
    Else
      hTable.Fields.Add("fldstockno", db.Long)
    Endif
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldbatch", db.String, 50)
    hTable.Fields.Add("fldexpiry", db.Date)
    hTable.Fields.Add("fldqty", db.Float)
    hTable.Fields.Add("fldstatus", db.Integer)
    hTable.Fields.Add("fldcost", db.Float)
    hTable.Fields.Add("fldsellpr", db.Float)
    hTable.Fields.Add("fldmrp", db.Float)
    hTable.Fields.Add("fldsav", db.Boolean)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldselltime", db.Date)
    hTable.Fields.Add("fldselluserid", db.String, 25)
    hTable.Fields.Add("fldcode", db.String, 50)    ''used for serial port
    hTable.Fields.Add("fldpast", db.Float) ''past dispensed qty
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldstockno"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblentrybackup($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblentrybackup") Then
    hTable = $con.Tables.Add("tblentrybackup", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldstockno", db.Long)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldbatch", db.String, 50)
    hTable.Fields.Add("fldexpiry", db.Date)
    hTable.Fields.Add("fldqty", db.Float)
    hTable.Fields.Add("fldstatus", db.Integer)
    hTable.Fields.Add("fldcost", db.Float)
    hTable.Fields.Add("fldsellpr", db.Float)
    hTable.Fields.Add("fldmrp", db.Float)
    hTable.Fields.Add("fldsav", db.Boolean)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldselltime", db.Date)
    hTable.Fields.Add("fldselluserid", db.String, 25)
    hTable.Fields.Add("fldcode", db.String, 50)    ''used for serial port
    hTable.Fields.Add("fldpast", db.Float) ''past dispensed qty

    hTable.Fields.Add("fldentrytime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblstockrate($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblstockrate") Then
    hTable = $con.Tables.Add("tblstockrate", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("flddrug", db.String, 200)
    hTable.Fields.Add("flddrugcode", db.String, 200)
    hTable.Fields.Add("fldpackvol", db.Float)
    hTable.Fields.Add("fldstockid", db.String, 200)
    hTable.Fields.Add("fldrate", db.Float)
    hTable.Fields.Add("fldnullrate", db.Boolean)
    hTable.Fields.Add("fldmaxqty", db.Float)
    hTable.Fields.Add("fldwaitday", db.Integer)
    hTable.Fields.Add("fldclaimtype", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbladjustment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbladjustment") Then
    hTable = $con.Tables.Add("tbladjustment", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldstockno", db.Long)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldnetcost", db.Float)
    hTable.Fields.Add("fldsellpr", db.Float)
    hTable.Fields.Add("fldcompqty", db.Float)
    hTable.Fields.Add("fldcurrqty", db.Float)
    hTable.Fields.Add("fldreason", db.String, 255)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldsav", db.Boolean)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpurchase($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpurchase") Then
    hTable = $con.Tables.Add("tblpurchase", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldpurtype", db.String, 25)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldstockno", db.Long)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldmrp", db.Float)
    hTable.Fields.Add("flsuppcost", db.Float)
    hTable.Fields.Add("fldcasdisc", db.Float)
    hTable.Fields.Add("fldcasbonus", db.Float)
    hTable.Fields.Add("fldqtybonus", db.Float)
    hTable.Fields.Add("fldcarcost", db.Float)
    hTable.Fields.Add("fldnetcost", db.Float)
    hTable.Fields.Add("fldtaxamt", db.Float)
    hTable.Fields.Add("fldmargin", db.Float)
    hTable.Fields.Add("fldsellprice", db.Float)
    hTable.Fields.Add("fldtotalqty", db.Float)
    hTable.Fields.Add("fldreturnqty", db.Float)
    hTable.Fields.Add("fldtotalcost", db.Float)
    hTable.Fields.Add("fldpurdate", db.Date)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsav", db.Boolean)
    hTable.Fields.Add("fldpurorder", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    hTable.Indexes.Add(hTable.Name & "_fldreference", ["fldreference"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpurchasebill($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpurchasebill") Then
    hTable = $con.Tables.Add("tblpurchasebill", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldpurtype", db.String, 25)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldpurorder", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("flddebit", db.Float)
    hTable.Fields.Add("fldcredit", db.Float)
    hTable.Fields.Add("fldtotaltax", db.Float)
    hTable.Fields.Add("fldlastdisc", db.Float)
    hTable.Fields.Add("fldadjust", db.Float)
    hTable.Fields.Add("fldpurdate", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsav", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldreference", ["fldreference"], True)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblstockreturn($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblstockreturn") Then
    hTable = $con.Tables.Add("tblstockreturn", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldstockno", db.Long)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldqty", db.Float)
    hTable.Fields.Add("fldcost", db.Float)
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldnewreference", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsupplier($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsupplier") Then
    hTable = $con.Tables.Add("tblsupplier", $DbEngine)
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("fldsuppaddress", db.String, 250)
    hTable.Fields.Add("fldsupppan", db.String, 250)
    hTable.Fields.Add("fldsuppledger", db.String, 250)
    hTable.Fields.Add("fldsuppphone", db.String, 250)
    hTable.Fields.Add("fldsuppemail", db.String, 250)
    hTable.Fields.Add("fldcontactname", db.String, 250)
    hTable.Fields.Add("fldcontactphone", db.String, 250)
    hTable.Fields.Add("fldstartdate", db.Date)
    hTable.Fields.Add("fldpaymentmode", db.String, 25)
    hTable.Fields.Add("fldcreditday", db.Float)
    hTable.Fields.Add("fldactive", db.String, 10)
    hTable.Fields.Add("fldpaiddebit", db.Float)
    hTable.Fields.Add("fldleftcredit", db.Float)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldsuppname"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltenderlist($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltenderlist") Then
    hTable = $con.Tables.Add("tbltenderlist", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("flditemtype", db.String, 25)
    hTable.Fields.Add("fldfromdate", db.Date)
    hTable.Fields.Add("fldtodate", db.Date)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldtotalqty", db.Float)
    hTable.Fields.Add("fldmaxcost", db.Float)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsav", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpayment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpayment") Then
    hTable = $con.Tables.Add("tblpayment", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("fldpayamount", db.Float)
    hTable.Fields.Add("fldpaytype", db.String, 50)
    hTable.Fields.Add("fldchequeno", db.String, 250)
    hTable.Fields.Add("fldbankname", db.String, 250)
    hTable.Fields.Add("fldpaidby", db.String, 250)
    hTable.Fields.Add("fldpaidbypost", db.String, 250)
    hTable.Fields.Add("fldrecvby", db.String, 250)
    hTable.Fields.Add("fldrecvbypost", db.String, 250)
    hTable.Fields.Add("fldrecvbycontact", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpurorder($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpurorder") Then
    hTable = $con.Tables.Add("tblpurorder", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldrate", db.Float)
    hTable.Fields.Add("fldqty", db.Float)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("fldsuppname", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("flddelivery", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldverify", db.String, 150)
    hTable.Fields.Add("fldverify_time", db.Date)
    hTable.Fields.Add("fldconfirm", db.String, 150)
    hTable.Fields.Add("fldconfirm_time", db.Date)
    hTable.Fields.Add("fldrecvref", db.String, 250)
    hTable.Fields.Add("fldrecvuserid", db.String, 25)
    hTable.Fields.Add("fldrecvtime", db.Date)

    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
  Endif

End

Public Sub CREATEtblrequest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblrequest") Then
    hTable = $con.Tables.Add("tblrequest", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldqty", db.Float)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("fldfinalqty", db.Float)
    hTable.Fields.Add("fldurgent", db.String, 50)
    hTable.Fields.Add("fldexpdate", db.Date)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldremarks", db.String, 250)

    hTable.Fields.Add("fldorduserid", db.String, 25)
    hTable.Fields.Add("fldordtime", db.Date)
    hTable.Fields.Add("fldordcomp", db.String, 50)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)

    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltransfer($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltransfer") Then
    hTable = $con.Tables.Add("tbltransfer", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldstockno", db.Long)
    hTable.Fields.Add("fldoldstockno", db.Long)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldqty", db.Float)
    hTable.Fields.Add("fldnetcost", db.Float)
    hTable.Fields.Add("fldsellpr", db.Float)
    hTable.Fields.Add("fldsav", db.Boolean)

    hTable.Fields.Add("fldfromentrytime", db.Date)
    hTable.Fields.Add("fldfromuser", db.String, 25)
    hTable.Fields.Add("fldfromcomp", db.String, 50)
    hTable.Fields.Add("fldfromsav", db.Boolean)
    hTable.Fields.Add("fldtoentrytime", db.Date)
    hTable.Fields.Add("fldtouser", db.String, 25)
    hTable.Fields.Add("fldtocomp", db.String, 50)
    hTable.Fields.Add("fldtosav", db.Boolean)

    hTable.Fields.Add("fldlockcomp", db.String, 50)
    hTable.Fields.Add("fldrequest", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtoentrytime", ["fldtoentrytime"], False)
    hTable.Indexes.Add(hTable.Name & "_fldreference", ["fldreference"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltarget($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltarget") Then
    hTable = $con.Tables.Add("tbltarget", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbulksale($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbulksale") Then
    hTable = $con.Tables.Add("tblbulksale", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldtarget", db.String, 250)
    hTable.Fields.Add("fldbulktime", db.Date)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldstockno", db.Long)
    hTable.Fields.Add("fldstockid", db.String, 250)
    hTable.Fields.Add("fldnetcost", db.Float)
    hTable.Fields.Add("fldqtydisp", db.Float)
    hTable.Fields.Add("fldqtyret", db.Float)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)

    hTable.Fields.Add("fldrequest", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    hTable.Indexes.Add(hTable.Name & "_fldreference", ["fldreference"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------- blood/other products inventory
Public Sub CREATEtblmedinventory($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmedinventory") Then
    hTable = $con.Tables.Add("tblmedinventory", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldcode", db.String, 250)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldencname", db.String, 250)
    hTable.Fields.Add("fldcollect", db.Date)
    hTable.Fields.Add("fldexpiry", db.Date)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldcomment", db.String, 250)

    hTable.Fields.Add("fldreceiver", db.String, 150)
    hTable.Fields.Add("fldfirsttime", db.Date)
    hTable.Fields.Add("fldsecondtime", db.Date)
    hTable.Fields.Add("flduserid_start", db.String, 25)
    hTable.Fields.Add("fldcomp_start", db.String, 50)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldcode", ["fldcode"], True)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------------------FOR CreateDatabaseForSish_Patient---------------------------
Public Sub CREATEtblpatientbook($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatientbook") Then
    hTable = $con.Tables.Add("tblpatientbook", $DbEngine)
    hTable.Fields.Add("fldbookingval", db.String, 150)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldptnamefir", db.String, 150)
    hTable.Fields.Add("fldptnamelast", db.String, 150)
    hTable.Fields.Add("fldethniccode", db.String, 50)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldptaddvill", db.String, 150)
    hTable.Fields.Add("fldptaddward", db.String, 150)
    hTable.Fields.Add("fldptadddist", db.String, 150)
    hTable.Fields.Add("fldptcontact", db.String, 150)
    hTable.Fields.Add("fldptguardian", db.String, 250)
    hTable.Fields.Add("fldrelation", db.String, 250)
    hTable.Fields.Add("fldptbirday", db.Date)
    hTable.Fields.Add("fldptadmindate", db.Date)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldptcode", db.String, 250)
    hTable.Fields.Add("fldconsultdate", db.Date)
    hTable.Fields.Add("fldadmitlocat", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldstate", db.String, 25)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldorduserid", db.String, 150)
    hTable.Fields.Add("fldpayreference", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldremotemail", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldbookingval"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldpatientval", ["fldpatientval"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblonlinebook($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblonlinebook") Then
    hTable = $con.Tables.Add("tblonlinebook", $DbEngine)
    hTable.Fields.Add("fldbookingval", db.String, 150)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldptnamefir", db.String, 150)
    hTable.Fields.Add("fldptnamelast", db.String, 150)
    hTable.Fields.Add("fldethniccode", db.String, 50)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldptaddvill", db.String, 150)
    hTable.Fields.Add("fldptaddward", db.String, 150)
    hTable.Fields.Add("fldptadddist", db.String, 150)
    hTable.Fields.Add("fldptcontact", db.String, 150)
    hTable.Fields.Add("fldptguardian", db.String, 250)
    hTable.Fields.Add("fldrelation", db.String, 250)
    hTable.Fields.Add("fldptbirday", db.Date)
    hTable.Fields.Add("fldptadmindate", db.Date)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldptcode", db.String, 250)
    hTable.Fields.Add("fldconsultdate", db.Date)
    hTable.Fields.Add("fldadmitlocat", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldstate", db.String, 25)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldorduserid", db.String, 150)
    hTable.Fields.Add("fldhashcode", db.String, 250)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("fldpayreference", db.String, 250)
    hTable.Fields.Add("fldhospital", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldremotemail", db.String, 250)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldbookingval"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldpatientval", ["fldpatientval"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatientinfo($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatientinfo") Then
    hTable = $con.Tables.Add("tblpatientinfo", $DbEngine)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldptnamefir", db.String, 150)
    hTable.Fields.Add("fldptnamelast", db.String, 150)
    hTable.Fields.Add("fldethniccode", db.String, 50)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldptaddvill", db.String, 150)
    hTable.Fields.Add("fldptaddward", db.String, 150)
    hTable.Fields.Add("fldptadddist", db.String, 150)
    hTable.Fields.Add("fldptcontact", db.String, 150)
    hTable.Fields.Add("fldptguardian", db.String, 250)
    hTable.Fields.Add("fldrelation", db.String, 250)
    hTable.Fields.Add("fldptbirday", db.Date)
    hTable.Fields.Add("fldptadmindate", db.Date)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldptcode", db.String, 250)
    hTable.Fields.Add("flddiscount", db.String, 150)
    hTable.Fields.Add("fldadmitfile", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("fldencrypt", db.Boolean)
    hTable.Fields.Add("fldpassword", db.String, 250)
    ''------------- OPTIONAL-------------------
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldrank", db.String, 250)
    hTable.Fields.Add("fldunit", db.String, 250)
    ''-------------------------------------
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldupuser", db.String, 25)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldpatientval"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldptbirday", ["fldptbirday"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblencounter($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblencounter") Then
    hTable = $con.Tables.Add("tblencounter", $DbEngine)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldadmitlocat", db.String, 100)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldadmission", db.String, 25)
    hTable.Fields.Add("fldregdate", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldvisit", db.String, 50)
    hTable.Fields.Add("fldfollow", db.String, 50)

    hTable.Fields.Add("fldcurrlocat", db.String, 100)
    hTable.Fields.Add("fldadmitward", db.String, 100)
    hTable.Fields.Add("fldadmitbed", db.String, 100)
    hTable.Fields.Add("flddoa", db.Date)
    hTable.Fields.Add("flddod", db.Date)
    hTable.Fields.Add("fldheight", db.String, 10)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldcashdeposit", db.Float)
    hTable.Fields.Add("fldcashcredit", db.Float)
    hTable.Fields.Add("fldcharity", db.Float)
    hTable.Fields.Add("fldvalidity", db.Date)
    hTable.Fields.Add("fldfollowdate", db.Date)
    hTable.Fields.Add("fldreferto", db.String, 250)

    hTable.Fields.Add("fldregistid", db.String, 150)
    hTable.Fields.Add("fldadmitid", db.String, 150)
    hTable.Fields.Add("fldpassword", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldencounterval"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldpatientval", ["fldpatientval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldregdate", ["fldregdate"], False)
    hTable.Indexes.Add(hTable.Name & "_flddoa", ["flddoa"], False)
    hTable.Indexes.Add(hTable.Name & "_flddod", ["flddod"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblabsconder($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblabsconder") Then
    hTable = $con.Tables.Add("tblabsconder", $DbEngine)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldreason", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.PrimaryKey = ["fldpatientval"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcreditlimit($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcreditlimit") Then
    hTable = $con.Tables.Add("tblcreditlimit", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldcashcredit", db.Float)
    hTable.Fields.Add("fldcharity", db.Float)
    hTable.Fields.Add("fldvalidity", db.Date)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblclaimcode($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblclaimcode") Then
    hTable = $con.Tables.Add("tblclaimcode", $DbEngine)
    hTable.Fields.Add("fldclaimid", db.String, 150)
    hTable.Fields.Add("fldclaimtype", db.String, 150)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldptcode", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldorduserid", db.String, 25)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldclaimid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblssfclaim($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblssfclaim") Then
    hTable = $con.Tables.Add("tblssfclaim", $DbEngine)
    hTable.Fields.Add("fldclaimid", db.String, 150)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldptcode", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 25)

    hTable.Fields.Add("fldemployer", db.String, 250)
    hTable.Fields.Add("fldscheme", db.String, 100)
    hTable.Fields.Add("fldsubproduct", db.String, 100)
    hTable.Fields.Add("fldwound", db.String, 100)
    hTable.Fields.Add("fldinjury", db.String, 100)
    hTable.Fields.Add("flddisable", db.String, 100)
    hTable.Fields.Add("flddead", db.String, 100)
    hTable.Fields.Add("fldaccident", db.String, 100)
    hTable.Fields.Add("fldsickness", db.String, 100)
    hTable.Fields.Add("flddischarge", db.String, 100)
    hTable.Fields.Add("flddischsumm", db.String, 100)
    hTable.Fields.Add("fldcancer", db.String, 100)
    hTable.Fields.Add("fldhiv", db.String, 100)
    hTable.Fields.Add("fldheart", db.String, 100)
    hTable.Fields.Add("fldhighbp", db.String, 100)
    hTable.Fields.Add("flddiabetes", db.String, 100)

    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldclaimid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpataccgeneral($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpataccgeneral") Then
    hTable = $con.Tables.Add("tblpataccgeneral", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldinput", db.String, 250) '''type ("Procedure")
    hTable.Fields.Add("fldtype", db.String, 250)  '''quali or quanti
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldreportquali", db.String, 250)
    hTable.Fields.Add("fldreportquanti", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 10000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldnewdate", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatdevice($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatdevice") Then
    hTable = $con.Tables.Add("tblpatdevice", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    '     hTable.Fields.Add("fldencounterid", db.Long)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flddevicetype", db.String, 250)
    hTable.Fields.Add("flddevicepath", db.String, 250)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatientdate($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatientdate") Then
    hTable = $con.Tables.Add("tblpatientdate", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldhead", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatientexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatientexam") Then
    hTable = $con.Tables.Add("tblpatientexam", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldserial", db.Integer) ''''NOT Required: Kept only for mobile compatibility
    hTable.Fields.Add("fldserialval", db.String, 250)
    hTable.Fields.Add("fldinput", db.String, 250) '''type (ClinExam,Exam,Test)
    hTable.Fields.Add("fldtype", db.String, 250)  '''quali or quanti
    hTable.Fields.Add("fldhead", db.String, 250)
    hTable.Fields.Add("fldsysconst", db.String, 250)
    hTable.Fields.Add("fldoption", db.String, 50)
    hTable.Fields.Add("fldmethod", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldrepquali", db.String, 10000)
    Else
      hTable.Fields.Add("fldrepquali", db.String)
    Endif
    hTable.Fields.Add("fldrepquanti", db.Float)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldrepdate", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatientsubexam($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatientsubexam") Then
    hTable = $con.Tables.Add("tblpatientsubexam", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldheadid", db.Long)
    hTable.Fields.Add("fldparent", db.String, 250)
    hTable.Fields.Add("fldsubtexam", db.String, 200)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreport", db.String, 10000)
    Else
      hTable.Fields.Add("fldreport", db.String)
    Endif
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldheadid", ["fldheadid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldindex", ["fldindex"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatexamsubtable($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatexamsubtable") Then
    hTable = $con.Tables.Add("tblpatexamsubtable", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldexamid", db.Long)
    hTable.Fields.Add("fldsubexamid", db.Long)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 150)
    hTable.Fields.Add("fldvariable", db.String, 200)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldcolm2", db.String, 250)
    hTable.Fields.Add("fldcolm3", db.String, 250)
    hTable.Fields.Add("fldcolm4", db.String, 250)
    hTable.Fields.Add("fldhide", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldsubexamid", ["fldsubexamid"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatlabtest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatlabtest") Then
    hTable = $con.Tables.Add("tblpatlabtest", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtestid", db.String, 250)
    hTable.Fields.Add("fldmethod", db.String, 250)
    hTable.Fields.Add("fldgroupid", db.Long)
    hTable.Fields.Add("fldsampleid", db.String, 250)
    hTable.Fields.Add("fldsampletype", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreportquali", db.String, 10000)
    Else
      hTable.Fields.Add("fldreportquali", db.String)
    Endif
    hTable.Fields.Add("fldreportquanti", db.Float)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldtestunit", db.String, 25)
    hTable.Fields.Add("fldstatus", db.String, 250)
    hTable.Fields.Add("fldprint", db.Boolean)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("fldrefername", db.String, 250)
    hTable.Fields.Add("fldcondition", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("flvisible", db.String, 50)

    hTable.Fields.Add("fldtest_type", db.String, 50)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("fldorder", db.Integer)

    hTable.Fields.Add("flduserid_sample", db.String, 25)
    hTable.Fields.Add("fldtime_sample", db.Date)
    hTable.Fields.Add("fldcomp_sample", db.String, 50)
    hTable.Fields.Add("fldsave_sample", db.Boolean)
    hTable.Fields.Add("flduptime_sample", db.Date)

    hTable.Fields.Add("flduserid_start", db.String, 25)
    hTable.Fields.Add("fldtime_start", db.Date)
    hTable.Fields.Add("fldcomp_start", db.String, 50)
    hTable.Fields.Add("fldsave_start", db.Boolean)
    hTable.Fields.Add("flduptime_start", db.Date)

    hTable.Fields.Add("flduserid_report", db.String, 25)
    hTable.Fields.Add("fldtime_report", db.Date)
    hTable.Fields.Add("fldcomp_report", db.String, 50)
    hTable.Fields.Add("fldsave_report", db.Boolean)
    hTable.Fields.Add("flduptime_report", db.Date)
    hTable.Fields.Add("fldupuser_report", db.String, 25)

    hTable.Fields.Add("flduserid_verify", db.String, 25)
    hTable.Fields.Add("fldtime_verify", db.Date)
    hTable.Fields.Add("fldcomp_verify", db.String, 50)
    hTable.Fields.Add("fldsave_verify", db.Boolean)
    hTable.Fields.Add("flduptime_verify", db.Date)
    hTable.Fields.Add("fldupuser_verify", db.String, 25)

    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldsampleid", ["fldsampleid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime_sample", ["fldtime_sample"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatlabsubtest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatlabsubtest") Then
    hTable = $con.Tables.Add("tblpatlabsubtest", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtestid", db.Long)
    hTable.Fields.Add("fldparent", db.String, 250)
    hTable.Fields.Add("fldsubtest", db.String, 200)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreport", db.String, 10000)
    Else
      hTable.Fields.Add("fldreport", db.String)
    Endif
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("fldorder", db.Integer)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtestid", ["fldtestid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldindex", ["fldindex"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatlabsubtable($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatlabsubtable") Then
    hTable = $con.Tables.Add("tblpatlabsubtable", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldtestid", db.Long)
    hTable.Fields.Add("fldsubtestid", db.Long)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 150)
    hTable.Fields.Add("fldvariable", db.String, 200)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldcolm2", db.String, 250)
    hTable.Fields.Add("fldcolm3", db.String, 250)
    hTable.Fields.Add("fldcolm4", db.String, 250)
    hTable.Fields.Add("fldhide", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtestid_fldsubtestid", ["fldsubtestid", "fldtestid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldindex", ["fldindex"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatfindings($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatfindings") Then
    hTable = $con.Tables.Add("tblpatfindings", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldcode", db.String, 255)
    hTable.Fields.Add("fldcodeid", db.String, 255)
    hTable.Fields.Add("fldcodenew", db.String, 25)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblexamgeneral($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblexamgeneral") Then
    hTable = $con.Tables.Add("tblexamgeneral", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldinput", db.String, 250) '''type
    hTable.Fields.Add("fldtype", db.String, 250)  '''quali or quanti
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldreportquali", db.String, 250)
    hTable.Fields.Add("fldreportquanti", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 10000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatgeneral($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatgeneral") Then
    hTable = $con.Tables.Add("tblpatgeneral", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldinput", db.String, 250) '''type ("Procedure")
    hTable.Fields.Add("fldgroupid", db.Long)
    ' hTable.Fields.Add("fldtype", db.String, 250)  '''quali or quanti
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldreportquali", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 25)
    '     hTable.Fields.Add("fldreportquanti", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddetail", db.String, 10000)
    Else
      hTable.Fields.Add("flddetail", db.String)
    Endif
    hTable.Fields.Add("fldnewdate", db.Date)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldorduserid", db.String, 25)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatsubgeneral($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatsubgeneral") Then
    hTable = $con.Tables.Add("tblpatsubgeneral", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditemid", db.Long)
    hTable.Fields.Add("fldchapter", db.String, 200)
    hTable.Fields.Add("fldreportquali", db.String, 250)
    hTable.Fields.Add("fldreportquanti", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreport", db.String, 10000)
    Else
      hTable.Fields.Add("fldreport", db.String)
    Endif
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_flditemid", ["flditemid"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatgenshare($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatgenshare") Then
    hTable = $con.Tables.Add("tblpatgenshare", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditemid", db.Long)
    hTable.Fields.Add("fldcategory", db.String, 200)
    hTable.Fields.Add("fldusertype", db.String, 200)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldreport", db.String, 250)
    hTable.Fields.Add("fldmixper", db.Float)
    hTable.Fields.Add("fldchange", db.Float)
    hTable.Fields.Add("fldchreason", db.String, 250)
    hTable.Fields.Add("fldactive", db.String, 25)

    hTable.Fields.Add("fldshareamt", db.Float)
    hTable.Fields.Add("fldtdsper", db.Float)
    hTable.Fields.Add("fldsharenet", db.Float)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_flditemid", ["flditemid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsharepayment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsharepayment") Then
    hTable = $con.Tables.Add("tblsharepayment", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldpayto", db.String, 25)
    hTable.Fields.Add("fldfrom", db.Date)
    hTable.Fields.Add("fldto", db.Date)
    hTable.Fields.Add("fldshareamt", db.Float)
    hTable.Fields.Add("fldtdsper", db.Float)
    hTable.Fields.Add("fldsharenet", db.Float)
    hTable.Fields.Add("fldextra", db.Float)
    hTable.Fields.Add("fldcomment", db.String, 250)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatplanning($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatplanning") Then
    hTable = $con.Tables.Add("tblpatplanning", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldplancategory", db.String, 150)
    hTable.Fields.Add("fldproblem", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldsubjective", db.String, 2500)
      hTable.Fields.Add("fldobjective", db.String, 2500)
      hTable.Fields.Add("fldassess", db.String, 2500)
      hTable.Fields.Add("fldplan", db.String, 2500)
    Else
      hTable.Fields.Add("fldsubjective", db.String)
      hTable.Fields.Add("fldobjective", db.String)
      hTable.Fields.Add("fldassess", db.String)
      hTable.Fields.Add("fldplan", db.String)
    Endif
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatevents($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatevents") Then
    hTable = $con.Tables.Add("tblpatevents", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 250)
    hTable.Fields.Add("flddetail", db.String, 255)
    hTable.Fields.Add("fldcomment", db.String, 255)

    hTable.Fields.Add("fldfirstuserid", db.String, 25)
    hTable.Fields.Add("fldfirsttime", db.Date)
    hTable.Fields.Add("fldfirstcomp", db.String, 50)
    hTable.Fields.Add("fldfirstsave", db.Boolean)

    hTable.Fields.Add("fldseconduserid", db.String, 25)
    hTable.Fields.Add("fldsecondtime", db.Date)
    hTable.Fields.Add("fldsecondcomp", db.String, 50)
    hTable.Fields.Add("fldsecondsave", db.Boolean)

    hTable.Fields.Add("fldstatus", db.String, 100)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldfirsttime", ["fldfirsttime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpattiming($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpattiming") Then
    hTable = $con.Tables.Add("tblpattiming", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtype", db.String, 250)
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldbillitem", db.String, 250)
    hTable.Fields.Add("flddisctype", db.String, 150)

    hTable.Fields.Add("fldfirstreport", db.String, 250)
    hTable.Fields.Add("fldfirstuserid", db.String, 25)
    hTable.Fields.Add("fldfirsttime", db.Date)
    hTable.Fields.Add("fldfirstcomp", db.String, 50)
    hTable.Fields.Add("fldfirstsave", db.Boolean)

    hTable.Fields.Add("fldsecondreport", db.String, 250)
    hTable.Fields.Add("fldseconduserid", db.String, 25)
    hTable.Fields.Add("fldsecondtime", db.Date)
    hTable.Fields.Add("fldsecondcomp", db.String, 50)
    hTable.Fields.Add("fldsecondsave", db.Boolean)

    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldfirsttime", ["fldfirsttime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblconsult($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblconsult") Then
    hTable = $con.Tables.Add("tblconsult", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldconsultname", db.String, 250)
    hTable.Fields.Add("fldconsulttime", db.Date)
    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("fldoutcome", db.String, 25)
    hTable.Fields.Add("fldnotice", db.String, 255)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldsummary", db.String, 10000)
    Else
      hTable.Fields.Add("fldsummary", db.String)
    Endif

    hTable.Fields.Add("fldorduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)

    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("fldflagtime", db.Date)
    hTable.Fields.Add("fldconsultid", db.String, 150)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldconsulttime", ["fldconsulttime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblopvisit($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblopvisit") Then
    hTable = $con.Tables.Add("tblopvisit", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldconsultname", db.String, 250)
    hTable.Fields.Add("fldconsulttime", db.Date)
    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldoutcome", db.String, 25)
    hTable.Fields.Add("fldnotice", db.String, 255)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldsummary", db.String, 10000)
    Else
      hTable.Fields.Add("fldsummary", db.String)
    Endif

    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)

    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("fldflagtime", db.Date)
    hTable.Fields.Add("fldemerid", db.String, 150)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldconsulttime", ["fldconsulttime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblgenviolence($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblgenviolence") Then
    hTable = $con.Tables.Add("tblgenviolence", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldviotype", db.String, 250)
    hTable.Fields.Add("fldviocause", db.String, 250)
    hTable.Fields.Add("flddisability", db.String, 250)
    hTable.Fields.Add("fldservice", db.String, 250)
    hTable.Fields.Add("fldperpname", db.String, 250)
    hTable.Fields.Add("fldrelation", db.String, 100)
    hTable.Fields.Add("fldperpsex", db.String, 25)
    hTable.Fields.Add("fldperpage", db.Float)

    hTable.Fields.Add("fldcommtype", db.String, 250)
    hTable.Fields.Add("fldcommcause", db.String, 250)
    hTable.Fields.Add("fldcommability", db.String, 250)
    hTable.Fields.Add("fldcommservice", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldviolref", db.String, 150)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblobstetrics($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblobstetrics") Then
    hTable = $con.Tables.Add("tblobstetrics", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldgravida", db.Integer)
    hTable.Fields.Add("fldparity", db.Integer)
    hTable.Fields.Add("fldbortion", db.Integer)
    hTable.Fields.Add("fldlive", db.Integer)
    hTable.Fields.Add("fldlast", db.Date)
    hTable.Fields.Add("fldexpect", db.Date)
    hTable.Fields.Add("fldgestation", db.Integer)
    hTable.Fields.Add("fldpresent", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 250)
    hTable.Fields.Add("fldpast", db.String, 250)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("flddelref", db.String, 150)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldlast", ["fldlast"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblconfinement($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblconfinement") Then
    hTable = $con.Tables.Add("tblconfinement", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flddeltime", db.Date)
    hTable.Fields.Add("fldpresent", db.String, 250)
    hTable.Fields.Add("flddeltype", db.String, 250)
    hTable.Fields.Add("flddelresult", db.String, 250)
    hTable.Fields.Add("flddelphysician", db.String, 25)
    hTable.Fields.Add("flddelnurse", db.String, 250)
    hTable.Fields.Add("fldcomplication", db.String, 250)
    hTable.Fields.Add("flddeformity", db.String, 250)
    hTable.Fields.Add("fldlabour", db.String, 250)
    hTable.Fields.Add("fldbloodloss", db.Float)
    hTable.Fields.Add("flddelwt", db.Float)
    hTable.Fields.Add("fldbabypatno", db.String, 150)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldcomment", db.String, 10000)
    Else
      hTable.Fields.Add("fldcomment", db.String)
    Endif
    hTable.Fields.Add("flddelassist", db.String, 250)
    hTable.Fields.Add("flddelspot", db.String, 250)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldbabyref", db.String, 150)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_flddeltime", ["flddeltime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatradiotest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatradiotest") Then
    hTable = $con.Tables.Add("tblpatradiotest", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtestid", db.String, 250)
    hTable.Fields.Add("fldmethod", db.String, 250)
    hTable.Fields.Add("fldgroupid", db.Long)
    hTable.Fields.Add("fldsampletype", db.String, 250)
    hTable.Fields.Add("fldsampleid", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreportquali", db.String, 10000)
    Else
      hTable.Fields.Add("fldreportquali", db.String)
    Endif
    hTable.Fields.Add("fldreportquanti", db.Float)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 250)
    hTable.Fields.Add("fldprint", db.Boolean)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("fldrefername", db.String, 250)
    hTable.Fields.Add("fldcondition", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("flvisible", db.String, 50)
    hTable.Fields.Add("fldnewdate", db.Date)
    hTable.Fields.Add("fldpacstudy", db.String, 255)
    hTable.Fields.Add("fldpacseries", db.String, 255)
    hTable.Fields.Add("fldpacsform", db.String, 25)

    hTable.Fields.Add("fldtest_type", db.String, 50)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("fldorder", db.Integer)
    hTable.Fields.Add("fldbcounter", db.String, 100)

    hTable.Fields.Add("flduserid_report", db.String, 25)
    hTable.Fields.Add("fldtime_report", db.Date)
    hTable.Fields.Add("fldcomp_report", db.String, 50)
    hTable.Fields.Add("fldsave_report", db.Boolean)
    hTable.Fields.Add("flduptime_report", db.Date)
    hTable.Fields.Add("fldupuser_report", db.String, 25)

    hTable.Fields.Add("flduserid_verify", db.String, 25)
    hTable.Fields.Add("fldtime_verify", db.Date)
    hTable.Fields.Add("fldcomp_verify", db.String, 50)
    hTable.Fields.Add("fldsave_verify", db.Boolean)
    hTable.Fields.Add("flduptime_verify", db.Date)
    hTable.Fields.Add("fldupuser_verify", db.String, 25)

    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime_report", ["fldtime_report"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatradiosubtest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatradiosubtest") Then
    hTable = $con.Tables.Add("tblpatradiosubtest", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtestid", db.Long)
    hTable.Fields.Add("fldparent", db.String, 250)
    hTable.Fields.Add("fldsubtest", db.String, 200)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreport", db.String, 10000)
    Else
      hTable.Fields.Add("fldreport", db.String)
    Endif
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldorder", db.Integer)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtestid", ["fldtestid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldindex", ["fldindex"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatradiosubtable($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatradiosubtable") Then
    hTable = $con.Tables.Add("tblpatradiosubtable", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldexamid", db.Long)
    hTable.Fields.Add("fldsubexamid", db.Long)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtype", db.String, 150)
    hTable.Fields.Add("fldvariable", db.String, 200)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldcolm2", db.String, 250)
    hTable.Fields.Add("fldcolm3", db.String, 250)
    hTable.Fields.Add("fldcolm4", db.String, 250)
    hTable.Fields.Add("fldhide", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldexamid_fldsubexamid", ["fldsubexamid", "fldexamid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldindex", ["fldindex"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblradiocounter($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblradiocounter") Then
    hTable = $con.Tables.Add("tblradiocounter", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcounter", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblsurgerysection($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblsurgerysection") Then
    hTable = $con.Tables.Add("tblsurgerysection", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldsection", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblmonitor($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblmonitor") Then
    hTable = $con.Tables.Add("tblmonitor", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 25)
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldevery", db.Integer)
    hTable.Fields.Add("fldunit", db.String, 25)
    hTable.Fields.Add("fldtype", db.String, 150)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextradosing($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextradosing") Then
    hTable = $con.Tables.Add("tblextradosing", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 25)
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("flddose", db.Float)
    hTable.Fields.Add("fldfreq", db.String, 25)
    hTable.Fields.Add("fldtype", db.String, 150)
    hTable.Fields.Add("flddosetime", db.Date)
    hTable.Fields.Add("flddosecode", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblusercollection($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblusercollection") Then
    hTable = $con.Tables.Add("tblusercollection", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldcashier", db.String, 150)
    hTable.Fields.Add("fldfrominvoice", db.String, 250)
    hTable.Fields.Add("fldtoinvoice", db.String, 250)
    hTable.Fields.Add("fldfromreceipt", db.String, 250)
    hTable.Fields.Add("fldtoreceipt", db.String, 250)
    hTable.Fields.Add("fldfromvouch", db.String, 250)
    hTable.Fields.Add("fldtovouch", db.String, 250)
    hTable.Fields.Add("fldbillamt", db.Float)
    hTable.Fields.Add("fldretinvoice", db.String, 250)
    hTable.Fields.Add("fldretamt", db.Float)
    hTable.Fields.Add("fldrecvamt", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("flddenomination", db.String, 10000)
    Else
      hTable.Fields.Add("flddenomination", db.String)
    Endif
    hTable.Fields.Add("fldshift", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)

    hTable.Fields.Add("flduserid_verify", db.String, 25)
    hTable.Fields.Add("fldtime_verify", db.Date)
    hTable.Fields.Add("fldcomp_verify", db.String, 50)
    hTable.Fields.Add("fldstatus", db.String, 250)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatcharity($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatcharity") Then
    hTable = $con.Tables.Add("tblpatcharity", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcharitytype", db.String, 150)
    hTable.Fields.Add("fldcharityamt", db.Float)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblextrareceipt($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblextrareceipt") Then
    hTable = $con.Tables.Add("tblextrareceipt", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldpayername", db.String, 250)
    hTable.Fields.Add("fldpayeradd", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldpayamount", db.Float)
    hTable.Fields.Add("fldpaytype", db.String, 50)
    hTable.Fields.Add("fldchequeno", db.String, 250)
    hTable.Fields.Add("fldbankname", db.String, 250)
    hTable.Fields.Add("fldusername", db.String, 250)
    hTable.Fields.Add("flduserpost", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldreference", ["fldreference"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblfiscal($con As Connection) '''required by IRD

  Dim hTable As Table

  If Not $con.Tables.Exist("tblfiscal") Then
    hTable = $con.Tables.Add("tblfiscal", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldfiscal", db.String, 250)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldpatname", db.String, 250)
    hTable.Fields.Add("fldpan", db.String, 250)
    hTable.Fields.Add("flddate", db.Date)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("flddiscountamt", db.Float)
    hTable.Fields.Add("fldtaxable", db.Float)
    hTable.Fields.Add("fldtaxamt", db.Float)
    hTable.Fields.Add("fldtotamt", db.Float)
    hTable.Fields.Add("fldsync", db.String, 50)
    hTable.Fields.Add("fldprinted", db.String, 50)
    hTable.Fields.Add("fldactive", db.String, 50)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldpunch", db.String, 250)
    hTable.Fields.Add("fldprint", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblduebilling($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblduebilling") Then
    hTable = $con.Tables.Add("tblduebilling", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditemtype", db.String, 150) ''Due Clearance
    hTable.Fields.Add("fldbillitem", db.String, 250)
    hTable.Fields.Add("flditemrate", db.Float)
    hTable.Fields.Add("flditemqty", db.Float)
    hTable.Fields.Add("fldtaxper", db.Float)
    hTable.Fields.Add("flddiscper", db.Float)
    hTable.Fields.Add("fldditemamt", db.Float)
    hTable.Fields.Add("fldorduserid", db.String, 25)
    hTable.Fields.Add("fldordtime", db.Date)
    hTable.Fields.Add("fldordcomp", db.String, 50)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldbillno", db.String, 250) ''multiple same bill no
    hTable.Fields.Add("fldprint", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 25)

    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("fldacledger", db.String, 250)
    hTable.Fields.Add("fldhostmac", db.String, 250)

    hTable.Fields.Add("fldalert", db.Boolean)
    hTable.Fields.Add("fldextracol", db.String, 250)
    hTable.Fields.Add("fldextrarow", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatbilling($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatbilling") Then
    hTable = $con.Tables.Add("tblpatbilling", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flditemtype", db.String, 150)
    hTable.Fields.Add("flditemno", db.Long)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("flditemrate", db.Float)
    hTable.Fields.Add("flditemqty", db.Float)
    hTable.Fields.Add("fldtaxper", db.Float)
    hTable.Fields.Add("flddiscper", db.Float)
    hTable.Fields.Add("fldtaxamt", db.Float)
    hTable.Fields.Add("flddiscamt", db.Float)
    hTable.Fields.Add("fldsubsidy", db.Float)
    hTable.Fields.Add("fldditemamt", db.Float)
    hTable.Fields.Add("fldcashincredit", db.Float)
    hTable.Fields.Add("fldorduserid", db.String, 25)
    hTable.Fields.Add("fldordtime", db.Date)
    hTable.Fields.Add("fldordcomp", db.String, 50)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldbillno", db.String, 250) ''multiple same bill no
    hTable.Fields.Add("fldparent", db.Long)
    hTable.Fields.Add("fldprint", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 25)
    hTable.Fields.Add("fldtarget", db.String, 50)
    hTable.Fields.Add("fldpayto", db.String, 25)
    hTable.Fields.Add("fldrefer", db.String, 25)
    hTable.Fields.Add("fldsample", db.String, 50)

    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldacledger", db.String, 250)
    hTable.Fields.Add("fldcurrlocat", db.String, 100)
    hTable.Fields.Add("fldhostmac", db.String, 250)

    hTable.Fields.Add("fldreason", db.String, 250)
    hTable.Fields.Add("fldretbill", db.String, 250)
    hTable.Fields.Add("fldretqty", db.Float)

    hTable.Fields.Add("fldalert", db.Boolean)
    hTable.Fields.Add("fldextracol", db.String, 250)
    hTable.Fields.Add("fldextrarow", db.String, 250)
    hTable.Fields.Add("fldclaimid", db.String, 250)
    hTable.Fields.Add("fldclaimstate", db.String, 250)
    hTable.Fields.Add("fldextradata", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], False)
    hTable.Indexes.Add(hTable.Name & "_flditemname", ["flditemname"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    hTable.Indexes.Add(hTable.Name & "_fldparent", ["fldparent"], False)
    hTable.Indexes.Add(hTable.Name & "_fldextracol", ["fldextracol"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatbilldetail($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatbilldetail") Then
    hTable = $con.Tables.Add("tblpatbilldetail", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("fldtaxamt", db.Float)
    hTable.Fields.Add("fldtaxgroup", db.String, 150)
    hTable.Fields.Add("flddiscountamt", db.Float)
    hTable.Fields.Add("flddiscountgroup", db.String, 150)
    hTable.Fields.Add("fldchargedamt", db.Float)
    hTable.Fields.Add("fldreceivedamt", db.Float)
    hTable.Fields.Add("fldcurdeposit", db.Float)
    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("fldchequeno", db.String, 250)
    hTable.Fields.Add("fldbankname", db.String, 250)
    hTable.Fields.Add("fldprevdeposit", db.Integer)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], True)
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    hTable.Indexes.Add(hTable.Name & "_fldchequeno", ["fldchequeno"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltempbilldetail($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltempbilldetail") Then
    hTable = $con.Tables.Add("tbltempbilldetail", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("fldtaxamt", db.Float)
    hTable.Fields.Add("fldtaxgroup", db.String, 150)
    hTable.Fields.Add("flddiscountamt", db.Float)
    hTable.Fields.Add("flddiscountgroup", db.String, 150)
    hTable.Fields.Add("fldchargedamt", db.Float)
    hTable.Fields.Add("fldreceivedamt", db.Float)
    hTable.Fields.Add("fldcurdeposit", db.Float)
    hTable.Fields.Add("flddepoadjust", db.Float)
    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("fldchequeno", db.String, 250)
    hTable.Fields.Add("fldbankname", db.String, 250)
    hTable.Fields.Add("fldprevdeposit", db.Integer)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], True)
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    hTable.Indexes.Add(hTable.Name & "_fldchequeno", ["fldchequeno"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblduebilldetail($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblduebilldetail") Then
    hTable = $con.Tables.Add("tblduebilldetail", $DbEngine)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldbillno"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbladvreceiptdetail($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbladvreceiptdetail") Then
    hTable = $con.Tables.Add("tbladvreceiptdetail", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flditemamt", db.Float)
    hTable.Fields.Add("fldtaxamt", db.Float)
    hTable.Fields.Add("flddiscountamt", db.Float)
    hTable.Fields.Add("fldchargedamt", db.Float)
    hTable.Fields.Add("fldreceivedamt", db.Float)
    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("fldchequeno", db.String, 250)
    hTable.Fields.Add("fldbankname", db.String, 250)
    hTable.Fields.Add("fldpatstate", db.String, 75)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldcashpay", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 100)
    hTable.Fields.Add("fldverify", db.String, 250)
    hTable.Fields.Add("fldinvoice", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], True)
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblcashsources($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcashsources") Then
    hTable = $con.Tables.Add("tblcashsources", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldvendor", db.String, 150)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldcashamt", db.Float)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblwebpayment($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblwebpayment") Then
    hTable = $con.Tables.Add("tblwebpayment", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditemid", db.String, 250)
    hTable.Fields.Add("fldlink", db.String, 250)

    hTable.Fields.Add("fldvendor", db.String, 150)
    hTable.Fields.Add("fldvendormode", db.String, 150)
    hTable.Fields.Add("fldstate", db.String, 150)

    hTable.Fields.Add("fldtransid", db.String, 250)
    hTable.Fields.Add("fldtransamt", db.Float)
    hTable.Fields.Add("fldtranstoken", db.String, 250)
    hTable.Fields.Add("fldfeeamt", db.Float)
    hTable.Fields.Add("fldrefund", db.Boolean)
    hTable.Fields.Add("fldtransdate", db.Date)

    hTable.Fields.Add("fldpayerid", db.String, 250)
    hTable.Fields.Add("fldpayername", db.String, 250)
    hTable.Fields.Add("fldpayermobile", db.String, 150)
    hTable.Fields.Add("fldpayeremail", db.String, 150)

    hTable.Fields.Add("fldmerchid", db.String, 250)
    hTable.Fields.Add("fldmerchname", db.String, 250)
    hTable.Fields.Add("fldmerchmobile", db.String, 150)
    hTable.Fields.Add("fldmerchemail", db.String, 150)

    hTable.Fields.Add("flduserid", db.String, 150)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldhostmac", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], True)
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatusershares($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatusershares") Then
    hTable = $con.Tables.Add("tblpatusershares", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldbillid", db.Long)
    hTable.Fields.Add("fldsharetype", db.String, 25)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditemname", db.String, 250)
    hTable.Fields.Add("fldshareuser", db.String, 25)
    hTable.Fields.Add("fldsharename", db.String, 250)
    hTable.Fields.Add("fldtotalper", db.Float)
    hTable.Fields.Add("flduserper", db.Float)
    hTable.Fields.Add("flduseramt", db.Float)
    hTable.Fields.Add("fldusertax", db.Float)
    hTable.Fields.Add("fldactive", db.String, 25)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatbillcounts($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatbillcounts") Then
    hTable = $con.Tables.Add("tblpatbillcounts", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcount", db.Integer)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatbillbooking($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatbillbooking") Then
    hTable = $con.Tables.Add("tblpatbillbooking", $DbEngine)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.PrimaryKey = ["fldbillno"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatmeditem($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatmeditem") Then
    hTable = $con.Tables.Add("tblpatmeditem", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 150)
    hTable.Fields.Add("fldcode", db.String, 150)
    hTable.Fields.Add("flditem", db.String, 255)
    hTable.Fields.Add("fldpatinfo", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 150)

    hTable.Fields.Add("flduserid_order", db.String, 25)
    hTable.Fields.Add("fldtime_order", db.Date)
    hTable.Fields.Add("fldcomp_order", db.String, 50)
    hTable.Fields.Add("fldsave_order", db.Boolean)
    hTable.Fields.Add("fldorder", db.String, 50)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 50)

    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldrugproblems($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldrugproblems") Then
    hTable = $con.Tables.Add("tbldrugproblems", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldmedicine", db.String, 250)
    hTable.Fields.Add("fldcondition", db.String, 250)
    hTable.Fields.Add("fldrecommend", db.String, 250)
    hTable.Fields.Add("fldlevel", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatdosing($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatdosing") Then
    hTable = $con.Tables.Add("tblpatdosing", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditemtype", db.String, 150)
    hTable.Fields.Add("fldroute", db.String, 150)
    hTable.Fields.Add("flditem", db.String, 255)
    hTable.Fields.Add("flddose", db.Float)
    hTable.Fields.Add("fldfreq", db.String, 25)
    hTable.Fields.Add("flddays", db.Float)
    hTable.Fields.Add("fldqtyorder", db.Float)
    hTable.Fields.Add("fldqtydisp", db.Float)
    hTable.Fields.Add("fldqtyret", db.Float)
    hTable.Fields.Add("fldprescriber", db.String, 255)
    hTable.Fields.Add("fldregno", db.String, 255)
    hTable.Fields.Add("fldlevel", db.String, 50)
    hTable.Fields.Add("flddirection", db.String, 250)
    hTable.Fields.Add("fldadminsite", db.String, 150)
    hTable.Fields.Add("flddosecount", db.Integer)
    hTable.Fields.Add("fldmixing", db.String, 250)

    hTable.Fields.Add("flddispmode", db.String, 150)
    hTable.Fields.Add("fldorder", db.String, 50)
    hTable.Fields.Add("fldcurval", db.String, 50)
    hTable.Fields.Add("fldstarttime", db.Date)
    hTable.Fields.Add("fldendtime", db.Date)
    hTable.Fields.Add("fldfixname", db.String, 250)
    hTable.Fields.Add("fldfixrate", db.Float)
    hTable.Fields.Add("fldtaxper", db.Float)
    hTable.Fields.Add("flddiscper", db.Float)
    hTable.Fields.Add("fldcashincredit", db.Float)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldacledger", db.String, 250)
    hTable.Fields.Add("fldbilltype", db.String, 25)
    hTable.Fields.Add("flditemno", db.Long)

    hTable.Fields.Add("flduserid_order", db.String, 25)
    hTable.Fields.Add("fldtime_order", db.Date)
    hTable.Fields.Add("fldcomp_order", db.String, 50)
    hTable.Fields.Add("fldsave_order", db.Boolean)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)

    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldlabel", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldextracol", db.String, 250)
    hTable.Fields.Add("fldextrarow", db.String, 250)

    hTable.Fields.Add("flduserid_disp", db.String, 25)
    hTable.Fields.Add("fldtime_disp", db.Date)
    hTable.Fields.Add("fldcomp_disp", db.String, 50)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatoutdosing($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatoutdosing") Then
    hTable = $con.Tables.Add("tblpatoutdosing", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditemtype", db.String, 150)
    hTable.Fields.Add("fldroute", db.String, 150)
    hTable.Fields.Add("flditem", db.String, 255)
    hTable.Fields.Add("flddose", db.Float)
    hTable.Fields.Add("fldfreq", db.String, 25)
    hTable.Fields.Add("flddays", db.Float)
    hTable.Fields.Add("fldqtydisp", db.Float)
    hTable.Fields.Add("fldqtyret", db.Float)
    hTable.Fields.Add("fldprescriber", db.String, 255)
    hTable.Fields.Add("fldregno", db.String, 255)
    hTable.Fields.Add("fldlevel", db.String, 50)
    hTable.Fields.Add("flddirection", db.String, 250)
    hTable.Fields.Add("fldadminsite", db.String, 150)
    hTable.Fields.Add("flddosecount", db.Integer)
    hTable.Fields.Add("fldmixing", db.String, 250)

    hTable.Fields.Add("fldcurval", db.String, 50)
    hTable.Fields.Add("fldstarttime", db.Date)
    hTable.Fields.Add("fldendtime", db.Date)
    hTable.Fields.Add("fldfixname", db.String, 250)
    hTable.Fields.Add("fldfixrate", db.Float)
    hTable.Fields.Add("fldtaxper", db.Float)
    hTable.Fields.Add("flddiscper", db.Float)
    hTable.Fields.Add("fldcashincredit", db.Float)
    hTable.Fields.Add("fldbillingmode", db.String, 150)
    hTable.Fields.Add("flddisctype", db.String, 150)
    hTable.Fields.Add("fldacledger", db.String, 250)
    hTable.Fields.Add("fldbilltype", db.String, 25)

    hTable.Fields.Add("fldlabel", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("fldreference", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatdoseremote($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatdoseremote") Then
    hTable = $con.Tables.Add("tblpatdoseremote", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flddoseno", db.Long)
    hTable.Fields.Add("fldqtydisp", db.Float)
    hTable.Fields.Add("fldqtyret", db.Float)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltaperdose($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltaperdose") Then
    hTable = $con.Tables.Add("tbltaperdose", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("flddoseno", db.Long)
    hTable.Fields.Add("flddose", db.Float)
    hTable.Fields.Add("fldfreq", db.String, 25)
    hTable.Fields.Add("flddays", db.Float)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_flddoseno", ["flddoseno"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblnurdosing($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblnurdosing") Then
    hTable = $con.Tables.Add("tblnurdosing", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flddoseno", db.Long)
    hTable.Fields.Add("fldvalue", db.Float)
    hTable.Fields.Add("fldunit", db.String, 150)
    hTable.Fields.Add("fldfromtime", db.Date)
    hTable.Fields.Add("fldtotime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_flddoseno", ["flddoseno"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblvaccdosing($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblvaccdosing") Then
    hTable = $con.Tables.Add("tblvaccdosing", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flditem", db.String, 250)
    hTable.Fields.Add("fldstockno", db.Integer)
    hTable.Fields.Add("fldtype", db.String, 100)
    hTable.Fields.Add("fldvalue", db.Float)
    hTable.Fields.Add("fldunit", db.String, 150)

    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpayimage($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpayimage") Then
    hTable = $con.Tables.Add("tblpayimage", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldbookid", db.String, 150)
    hTable.Fields.Add("fldpatient", db.String, 250)
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("fldtitle", db.String, 250)
    hTable.Fields.Add("flddetail", db.String, 250)
    hTable.Fields.Add("fldamount", db.Float)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldxyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldbookid", ["fldbookid"], True)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpersonimage($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpersonimage") Then
    hTable = $con.Tables.Add("tblpersonimage", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("fldname", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldxyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatimagedata($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatimagedata") Then
    hTable = $con.Tables.Add("tblpatimagedata", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("fldtitle", db.String, 250)
    hTable.Fields.Add("flddetail", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("fldkeyword", db.String, 250)
    hTable.Fields.Add("fldhashcode", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldxyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatserialimage($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatserialimage") Then
    hTable = $con.Tables.Add("tblpatserialimage", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("fldmode", db.String, 250)
    hTable.Fields.Add("fldtestid", db.Long)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldtitle", db.String, 250)
    hTable.Fields.Add("fldkeyword", db.String, 250)
    hTable.Fields.Add("flddetail", db.String, 250)
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldxyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatreport($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatreport") Then
    hTable = $con.Tables.Add("tblpatreport", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("fldtitle", db.String, 250)
    hTable.Fields.Add("flddetail", db.String, 250)
    hTable.Fields.Add("fldextension", db.String, 10)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldflag", db.Boolean)
    hTable.Fields.Add("fldhashcode", db.String, 250)
    hTable.Fields.Add("flvisible", db.String, 50)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("fldxyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbillupload($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbillupload") Then
    hTable = $con.Tables.Add("tblbillupload", $DbEngine)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldbillno"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbillrepoload($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbillrepoload") Then
    hTable = $con.Tables.Add("tblbillrepoload", $DbEngine)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.PrimaryKey = ["fldbillno"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblofficedocs($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblofficedocs") Then
    hTable = $con.Tables.Add("tblofficedocs", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldreference", db.String, 250)
    hTable.Fields.Add("fldcateg", db.String, 250)
    hTable.Fields.Add("fldtitle", db.String, 250)
    hTable.Fields.Add("flddetail", db.String, 250)
    hTable.Fields.Add("fldextension", db.String, 10)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldpic", db.String, 10000)
    Else
      hTable.Fields.Add("fldpic", db.Blob)
    Endif
    hTable.Fields.Add("fldlink", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpatientpass($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatientpass") Then
    hTable = $con.Tables.Add("tblpatientpass", $DbEngine)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldpass", db.String, 250)
    hTable.Fields.Add("fldfromdate", db.Date)
    hTable.Fields.Add("fldtodate", db.Date)
    hTable.Fields.Add("fldusercode", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldpatientval"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblremotefollow($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblremotefollow") Then
    hTable = $con.Tables.Add("tblremotefollow", $DbEngine)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("flddept", db.String, 50)
    hTable.Fields.Add("fldstart", db.Date)
    hTable.Fields.Add("fldend", db.Date)
    hTable.Fields.Add("flddata", db.Boolean)
    hTable.Fields.Add("fldimage", db.Boolean)
    hTable.Fields.Add("fldmedia", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 150)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldencounterval"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblremoteusers($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblremoteusers") Then
    hTable = $con.Tables.Add("tblremoteusers", $DbEngine)
    hTable.Fields.Add("fldusrcode", db.String, 250)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldptnamefir", db.String, 150)
    hTable.Fields.Add("fldptnamelast", db.String, 150)
    hTable.Fields.Add("fldethniccode", db.String, 50)
    hTable.Fields.Add("fldptsex", db.String, 10)
    hTable.Fields.Add("fldptaddvill", db.String, 150)
    hTable.Fields.Add("fldptaddward", db.String, 150)
    hTable.Fields.Add("fldptadddist", db.String, 150)
    hTable.Fields.Add("fldptcontact", db.String, 150)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldptbirday", db.Date)
    hTable.Fields.Add("fldptguardian", db.String, 250)
    hTable.Fields.Add("fldrelation", db.String, 250)

    hTable.Fields.Add("fldptcode", db.String, 250)
    hTable.Fields.Add("flddiscount", db.String, 150)
    hTable.Fields.Add("fldadmitfile", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 250)
    hTable.Fields.Add("fldencrypt", db.Boolean)
    hTable.Fields.Add("fldpassword", db.String, 250)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)

    hTable.Fields.Add("fldhashcode", db.String, 250)
    hTable.Fields.Add("fldvertime", db.Date)
    hTable.Fields.Add("fldhostuser", db.String, 250)
    hTable.Fields.Add("fldhostip", db.String, 250)
    hTable.Fields.Add("fldhostname", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)

    hTable.PrimaryKey = ["fldusrcode"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblpacsupload($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpacsupload") Then
    hTable = $con.Tables.Add("tblpacsupload", $DbEngine)
    hTable.Fields.Add("fldhash", db.String, 250)
    hTable.Fields.Add("fldsave", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif

    hTable.PrimaryKey = ["fldhash"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------------------- For Blood/Other Products ---------------------------------------
Public Sub CREATEtblblood($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblblood") Then
    hTable = $con.Tables.Add("tblblood", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblbloodstore($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblbloodstore") Then
    hTable = $con.Tables.Add("tblbloodstore", $DbEngine)
    hTable.Fields.Add("flditemcode", db.String, 200)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.Fields.Add("fldgroup", db.String, 50)
    hTable.Fields.Add("fldtemp", db.String, 150)
    hTable.Fields.Add("fldshelf", db.Integer)
    hTable.PrimaryKey = ["flditemcode"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblvaccine($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblvaccine") Then
    hTable = $con.Tables.Add("tblvaccine", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("flditem", db.String, 150)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------------- FOR Telemedicine --------------------------
''only in repository
Public Sub CREATEtbltelemeduser($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltelemeduser") Then
    hTable = $con.Tables.Add("tbltelemeduser", $DbEngine)
    hTable.Fields.Add("fldteleuser", db.String, 25)
    hTable.Fields.Add("fldusername", db.String, 250)
    hTable.Fields.Add("fldpass", db.String, 250)
    hTable.Fields.Add("fldroot", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 100)
    hTable.Fields.Add("fldcontact", db.String, 150)
    hTable.Fields.Add("fldemail", db.String, 250)
    hTable.Fields.Add("fldfromdate", db.Date)
    hTable.Fields.Add("fldtodate", db.Date)
    hTable.Fields.Add("fldusercode", db.String, 250)
    hTable.Fields.Add("fldhospital", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)

    hTable.Fields.Add("fldgovtaccount", db.String, 250)
    hTable.Fields.Add("fldbankname", db.String, 250)
    hTable.Fields.Add("fldbankaccount", db.String, 250)
    hTable.Fields.Add("fldtaxpercent", db.Float)
    hTable.Fields.Add("fldcharge", db.Float)
    hTable.Fields.Add("fldtime", db.Date)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldteleuser"]
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldcontact", ["fldcontact"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''only in repository
Public Sub CREATEtblcurrteleuser($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblcurrteleuser") Then
    hTable = $con.Tables.Add("tblcurrteleuser", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldteleuser", db.String, 25)
    hTable.Fields.Add("fldentrytime", db.Date)
    hTable.Fields.Add("fldexittime", db.Date)
    hTable.Fields.Add("fldpresent", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltelemedtalk($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltelemedtalk") Then
    hTable = $con.Tables.Add("tbltelemedtalk", $DbEngine)
    hTable.Fields.Add("fldtalkid", db.String, 250)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldpatientval", db.String, 150)
    hTable.Fields.Add("fldhospital", db.String, 250)

    hTable.Fields.Add("fldteleuser", db.String, 25)
    hTable.Fields.Add("fldsms", db.Boolean)
    hTable.Fields.Add("fldurgency", db.String, 150)
    hTable.Fields.Add("fldvidroom", db.String, 250)
    hTable.Fields.Add("fldvidpass", db.String, 250)
    hTable.Fields.Add("fldvidserver", db.String, 250)

    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldrequest", db.String, 5000)
    Else
      hTable.Fields.Add("fldrequest", db.String)
    Endif
    hTable.Fields.Add("fldorduserid", db.String, 25)
    hTable.Fields.Add("fldordtime", db.Date)
    hTable.Fields.Add("fldordcomp", db.String, 50)

    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldresponse", db.String, 5000)
    Else
      hTable.Fields.Add("fldresponse", db.String)
    Endif
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)

    hTable.Fields.Add("fldcoment", db.String, 250)
    hTable.Fields.Add("fldupuser", db.String, 25)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
    Endif
    hTable.PrimaryKey = ["fldtalkid"]

    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime", ["fldtime"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltelradiotest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltelradiotest") Then
    hTable = $con.Tables.Add("tbltelradiotest", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldtestno", db.Long)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtestid", db.String, 250)
    hTable.Fields.Add("fldmethod", db.String, 250)
    hTable.Fields.Add("fldgroupid", db.Long)
    hTable.Fields.Add("fldsampletype", db.String, 250)
    hTable.Fields.Add("fldsampleid", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreportquali", db.String, 10000)
    Else
      hTable.Fields.Add("fldreportquali", db.String)
    Endif
    hTable.Fields.Add("fldreportquanti", db.Float)
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldstatus", db.String, 250)
    hTable.Fields.Add("fldprint", db.Boolean)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("fldrefername", db.String, 250)
    hTable.Fields.Add("fldcondition", db.String, 250)
    hTable.Fields.Add("fldcomment", db.String, 255)
    hTable.Fields.Add("flvisible", db.String, 50)
    hTable.Fields.Add("fldnewdate", db.Date)
    hTable.Fields.Add("fldpacstudy", db.String, 255)
    hTable.Fields.Add("fldpacseries", db.String, 255)
    hTable.Fields.Add("fldpacsform", db.String, 25)

    hTable.Fields.Add("fldtest_type", db.String, 50)
    hTable.Fields.Add("fldbillno", db.String, 250)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("fldorder", db.Integer)

    hTable.Fields.Add("flduserid_report", db.String, 25)
    hTable.Fields.Add("fldtime_report", db.Date)
    hTable.Fields.Add("fldcomp_report", db.String, 50)
    hTable.Fields.Add("fldsave_report", db.Boolean)
    hTable.Fields.Add("flduptime_report", db.Date)
    hTable.Fields.Add("fldupuser_report", db.String, 25)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    hTable.Indexes.Add(hTable.Name & "_fldbillno", ["fldbillno"], False)
    hTable.Indexes.Add(hTable.Name & "_fldtime_report", ["fldtime_report"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbltelradiosubtest($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbltelradiosubtest") Then
    hTable = $con.Tables.Add("tbltelradiosubtest", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldsubtestno", db.Long)
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldtestid", db.Long)
    hTable.Fields.Add("fldparent", db.String, 250)
    hTable.Fields.Add("fldsubtest", db.String, 200)
    hTable.Fields.Add("fldindex", db.String, 250)
    hTable.Fields.Add("fldtanswertype", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldreport", db.String, 10000)
    Else
      hTable.Fields.Add("fldreport", db.String)
    Endif
    hTable.Fields.Add("fldabnormal", db.Boolean)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldchk", db.Boolean)
    hTable.Fields.Add("fldorder", db.Integer)
    hTable.Fields.Add("fldfilepath", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldtestid", ["fldtestid"], False)
    hTable.Indexes.Add(hTable.Name & "_fldindex", ["fldindex"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

'
''
'''

''------------ FOR AYURVEDA ONLY ----------------------
Public Sub CREATEtblamissetting($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblamissetting") Then
    hTable = $con.Tables.Add("tblamissetting", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldtype", db.String, 50)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldvalue", db.String, 250)
    hTable.Fields.Add("fldvarval", db.String, 250)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''--------------- for Dashboard -------------------------
Public Sub CREATEtblpopulation($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpopulation") Then
    hTable = $con.Tables.Add("tblpopulation", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldchapter", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldmale", db.Float)
    hTable.Fields.Add("fldfemale", db.Float)
    hTable.Fields.Add("fldother", db.Float)
    hTable.Fields.Add("fldpality", db.String, 150)
    hTable.Fields.Add("flddistrict", db.String, 150)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldverify", db.Boolean)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtbldashparameters($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tbldashparameters") Then
    hTable = $con.Tables.Add("tbldashparameters", $DbEngine)
    hTable.Fields.Add("fldid", db.Serial)
    hTable.Fields.Add("fldchapter", db.String, 250)
    hTable.Fields.Add("fldcategory", db.String, 250)
    hTable.Fields.Add("fldquali", db.String, 250)
    hTable.Fields.Add("fldquanti", db.Float)
    hTable.Fields.Add("fldpality", db.String, 150)
    hTable.Fields.Add("flddistrict", db.String, 150)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldverify", db.Boolean)
    hTable.PrimaryKey = ["fldid"]
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''------------------------ FOR Research -------------------------
Public Sub CREATEtblpatientstudy($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblpatientstudy") Then
    hTable = $con.Tables.Add("tblpatientstudy", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 150)
    hTable.Fields.Add("fldpatcode", db.String, 250)
    hTable.Fields.Add("fldstudycode", db.String, 150)
    hTable.Fields.Add("fldconsentautodata", db.String, 50)
    hTable.Fields.Add("fldstatusautodata", db.String, 50)
    hTable.Fields.Add("fldconsentinterview", db.String, 50)
    hTable.Fields.Add("fldstatusinterview", db.String, 50)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldconsentformpic", db.String, 5000)
    Else
      hTable.Fields.Add("fldconsentformpic", db.Blob)
    Endif
    hTable.Fields.Add("fldconsentformlink", db.String, 250)
    If $DbEngine = "HEAP" Then
      hTable.Fields.Add("fldiintervireformpic", db.String, 5000)
    Else
      hTable.Fields.Add("fldiintervireformpic", db.Blob)
    Endif
    hTable.Fields.Add("fldinterviewformlink", db.String, 250)
    hTable.Fields.Add("fldstatus", db.String, 50)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("flduptime", db.Date)
    hTable.Fields.Add("xyz", db.Boolean)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    hTable.Indexes.Add(hTable.Name & "_fldencounterval", ["fldencounterval"], False)
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''------------- For HAI Surveillance ----------------
Public Sub CREATEtblhaidenominators($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblhaidenominators") Then
    hTable = $con.Tables.Add("tblhaidenominators", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("flddate", db.Date)
    hTable.Fields.Add("fldward", db.String, 250)
    hTable.Fields.Add("fldweight", db.String, 250)
    hTable.Fields.Add("fldcentral", db.Integer)
    hTable.Fields.Add("fldperipheral", db.Integer)
    hTable.Fields.Add("fldurinary", db.Integer)
    hTable.Fields.Add("fldtotal", db.Integer)
    hTable.Fields.Add("fldsource", db.String, 50)
    hTable.Fields.Add("fldsave", db.Boolean)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

Public Sub CREATEtblhaicasereports($con As Connection)

  Dim hTable As Table

  If Not $con.Tables.Exist("tblhaicasereports") Then
    hTable = $con.Tables.Add("tblhaicasereports", $DbEngine)
    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepoid", db.String, 250)
      hTable.Fields.Add("fldid", db.Long)
    Else
      hTable.Fields.Add("fldid", db.Serial)
    Endif
    hTable.Fields.Add("fldencounterval", db.String, 250)
    hTable.Fields.Add("fldentity", db.String, 250)
    hTable.Fields.Add("fldenrollbsi", db.String, 250)
    hTable.Fields.Add("fldenrolluti", db.String, 250)
    hTable.Fields.Add("fldutieventdate", db.Date)
    hTable.Fields.Add("fldbsieventdate", db.Date)
    hTable.Fields.Add("flduticlassify", db.String, 250)
    hTable.Fields.Add("fldbsiclassify", db.String, 250)
    hTable.Fields.Add("xyz", db.Boolean)

    If $DbFormat = "REP" Then
      hTable.Fields.Add("fldrepodate", db.Date)
      hTable.Fields.Add("fldrepomac", db.String, 150)
      hTable.Fields.Add("fldhospcode", db.String, 50)
      hTable.PrimaryKey = ["fldrepoid"]
    Else
      hTable.PrimaryKey = ["fldid"]
    Endif
    hTable.Update
    modDBApp.AlterMySQLSpecCollationTable($con, hTable.Name)
  Endif

End

''----------------- Local Procedures --------------------
Private Sub SetMedSyncTable(hTable As Table)

  If $DbFormat = "REP" Then
    hTable.Fields.Add("flduserid", db.String, 25)
    hTable.Fields.Add("fldtime", db.Date)
    hTable.Fields.Add("fldcomp", db.String, 50)
    hTable.Fields.Add("fldverifyid", db.String, 25)
    hTable.Fields.Add("fldverifytime", db.Date)
    hTable.Fields.Add("fldnote", db.String, 250)
  Endif

End
