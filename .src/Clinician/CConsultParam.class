' Gambas class file

Private $DepartName As String
Private $Consultant As String
Private $PreComment As String
Private $ConsultDate As Date
Private $ConultComment As String
Private $ConsultOutcome As String

Public Sub _new(sMode As String, sIndex As Long, encid As String)

  Dim res As Result
  Dim xval As String

  If sMode = "Consultation" Then
    res = modDatabase.$myConn.Exec("select fldconsultname,fldconsulttime,flduserid,fldpresummary,fldsummary,fldoutcome from tblconsult where fldid=&1 and fldencounterval=&2", sIndex, encid)
  Else If sMode = "OP Visit" Then
    res = modDatabase.$myConn.Exec("select fldconsultname,fldconsulttime,fldflaguser,fldpresummary,fldsummary,fldoutcome from tblopvisit where fldid=&1 and fldencounterval=&2", sIndex, encid)
  Endif
  If res.Available Then
    xval = res["fldconsultname"]
    $DepartName = res["fldconsultname"]
    If sMode = "Consultation" Then
      $Consultant = res["flduserid"]
    Else If sMode = "OP Visit" Then
      $Consultant = res["fldflaguser"]
    Endif
    $PreComment = res["fldpresummary"]
    $ConsultDate = res["fldconsulttime"]
    $ConultComment = res["fldsummary"]
    $ConsultOutcome = res["fldoutcome"]
  Else
    $DepartName = ""
    $Consultant = ""
    $PreComment = ""
    $ConsultDate = ""
    $ConultComment = ""
    $ConsultOutcome = ""
  Endif

End

Public Function GetDepartment() As String

  Return $DepartName

End

Public Function GetConsultant() As String

  Return $Consultant

End

Public Function GetPreComment() As String

  Return $PreComment

End

Public Function GetConsultComment() As String

  Return $ConultComment

End

Public Function GetOutcome() As String

  Return $ConsultOutcome

End

Public Function GetConsultDate() As Date

  Return $ConsultDate

End
