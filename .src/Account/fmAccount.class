' Gambas class file

' Export

Public Sub _new()

  Me.AddHeader("<meta name='viewport' content='width=device-width, initial-scale=1'>")
  Me.AddHeader("<link rel=\"stylesheet\" href=\"" & modHelpVariable.$AppCssPath & "\">")
  Me.AddJavascriptFile("js/webcontrols.js")
  Me.AddJavascriptFile("js/jquery.min.js")
  Me.AddJavascriptFile("js/print.min.js")
  Me.AddJavascriptFile("js/toastify.js")
  Me.AddJavascriptFile("js/Chart.js")
  Me.AddJavascriptFile("js/tribute.js")
  Me.AddJavascriptFile("js/download.js")
  Me.AddJavascriptFile("js/select2.min.js")

  Me.AddJavascriptFile("js/sketchpad.js")
  ''slow js
  Me.AddJavascriptFile("js/html2pdf.bundle.min.js")
  Me.AddJavascriptFile("js/xlsx.full.min.js")
  Me.Font = MMain.$AppFontName
  WebImage1.Image = modHelpVariable.$headerImage
  WebForm.Debug = MMain.$isdebug
  mnucuruserid.Text = modBasic.$lbluser

End

Public Sub WebForm_Open()

  If MMain.$WebEntry = True Then
    modDataRepo.$RepositoryMode = MMain.$AppLogCategory
    modBasic.$HospCode = MMain.$AppLogString
  Endif
  modHelpVariable.SetApplicationGUI()
  MMain.GetApplVersionType()

  DiaplayCustMenu()
  modBasic.LoadRegistrationSetting()
  modBasic.LoadCashierBillingSettings()
  modBasic.LoadInvoicingSetting()
  modBasic.SetAccountRules()
  modBasic.LoadClaimParametes()
  modBasic.LoadSSFClaim()

  modBasic.ChartSettingsAll()
  If modHelpVariable.$IRDLevel = "Yes" Then
    mnuyearly.Visible = True
  Else
    mnuyearly.Visible = False
  Endif

  ''specific
  If MMain.$IsPolice = True Then
    mnuspolicecateg.Visible = True
  Else
    mnuspolicecateg.Visible = False
  Endif
  If MMain.$CustomFormat = "Nobel" Then
    mnuspecial.Visible = True
  Else
    mnuspecial.Visible = False
  Endif
  SetFormAccess()
  ' DefaultFormLoad()

End

Private Sub DefaultFormLoad()

  Dim hForm As FmAccountChart

  If Not Workspace1.Children.Count Then
    hForm = New FmAccountChart(Workspace1)
  Endif

End

Private Sub SetFormAccess()

  modGeneralMain.ShowSelectedFormMenu(mnubilmode)
  modGeneralMain.ShowSelectedFormMenu(mnubank)
  modGeneralMain.ShowSelectedFormMenu(mnudepcredit)
  modGeneralMain.ShowSelectedFormMenu(mnutaxcode)
  modGeneralMain.ShowSelectedFormMenu(mnucshvendors)
  modGeneralMain.ShowSelectedFormMenu(mnuregist)
  modGeneralMain.ShowSelectedFormMenu(mnuservmode)
  modGeneralMain.ShowSelectedFormMenu(mnudiscgroup)
  modGeneralMain.ShowSelectedFormMenu(mnucurconv)

  modGeneralMain.ShowSelectedFormMenu(mnulab)
  modGeneralMain.ShowSelectedFormMenu(mnuradio)
  modGeneralMain.ShowSelectedFormMenu(mnuproc)
  modGeneralMain.ShowSelectedFormMenu(mnuequipment)
  modGeneralMain.ShowSelectedFormMenu(mnuservice)
  modGeneralMain.ShowSelectedFormMenu(mnuother)
  modGeneralMain.ShowSelectedFormMenu(mnucostingall)
  modGeneralMain.ShowSelectedFormMenu(mnustock)
  modGeneralMain.ShowSelectedFormMenu(mnupharmcost)

  modGeneralMain.ShowSelectedFormMenu(mnudemograp)
  modGeneralMain.ShowSelectedFormMenu(mnusershare)
  modGeneralMain.ShowSelectedFormMenu(mnuautoconsult)
  modGeneralMain.ShowSelectedFormMenu(mnupatdisc)
  modGeneralMain.ShowSelectedFormMenu(mnustafflist)
  modGeneralMain.ShowSelectedFormMenu(mnussulist)

  modGeneralMain.ShowSelectedFormMenu(mnupatacc)
  modGeneralMain.ShowSelectedFormMenu(mnucollreport)
  modGeneralMain.ShowSelectedFormMenu(mnucollection)
  modGeneralMain.ShowSelectedFormMenu(mnureturnform)
  modGeneralMain.ShowSelectedFormMenu(mnuitemstatus)
  modGeneralMain.ShowSelectedFormMenu(mnucashverify)
  modGeneralMain.ShowSelectedFormMenu(mnuclaimup)
  modGeneralMain.ShowSelectedFormMenu(mnussfupload)

  modGeneralMain.ShowSelectedFormMenu(mnurepogrp)
  modGeneralMain.ShowSelectedFormMenu(mnudiagnoreport)
  modGeneralMain.ShowSelectedFormMenu(mnuserentry)
  modGeneralMain.ShowSelectedFormMenu(mnuledger)
  modGeneralMain.ShowSelectedFormMenu(mnustockDB)

  modGeneralMain.ShowSelectedFormMenu(mnurepo)

  modGeneralMain.ShowSelectedFormMenu(mnusummrepo)
  modGeneralMain.ShowSelectedFormMenu(mnuserv)
  modGeneralMain.ShowSelectedFormMenu(mnugrpreport)
  modGeneralMain.ShowSelectedFormMenu(mnufacultyrepo)
  modGeneralMain.ShowSelectedFormMenu(mnugeneric)
  modGeneralMain.ShowSelectedFormMenu(mnumisreport)
  modGeneralMain.ShowSelectedFormMenu(mnusharing)

  modGeneralMain.ShowSelectedFormMenu(mnubill)
  modGeneralMain.ShowSelectedFormMenu(mnubillsummary)
  modGeneralMain.ShowSelectedFormMenu(mnudeposit)
  modGeneralMain.ShowSelectedFormMenu(mnuvouchers)

  modGeneralMain.ShowSelectedFormMenu(mnupur)
  modGeneralMain.ShowSelectedFormMenu(mnuinventory)
  modGeneralMain.ShowSelectedFormMenu(mnumedsales)
  modGeneralMain.ShowSelectedFormMenu(mnutransfer)

  modGeneralMain.ShowSelectedFormMenu(mnuregistparam)
  modGeneralMain.ShowSelectedFormMenu(mnubillrule)
  modGeneralMain.ShowSelectedFormMenu(mnuautobill)

  modGeneralMain.ShowSelectedFormMenu(mnuAccReport)
  modGeneralMain.ShowSelectedFormMenu(mnupersonal)

End

Public Sub mnuexit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub WebForm_Close()

  modDevice.CamOnClose()
  modDatabase.CloseDatabase()
  modExternal.DeleteFolderRecursive("/tmp" &/ modHelpVariable.AppName &/ "docs" &/ modHelpVariable.$SessionCode)
  modExternal.DeleteFolderRecursive(modHelpVariable.AppCacheDir)

End

Public Sub mnunewextra_Click()

  Dim xLink As String = "http://bitnepal.safiur.com.np/healthybit/help/" & modHelpVariable.$LogInCategory & "/"

  Me.Exec("window.open('" & xLink & "'); ")

End

Public Sub mnuclearcache_Click()

  modGeneralMain.CLearUserCollection()

End

Public Sub mnubugrepo_Click()

  modGeneralMain.SendBugReport(modBasic.$lbluser)

End

' Public Sub WebContainer2_Render()
'
'   Print "<iframe src='" & modBasic.$FormLeftURL & "' width='100%' height='100%'></iframe>";
'
' End
'
' Public Sub WebContainer3_Render()
'
'   Print "<iframe src='" & modBasic.$FormRightURL & "' width='100%' height='100%'></iframe>";
'
' End

Public Sub btnquit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub btnfullscreen_Click()

  If btnfullscreen.Image = "icon:/small/zoom-normal" Then
    btnfullscreen.Image = "icon:/small/zoom-fit"
    Me.Exec("openFullscreen()")

  Else If btnfullscreen.Image = "icon:/small/zoom-fit" Then
    btnfullscreen.Image = "icon:/small/zoom-normal"
    Me.Exec("closeFullscreen()")

  Endif

End

''---------------------------------------- CustomAccount Reports -------------------------------------
Private Sub DiaplayCustMenu()

  If modSettings.ShowSettingForReport("Account.CustomQuery1/Name") Then
    mnucust1.Title = modSettings.ShowSettingForReport("Account.CustomQuery1/Name")
    mnucust1.Tag = "Account.CustomQuery1"
    mnucust1.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Account.CustomQuery2/Name") Then
    mnucust2.Title = modSettings.ShowSettingForReport("Account.CustomQuery2/Name")
    mnucust2.Tag = "Account.CustomQuery2"
    mnucust2.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Account.CustomQuery3/Name") Then
    mnucust3.Title = modSettings.ShowSettingForReport("Account.CustomQuery3/Name")
    mnucust3.Tag = "Account.CustomQuery3"
    mnucust3.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Account.CustomQuery4/Name") Then
    mnucust4.Title = modSettings.ShowSettingForReport("Account.CustomQuery4/Name")
    mnucust4.Tag = "Account.CustomQuery4"
    mnucust4.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Account.CustomQuery5/Name") Then
    mnucust5.Title = modSettings.ShowSettingForReport("Account.CustomQuery5/Name")
    mnucust5.Tag = "Account.CustomQuery5"
    mnucust5.Visible = True
  Endif

End

Public Sub mnucust1_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust1.Tag, Workspace1)

End

Public Sub mnucust2_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust2.Tag, Workspace1)

End

Public Sub mnucust3_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust3.Tag, Workspace1)

End

Public Sub mnucust4_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust4.Tag, Workspace1)

End

Public Sub mnucust5_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust5.Tag, Workspace1)

End

Public Sub mnuaccrepset_Click()

  fmCusAccReport.ShowModal

End

''=======================================
Public Sub mnustockDB_Click()

  fmStockDB.ShowModal

End

Public Sub mnuclaimup_Click()

  Dim hForm As FmHIUpload

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmHIUpload"])
  hForm = New FmHIUpload(Workspace1)

End

Public Sub mnussfupload_Click()

  Dim hForm As FmSSFUpload

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmSSFUpload"])
  hForm = New FmSSFUpload(Workspace1)

End

Public Sub mnusummrepo_Click()

  Dim hForm As FmSummryReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmSummryReport"])
  hForm = New FmSummryReport(Workspace1)

End

Public Sub mnuchartsett_Click()

  fmChartSetting.ShowModal

End

Public Sub mnureposetting_Click()

  fmReportSetting.ShowModal

End

Public Sub mnuappsetting_Click()

  fmAppSetting.ShowModal

End

''================ Main Procedures ===============
Public Sub mnubilmode_Click()

  Dim hForm As FmAddVariableGrid

  hForm = New FmAddVariableGrid("fldsetname", "tblbillingset")
  hForm.Tag = "Rate Plan Codes"
  hForm.ShowModal

End

Public Sub mnudepcredit_Click()

  fmDepartment.ShowModal

End

Public Sub mnutaxcode_Click()

  ' Dim hForm As FmAddValString
  '
  ' hForm = New FmAddValString("Tax Coding", "fldgroup", "fldtaxper", "tbltaxgroup")
  ' hForm.Tag = "Tax Coding"
  ' hForm.ShowModal

End

Public Sub mnucshvendors_Click()

  Dim hForm As FmAddVariableGrid

  hForm = New FmAddVariableGrid("fldvendor", "tblcashvendor")
  hForm.Tag = "Cash Vendors"
  hForm.ShowModal

End

Public Sub mnuregist_Click()

  Dim xPass As String

  xPass = InputPassword("Provide Root Password", "Verification", "")
  If modPassword.GetSuperVerification(modBasic.$lbluser, xPass) = True Then
    fmDiscSetting.ShowModal
  Else
    Message.Info("Incorrect Root Password", ("OK"))
  Endif

End

Public Sub mnuservmode_Click()

End

Public Sub mnudiscgroup_Click()

  Dim hForm As FmAddVariableGrid

  hForm = New FmAddVariableGrid("fldgroup", "tbldiscgroup")
  hForm.Tag = "Discount Codes"
  hForm.ShowModal

End

Public Sub mnucurconv_Click()

  ' Dim hForm As FmAddValString
  '
  ' hForm = New FmAddValString("Currency", "flditemunit", "fldconversion", "tblcurrency")
  ' hForm.Tag = "Currenct Codes"
  ' hForm.ShowModal

End

Public Sub mnubank_Click()

  Dim hForm As FmAddVarTwo
  Dim yy As String[]

  yy = New String[]
  hForm = New FmAddVarTwo("fldbilltype", "fldacledger", "tblacledger", ["Cash", "Credit"], yy)
  hForm.Tag = "Ledger Accounts"
  hForm.ShowModal

End

Public Sub mnuspolicecateg_Click()

  Dim hForm As FmAddVarTwo
  Dim yy As String[]

  yy = New String[]
  hForm = New FmAddVarTwo("fldcategory", "fldpackage", "tblschemecategory", yy, yy)
  hForm.Tag = "Scheme Category"
  hForm.ShowModal

End

Public Sub mnulab_Click()

  Dim hForm As FmCost

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmCost", "Diagnostic Tests Cost"])
  hForm = New FmCost("Diagnostic Tests Cost", Workspace1)

End

Public Sub mnuradio_Click()

  Dim hForm As FmCost

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmCost", "Radio Diagnostics Cost"])
  hForm = New FmCost("Radio Diagnostics Cost", Workspace1)

End

Public Sub mnuservice_Click()

  Dim hForm As FmCost

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmCost", "General Services Cost"])
  hForm = New FmCost("General Services Cost", Workspace1)

End

Public Sub mnuproc_Click()

  Dim hForm As FmCost

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmCost", "Procedures Cost"])
  hForm = New FmCost("Procedures Cost", Workspace1)

End

Public Sub mnuequipment_Click()

  Dim hForm As FmCost

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmCost", "Equipment Cost"])
  hForm = New FmCost("Equipment Cost", Workspace1)

End

Public Sub mnuother_Click()

  Dim hForm As FmCost

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmCost", "Other Items Cost"])
  hForm = New FmCost("Other Items Cost", Workspace1)

End

Public Sub mnustock_Click()

  ''fixed rate

End

Public Sub mnupharmcost_Click()

End

Public Sub mnurepo_Click()

  Dim xx As String
  Dim xmode As String[]
  Dim xPath As String

  xmode = New String[]
  xmode.Insert(modNonMedical.FillCashModeCombo())
  xmode.Add("%")
  xx = InputCombo(("Select Item Rate Plan"), "Costing List", xmode, "%", True)
  If xx Then
    xPath = modRepoMaster.ShowBillingListReport(xx)
    modControlSub.OpenHTMLPreview("", xPath, "ReportSize")
  Endif

End

Public Sub mnupatacc_Click()

  Dim hForm As FmPatAccEdit

  hForm = New FmPatAccEdit("")
  hForm.ShowModal

End

Public Sub mnucollection_Click()

  Dim hForm As FmBillCollect

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmBillCollect"])
  hForm = New FmBillCollect(Workspace1)

End

Public Sub mnucollreport_Click()

  fmBillCollReport.ShowModal

End

Public Sub mnucashverify_Click()

  Dim hForm As FmCashVerify

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmCashVerify"])
  hForm = New FmCashVerify(Workspace1)

End

Public Sub mnureturnform_Click()

  Dim hForm As FmBillReturn

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmBillReturn"])
  hForm = New FmBillReturn(Workspace1)

End

Public Sub mnuitemstatus_Click()

  Dim hForm As FmBilledStatus

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmBilledStatus"])
  hForm = New FmBilledStatus(Workspace1)

End

Public Sub mnuirdactivity_Click()

  Dim xdate As Date[]
  Dim xuser As String
  Dim res As Result
  Dim hForm As FRequest

  xuser = InputCombo("Activity Log for Selected User", "Activity Log", modGeneral.GetUserIDAll(), modBasic.$lbluser, False)
  xdate = DoubleDates("Activity Log for Selected Date", "Activity Log", [Now(), Now()])
  If xdate[0] And If xdate[1] Then
    If xuser Then
      res = modDatabase.$myConn.Exec("select fldtime,fldcategory,fldfrmname,fldactivity,fldcomment,flduserid from tblirdactivity where fldtime>=&1 and fldtime<=&2 and flduserid like &3", moddate.StartSqlDate(xdate[0]), modDate.EndSqlDate(xdate[1]), xuser)                                               ''
    Else
      res = modDatabase.$myConn.Exec("select fldtime,fldcategory,fldfrmname,fldactivity,fldcomment,flduserid from tblirdactivity where fldtime>=&1 and fldtime<=&2", moddate.StartSqlDate(xdate[0]), modDate.EndSqlDate(xdate[1]))
    Endif
    hForm = New FRequest(res, "Activity Log", "TransactionActivity", True)
    hForm.ShowModal
  Endif

End

Public Sub mnudemograp_Click()

End

Public Sub mnusershare_Click()

  fmUserShare.ShowModal
  ''clear cache
  modSharingGroup.$GroupSharePercentData.Clear()
  modSharingGroup.$GroupShareAmountData.Clear()

End

Public Sub mnuautoconsult_Click()

  fmAutobillsettig.ShowModal

End

Public Sub mnustafflist_Click()

  Dim hForm As FmStaffList

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmStaffList"])
  hForm = New FmStaffList(Workspace1)

End

Public Sub mnussulist_Click()

  Dim hForm As FmSocial

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmSocial"])
  hForm = New FmSocial(Workspace1)

End

''=============== Special Reports =============
' Public Sub mnuspecreport_Click()
'
'   fmNobelHospital.ShowModal
'
' End
'
' Public Sub mnulabreceipt_Click()
'
'   Dim hForm As FmTempBillRecordNobel
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmTempBillRecordNobel(Workspace1)
'
' End
'
' Public Sub mnundcinvoice_Click()
'
'   Dim hForm As FmPatBillRecordNDC
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmPatBillRecordNDC(Workspace1)
'
' End
'
' Public Sub mnunlnpinvoice_Click()
'
'   Dim hForm As FmPatBillRecordNLNP
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmPatBillRecordNLNP(Workspace1)
'
' End

''=============== Reports ================
Public Sub mnugeneric_Click()

  Dim hForm As FmGroupCateg

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmGroupCateg"])
  hForm = New FmGroupCateg(Workspace1)

End

Public Sub mnuserv_Click()

  Dim hForm As Fmservreport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["Fmservreport"])
  hForm = New Fmservreport(Workspace1)

End

Public Sub mnugrpreport_Click()

  Dim hForm As FmGroupReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmGroupReport"])
  hForm = New FmGroupReport(Workspace1)

End

Public Sub mnufacultyrepo_Click()

  Dim hForm As FmMasterReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmMasterReport"])
  hForm = New FmMasterReport(Workspace1)

End

Public Sub mnusharing_Click()

  Dim hForm As Fmsharereport
  Dim hForm1 As FmshareGroup

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  If modBasic.$PayableCalculation = "Mixed" Then
    modGeneralMain.$FormOpenList.Add(["Fmsharereport"])
    hForm = New Fmsharereport(Workspace1)
  Else
    modGeneralMain.$FormOpenList.Add(["FmshareGroup"])
    hForm1 = New FmshareGroup(Workspace1)
  Endif

End

Public Sub mnubill_Click()

  Dim hForm As FmPatBillRecord

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmPatBillRecord"])
  hForm = New FmPatBillRecord(Workspace1)

End

Public Sub mnudeposit_Click()

  Dim hForm As FmDepositReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmDepositReport"])
  hForm = New FmDepositReport(Workspace1)

End

Public Sub mnuvouchers_Click()

  Dim hForm As FmVoucherReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmVoucherReport"])
  hForm = New FmVoucherReport(Workspace1)

End

Public Sub mnusalesreport_Click()

  Dim xType As String
  Dim xdate As Date[]
  Dim inidate As Date
  Dim lstdate As Date
  Dim xPath As String

  xType = InputCombo("Select Sales Book Format", "Sales Book", ["Sales Book", "Sales Return", "Sales Book(All)"], "Sales Book(All)", True)
  If xType Then
    xdate = DoubleDates("Select Dates", "Sales Book", [Now(), Now()])
    If xdate Then
      inidate = xdate[0]
      lstdate = xdate[1]

      If inidate And If lstdate Then
        xPath = modHTMLStock.GetIRDSalesBook(xType, inidate, lstdate)
        modControlSub.DisplayReportExport(xPath)
      Endif
    Endif
  Endif

End

Public Sub mnuyearly_Click()

  Dim xdate As Date[]
  Dim inidate As Date
  Dim lstdate As Date
  Dim res As Result
  Dim hForm As FRequest

  xdate = DoubleDates("Select Dates", "Yearly Report", [Now(), Now()])
  If xdate Then
    inidate = xdate[0]
    lstdate = xdate[1]

    If inidate And If lstdate Then
      res = modDatabase.$syConn.Exec("select fldfiscal,fldbillno,fldpatname,fldpan,flddate,flditemamt,flddiscountamt,fldtaxable,fldtaxamt,fldtotamt,fldsync,fldprinted,fldactive,flddate,fldpunch,fldprint,xyz from tblfiscal where flddate>=&1 and flddate<=&2", modDate.StartSqlDate(inidate), modDate.EndSqlDate(lstdate))                                                                ''
      hForm = New FRequest(res, "Yearly Report", "YearReport", True)
      hForm.ShowModal
    Endif
  Endif

End

Public Sub mnupur_Click()

  Dim hForm As FmSupplier

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmSupplier(Workspace1)

End

Public Sub mnuinventory_Click()

  Dim hForm As Fmmedreport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["Fmmedreport"])
  hForm = New Fmmedreport(Workspace1)

End

Public Sub mnutransfer_Click()

  Dim hForm As FmmedTransfer

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmmedTransfer"])
  hForm = New FmmedTransfer(Workspace1)

End

Public Sub mnupersonal_Click()

  Dim hForm As FmPersonal

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  modGeneralMain.$FormOpenList.Add(["FmPersonal"])
  hForm = New FmPersonal(Workspace1)

End

Public Sub mnuregistparam_Click()

  Dim xPass As String

  xPass = InputPassword("Provide Root Password", "Verification", "")
  If modPassword.GetSuperVerification(modBasic.$lbluser, xPass) = True Then
    fmRegAccSetting.ShowModal
  Else
    Message.Info("Incorrect Root Password", ("OK"))
  Endif

End

Public Sub mnubillrule_Click()

  Dim xPass As String

  xPass = InputPassword("Provide Root Password", "Verification", "")
  If modPassword.GetSuperVerification(modBasic.$lbluser, xPass) = True Then
    fmForBillSettings.ShowModal
  Else
    Message.Info("Incorrect Root Password", ("OK"))
  Endif

End

Public Sub mnuautobill_Click()

  Dim xPass As String

  xPass = InputPassword("Provide Root Password", "Verification", "")
  If modPassword.GetSuperVerification(modBasic.$lbluser, xPass) = True Then
    fmIPBillSetting.ShowModal
  Else
    Message.Info("Incorrect Root Password", ("OK"))
  Endif

End

Public Sub mnucuruserid_Click()

  Dim hForm As FmReportUsers

  If modBasic.$lbluser Then
    hForm = New FmReportUsers(modBasic.$lbluser)
    hForm.ShowModal
  Endif

End

Public Sub mnurepogrp_Click()

  fmAccGroup.ShowModal

End

''------------------------ Go Back -----------------
Public Sub btntopleft_Click()

  Dim xVar As Variant
  Dim asx As String[]

  If modGeneralMain.$FormOpenList.Count > 1 Then
    If Not modGeneralMain.$FormOpenQue Then
      modGeneralMain.$FormOpenQue = modGeneralMain.$FormOpenList.Max - 1
    Else
      modGeneralMain.$FormOpenQue = modGeneralMain.$FormOpenQue - 1
    Endif

    If modGeneralMain.$FormOpenQue >= 0 Then
      xVar = modGeneralMain.$FormOpenList[modGeneralMain.$FormOpenQue]
      If xVar Then
        asx = xVar
        MoveFormsTab(asx)
        modGeneralMain.$FormOpenList.Remove(modGeneralMain.$FormOpenList.Max)
      Endif
    Endif

  Endif

End

Public Sub btntopright_Click()

  Dim xVar As Variant
  Dim asx As String[]

  If modGeneralMain.$FormOpenList.Count > 1 Then
    If modGeneralMain.$FormOpenQue > modGeneralMain.$FormOpenList.Max Then
      modGeneralMain.$FormOpenQue = modGeneralMain.$FormOpenList.Max
    Else
      modGeneralMain.$FormOpenQue = modGeneralMain.$FormOpenQue + 1
    Endif

    If modGeneralMain.$FormOpenQue <= modGeneralMain.$FormOpenList.Max Then
      xVar = modGeneralMain.$FormOpenList[modGeneralMain.$FormOpenQue]
      If xVar Then
        asx = xVar
        MoveFormsTab(asx)
        modGeneralMain.$FormOpenList.Remove(modGeneralMain.$FormOpenList.Max)
      Endif
    Endif

  Endif

End

Private Sub MoveFormsTab(asx As String[])

  If asx[0] = "FmCost" Then
    If asx[1] = "Diagnostic Tests Cost" Then
      mnulab_Click()
    Else If asx[1] = "Radio Diagnostics Cost" Then
      mnuradio_Click()
    Else If asx[1] = "General Services Cost" Then
      mnuservice_Click()
    Else If asx[1] = "Procedures Cost" Then
      mnuproc_Click()
    Else If asx[1] = "Equipment Cost" Then
      mnuequipment_Click()
    Else If asx[1] = "Other Items Cost" Then
      mnuother_Click()
    Endif
  Else If asx[0] = "FmHIUpload" Then
    mnuclaimup_Click()
  Else If asx[0] = "FmSummryReport" Then
    mnusummrepo_Click()
  Else If asx[0] = "FmBillCollect" Then
    mnucollection_Click()
  Else If asx[0] = "FmCashVerify" Then
    mnucashverify_Click()
  Else If asx[0] = "FmBilledStatus" Then
    mnuitemstatus_Click()
  Else If asx[0] = "FmBillReturn" Then
    mnureturnform_Click()
  Else If asx[0] = "FmStaffList" Then
    mnustafflist_Click()
  Else If asx[0] = "FmGroupCateg" Then
    mnugeneric_Click()
  Else If asx[0] = "Fmservreport" Then
    mnuserv_Click()
  Else If asx[0] = "FmGroupReport" Then
    mnugrpreport_Click()
  Else If asx[0] = "FmMasterReport" Then
    mnufacultyrepo_Click()
  Else If asx[0] = "FmshareGroup" Then
    mnusharing_Click()
  Else If asx[0] = "Fmsharereport" Then
    mnusharing_Click()
  Else If asx[0] = "FmPatBillRecord" Then
    mnubill_Click()
  Else If asx[0] = "FmDepositReport" Then
    mnudeposit_Click()
  Else If asx[0] = "FmVoucherReport" Then
    mnuvouchers_Click()
  Else If asx[0] = "Fmmedreport" Then
    mnuinventory_Click()
  Else If asx[0] = "FmmedTransfer" Then
    mnutransfer_Click()
  Else If asx[0] = "FmPersonal" Then
    mnupersonal_Click()
  Endif

End

Public Sub mnudarkmode_Click()

  Me.Exec("changeScreenMode();")

End
