' Gambas module file

Public Function ReceiptReportBillingRangeSummary(sFormat As String, $con As Connection, RepoForm As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tbltempbilldetail As String) As String                                ''

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("CATEGORY"), ("COUNT"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("CREDIT"), ("CASH")], "", "")
  $BillingReport.UserData.Add("Receipt Summary", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeSummary($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    RepoVal = cReport.GetReceiptReportBillingRangeSummary($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeSummary($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeSummary($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeAccount(sFormat As String, $con As Connection, RepoForm As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("CATEGORY"), ("COUNT"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("CREDIT"), ("CASH")], "", "")
  $BillingReport.UserData.Add("Receipt Summary", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeAccount($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    RepoVal = cReport.GetReceiptReportBillingRangeAccount($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeAccount($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeAccount($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeUserDetail(sFormat As String, $con As Connection, RepoForm As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("USER"), ("COUNT"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("CREDIT"), ("CASH"), ("DEPOSIT")], "", "")
  $BillingReport.UserData.Add("User Collection", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeUserDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    RepoVal = cReport.GetReceiptReportBillingRangeUserDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeUserDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeUserDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeUserBrief(sFormat As String, $con As Connection, RepoForm As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("USER"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("CREDIT"), ("CASH"), ("DEPOSIT")], "", "")
  $BillingReport.UserData.Add("User Collection", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeUserBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    RepoVal = cReport.GetReceiptReportBillingRangeUserBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeUserBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeUserBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeGroupDetail(sFormat As String, $con As Connection, RepoForm As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tblpatbilling As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("CATEGORY"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("CREDIT"), ("CASH")], "", "")
  $BillingReport.UserData.Add("Group Collection", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeGroupDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam("", "", "t2")
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    cReport.$UserGrp = cParam.GetUserID()
    cReport.$CompGrp = cParam.GetCompID()
    RepoVal = cReport.GetReceiptReportBillingRangeGroupDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead, "t2")
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      cReport.$UserGrp = cParam.GetUserID()
      cReport.$CompLst = cParam.GetCompList()
      RepoVal = cReport.GetReceiptReportBillingRangeGroupDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead, "t2")
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      cReport.$UserGrp = cParam.GetUserID()
      cReport.$CompGrp = cParam.GetCompID()
      RepoVal = cReport.GetReceiptReportBillingRangeGroupDetail($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeGroupBrief(sFormat As String, $con As Connection, RepoForm As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tblpatbilling As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("CATEGORY"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("CREDIT"), ("CASH")], "", "")
  $BillingReport.UserData.Add("Group Collection", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeGroupBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam("", "", "t2")
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    cReport.$UserGrp = cParam.GetUserID()
    cReport.$CompGrp = cParam.GetCompID()
    RepoVal = cReport.GetReceiptReportBillingRangeGroupBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead, "t2")
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      cReport.$UserGrp = cParam.GetUserID()
      cReport.$CompLst = cParam.GetCompList()
      RepoVal = cReport.GetReceiptReportBillingRangeGroupBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead, "t2")
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      cReport.$UserGrp = cParam.GetUserID()
      cReport.$CompGrp = cParam.GetCompID()
      RepoVal = cReport.GetReceiptReportBillingRangeGroupBrief($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeLocation(sFormat As String, $con As Connection, RepoForm As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tblpatbilling As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("CATEGORY"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("CREDIT"), ("CASH")], "", "")
  $BillingReport.UserData.Add("Group Collection", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeLocation($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam("", "", "t2")
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    cReport.$UserGrp = cParam.GetUserID()
    cReport.$CompGrp = cParam.GetCompID()
    RepoVal = cReport.GetReceiptReportBillingRangeLocation($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead, "t2")
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      cReport.$UserGrp = cParam.GetUserID()
      cReport.$CompLst = cParam.GetCompList()
      RepoVal = cReport.GetReceiptReportBillingRangeLocation($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead, "t2")
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      cReport.$UserGrp = cParam.GetUserID()
      cReport.$CompGrp = cParam.GetCompID()
      RepoVal = cReport.GetReceiptReportBillingRangeLocation($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeTaxDiscount(sFormat As String, $con As Connection, RepoForm As String, sType As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("DATE"), ("ENCID"), ("PATIENT"), ("TYPE"), ("INVOICE"), ("GROSS"), UCase(sType), ("LABEL"), ("ACCOUNT"), ("CASHIER")], "", "")
  $BillingReport.UserData.Add(sType & " Report", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeTaxDiscount($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    RepoVal = cReport.GetReceiptReportBillingRangeTaxDiscount($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeTaxDiscount($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeTaxDiscount($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptReportBillingRangeCashCredit(sFormat As String, $con As Connection, RepoForm As String, sType As String, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cParam As CAccParam
  Dim cReport As CReceiptAll
  Dim headLst As String[]
  Dim xhead As String
  Dim RepoLst As String[]

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  If sType = "Cash" Then
    $BillingReport = New CReportHTML([("DATE"), ("ENCID"), ("PATIENT"), ("TYPE"), ("INVOICE"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("NET"), ("RECEIVED"), ("QR-PAY"), ("HAND-CASH"), ("ACCOUNT")], "", "")
  Else
    $BillingReport = New CReportHTML([("DATE"), ("ENCID"), ("PATIENT"), ("TYPE"), ("INVOICE"), ("GROSS"), ("DISCOUNT"), ("TAX"), ("NET"), ("RECEIVED"), ("ACCOUNT")], "", "")
  Endif
  $BillingReport.UserData.Add(sType & " Report", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  ' RepoVal = modReceiptAll.GetReceiptReportBillingRangeCashCredit($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
  If RepoForm = "Summary" Then
    cParam = New CAccParam
    cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
    RepoVal = cReport.GetReceiptReportBillingRangeCashCredit($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)

  Else If RepoForm = "Branch" Then
    RepoLst = New String[]
    headLst = modBasic.$AllBranchList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Branch", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeCashCredit($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Else If RepoForm = "Location" Then
    RepoLst = New String[]
    headLst = modBasic.$AllCompList
    For Each xhead In headLst
      $BillingReport.AddChapter(xhead)
      cParam = New CAccParam("Location", xhead)
      cReport = New CReceiptAll(cParam.GetExtraSQL(), cParam.GetFooterText())
      RepoVal = cReport.GetReceiptReportBillingRangeCashCredit($BillingReport, sFormat, $con, sType, bill1, bill2, sLocaType, sLocation, $tbltempbilldetail)
      $BillingReport.AddChapter("<br>")
    Next

  Endif

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End

Public Function ReceiptInvoiceReportDetailByMismatch(sFormat As String, $con As Connection, bill1 As Variant, bill2 As Variant, sLocaType As String, sLocation As String, $tblpatbilling As String, $tbltempbilldetail As String) As String

  Dim $BillingReport As CReportHTML
  Dim RepoPath As String
  Dim xparam As String
  Dim RepoVal As Float

  Dim cReport As CReceiptAll

  If sFormat = "Date" Then
    xparam = modReportVar.GetDateTimeReport(bill1, gb.GeneralDate) & " TO " & modReportVar.GetDateTimeReport(bill2, gb.GeneralDate)
  Else
    xparam = bill1 & " TO " & bill2
  Endif
  $BillingReport = New CReportHTML([("InvNo"), ("ItemTotal"), ("InvTotal"), ("TotDiff"), ("ItemTax"), ("InvTax"), ("TaxDiff"), ("ItemDisc"), ("InvDisc"), ("DiscDiff"), ("ItemCash"), ("InvCash"), ("CashDiff")], "", "")
  $BillingReport.UserData.Add("Receipt Tax/Discount Mismatch", "PARAM1")
  $BillingReport.UserData.Add(xparam, "PARAM2")

  cReport = New CReceiptAll("", "")
  RepoVal = cReport.GetReceiptInvoiceReportDetailByMismatch($BillingReport, sFormat, $con, bill1, bill2, sLocaType, sLocation, $tblpatbilling, $tbltempbilldetail)

  RepoPath = $BillingReport.NewHTMLPath()
  Return RepoPath

End
