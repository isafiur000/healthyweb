' Gambas class file

Public Sub _new()

  cmbcategory.List = ["Nominal", "Ordinal", "Scale"] '["String", "Number"]
  cmbvariable.List = modLongVar.$RegistVar
  UnivariateSetting()

End

Private Sub ClearPatientBox(txtmin As WebValueBox, txtmax As WebValueBox, txtusegridcol As WebSpinBox, chkusegrid As WebCheckBox, txtsqlgrid As WebTextArea, txtgrdfir As WebSpinBox, txtgrdsec As WebTextBox, txtgrdthir As WebTextBox, cmbencvar As WebComboBox, txtsqlenc As WebTextArea, txtencfir As WebTextBox, txtencsec As WebTextBox, txtencthir As WebTextBox, txtxscript As WebButtonBox, txtxshell As WebTextBox)                                                              ''

  txtmin.Value = 0
  txtmax.Value = 0
  txtusegridcol.Value = 0
  chkusegrid.Value = False
  txtsqlgrid.Text = ""
  txtgrdfir.Value = 0
  txtgrdsec.Text = ""
  txtgrdthir.Text = ""
  cmbencvar.Text = ""
  txtsqlenc.Text = ""
  txtencfir.Text = ""
  txtencsec.Text = ""
  txtencthir.Text = ""
  txtxscript.Text = ""
  txtxshell.Text = ""

End

''---------------------------------------- Univariate -------------------------------
' Public Sub txtuniencsql_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtuniencsql)
'
' End
'
' Public Sub txtunigridsql_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtunigridsql)
'
' End

Public Sub btnadduni_Click()

  cmbvariable.Text = VarDiagnostic()

End

Public Sub btnclearunivar_Click()

  cmbcategory.Text = ""
  chktimeseries.Value = False
  ClearPatientBox(txtunilower, txtuniupper, txtunigridcol, chkunigrid, txtunigridsql, txtunigridfiroption, txtunigridsecoption, txtunigridthirdoption, cmbvariable, txtuniencsql, txtuniencfiroption, txtiniencsecoption, txtuniencthirdoption, txtuniscript, txtunishell)

End

Public Sub btnsaveuni_Click()

  modSettings.SaveSettingsToFile("UnivariateAnalysis/DataType", cmbcategory.Text)
  modSettings.EnterCheckSetting(chkunigrid, "UnivariateAnalysis/UseGridView")
  modSettings.EnterCheckSetting(chktimeseries, "UnivariateAnalysis/TimeSeries")
  modSettings.EnterCheckSetting(chkunitrans, "UnivariateAnalysis/Translate")

  modSettings.SaveSettingsToFile("UnivariateAnalysis/GridViewColumn", CStr(txtunigridcol.Value))
  modSettings.SaveSettingsToFile("UnivariateAnalysis/GridSQLText", txtunigridsql.Text)
  modSettings.SaveSettingsToFile("UnivariateAnalysis/GridOption1", CStr(txtunigridfiroption.Value))
  modSettings.SaveSettingsToFile("UnivariateAnalysis/GridOption2", txtunigridsecoption.Text)
  modSettings.SaveSettingsToFile("UnivariateAnalysis/GridOption3", txtunigridthirdoption.Text)

  modSettings.SaveSettingsToFile("UnivariateAnalysis/PatVariable", cmbvariable.Text)
  modSettings.SaveSettingsToFile("UnivariateAnalysis/EncSQLText", txtuniencsql.Text)
  modSettings.SaveSettingsToFile("UnivariateAnalysis/EncOption1", txtuniencfiroption.Text)
  modSettings.SaveSettingsToFile("UnivariateAnalysis/EncOption2", txtiniencsecoption.Text)
  modSettings.SaveSettingsToFile("UnivariateAnalysis/EncOption3", txtuniencthirdoption.Text)

  modSettings.SaveSettingsToFile("UnivariateAnalysis/Script", txtuniscript.Text)
  modSettings.SaveSettingsToFile("UnivariateAnalysis/Shell", txtunishell.Text)

  modSettings.SaveSettingsToFile("UnivariateAnalysis/LowerRange", CStr(txtunilower.Value))
  modSettings.SaveSettingsToFile("UnivariateAnalysis/UpperRange", CStr(txtuniupper.Value))

  modCustPatient.LoadEncChartSetting()
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")
  ' Balloon.Delay = modBasic.$BalloonDelay

End

Private Sub UnivariateSetting()

  cmbcategory.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/DataType")
  modSettings.ShowCheckBox(chkunigrid, "UnivariateAnalysis/UseGridView")
  modSettings.ShowCheckBox(chktimeseries, "UnivariateAnalysis/TimeSeries")
  modSettings.ShowCheckBox(chkunitrans, "UnivariateAnalysis/Translate")

  If modSettings.ShowSettingFromFIle("UnivariateAnalysis/GridViewColumn") Then
    txtunigridcol.Value = CInt(modSettings.ShowSettingFromFIle("UnivariateAnalysis/GridViewColumn"))
  Endif
  txtunigridsql.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/GridSQLText")
  If modSettings.ShowSettingFromFIle("UnivariateAnalysis/GridOption1") Then
    txtunigridfiroption.Value = CInt(modSettings.ShowSettingFromFIle("UnivariateAnalysis/GridOption1"))
  Endif
  txtunigridsecoption.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/GridOption2")
  txtunigridthirdoption.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/GridOption3")

  cmbvariable.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/PatVariable")
  txtuniencsql.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/EncSQLText")
  txtuniencfiroption.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/EncOption1")
  If Not txtuniencfiroption.Text Then
    txtuniencfiroption.Text = "{EncounterID}"
  Endif
  txtiniencsecoption.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/EncOption2")
  txtuniencthirdoption.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/EncOption3")

  txtuniscript.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/Script")
  txtunishell.Text = modSettings.ShowSettingFromFIle("UnivariateAnalysis/Shell")

  If modSettings.ShowSettingFromFIle("UnivariateAnalysis/LowerRange") Then
    txtunilower.Value = CFloat(modSettings.ShowSettingFromFIle("UnivariateAnalysis/LowerRange"))
  Endif
  If modSettings.ShowSettingFromFIle("UnivariateAnalysis/UpperRange") Then
    txtuniupper.Value = CFloat(modSettings.ShowSettingFromFIle("UnivariateAnalysis/UpperRange"))
  Endif

End
