' Gambas class file

Private $encid As String

Public Sub _new(encid As String)

  $encid = encid
  ShowDataFromPatMain()

End

''========================= tblpatientinfo =========================
Private Sub ShowDataFromPatMain()

  txtname.Text = modPatient.GetPatientNameByEnc($encid)
  txtpatno.Text = modPatient.GetPatientNoByEnc($encid)
  txtagesex.Text = modPatient.GetPatientAgeString($encid, Now()) & "/" & Left(modPatient.GetPatientSex($encid), 1)
  txtaddress.Text = modPatient.GetPatientAddressByEnc($encid)
  txtcontact.Text = modPatient.GetPatientContactByEnc($encid)
  txtemail.Text = modPatient.GetPatientEmail($encid)
  DisplayBlobData()

End

Private Sub DisplayBlobData()

  Dim tempFile As String

  ' tempFile = modImage.DisplayPersonImageData("Patient", txtpatno.Text)
  tempFile = modDevAll.MakeQRCode($encid)
  If tempFile Then
    modImage.StretchtPictureToBox(PictureBox1, tempFile)
  Endif

End
