' Gambas class file

Private $FormName As String
Private $sTabList As String[] = ["NewColumn1", "NewColumn2", "NewColumn3", "NewColumn4", "NewColumn5"]

Public Sub _new(frm As String)

  Dim formList As String[] = ["Date", "Boolean", "Currency", "Number"]

  $FormName = frm
  cmbvariable1.List = modLongVar.$RegistVar
  cmbvariable2.List = modLongVar.$RegistVar
  cmbvariable3.List = modLongVar.$RegistVar
  cmbvariable4.List = modLongVar.$RegistVar
  cmbvariable5.List = modLongVar.$RegistVar

  cmbformat1.List = formList
  cmbformat2.List = formList
  cmbformat3.List = formList
  cmbformat4.List = formList
  cmbformat5.List = formList
  ShowFilecustom(0)

End

Public Sub TabPanel1_Click()

  ShowFilecustom(TabPanel1.Index)

End

''======================================== Custom Columns ---------------------------------------------------------------
Private Sub SaveCustCol(IconPanelx As WebTabPanel, cmbvariable As WebComboBox, txtsqlx As WebTextArea, txtoptx1 As WebTextBox, txtoptx2 As WebTextBox, txtoptx3 As WebTextBox, txttitlex As WebTextBox, chkarray As WebCheckBox, txtscript As WebButtonBox, txtshell As WebTextBox, cmbformat As WebComboBox)                                    ''

  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Title", txttitlex.Text)
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "PatVariable", cmbvariable.Text)
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "SQLText", txtsqlx.Text)
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Option1", txtoptx1.Text)
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Option2", txtoptx2.Text)
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Option3", txtoptx3.Text)
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Format", cmbformat.Text)
  modSettings.EnterCheckSetting(chkarray, $FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "ArrayOutput")
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "FormatScript", txtscript.Text)
  modSettings.SaveSettingsToFile($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "FormatShell", txtshell.Text)

  ' If modCustPatient.$extColumnColl Then
  '   modCustPatient.$extColumnColl.Clear()
  ' Endif

End

Private Sub ShowCustColumn(IconPanelx As WebTabPanel, cmbvariable As WebComboBox, txtsqlx As WebTextArea, txtoptx1 As WebTextBox, txtoptx2 As WebTextBox, txtoptx3 As WebTextBox, txttitlex As WebTextBox, chkarray As WebCheckBox, txtscript As WebButtonBox, txtshell As WebTextBox, cmbformat As WebComboBox)

  txttitlex.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Title")
  cmbvariable.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "PatVariable")
  txtsqlx.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "SQLText")
  txtoptx1.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Option1")
  txtoptx2.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Option2")
  txtoptx3.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Option3")
  cmbformat.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "Format")
  modSettings.ShowCheckBox(chkarray, $FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "ArrayOutput")
  txtscript.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "FormatScript")
  txtshell.Text = modSettings.ShowSettingFromFIle($FormName & "_" & $sTabList[IconPanelx.Index] & "/" & "FormatShell")

End

Public Sub btnsave1_Click()

  SaveCustCol(TabPanel1, cmbvariable1, txtsql1, txtfiroption1, txtsecoption1, txtthirdoption1, txttitle1, chkarry1, txtscript1, txtshell1, cmbformat1)
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")
  ' Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnsave2_Click()

  SaveCustCol(TabPanel1, cmbvariable2, txtsql2, txtfiroption2, txtsecoption2, txtthirdoption2, txttitle2, chkarry2, txtscript2, txtshell2, cmbformat2)
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")
  ' Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnsave3_Click()

  SaveCustCol(TabPanel1, cmbvariable3, txtsql3, txtfiroption3, txtsecoption3, txtthirdoption3, txttitle3, chkarry3, txtscript3, txtshell3, cmbformat3)
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")
  ' Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnsave4_Click()

  SaveCustCol(TabPanel1, cmbvariable4, txtsql4, txtfiroption4, txtsecoption4, txtthirdoption4, txttitle4, chkarry4, txtscript4, txtshell4, cmbformat4)
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")
  ' Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnsave5_Click()

  SaveCustCol(TabPanel1, cmbvariable5, txtsql5, txtfiroption5, txtsecoption5, txtthirdoption5, txttitle5, chkarry5, txtscript5, txtshell5, cmbformat5)
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")
  ' Balloon.Delay = modBasic.$BalloonDelay

End

Private Sub ShowFilecustom(sInt As Integer)

  If sInt = 0 Then
    ShowCustColumn(TabPanel1, cmbvariable1, txtsql1, txtfiroption1, txtsecoption1, txtthirdoption1, txttitle1, chkarry1, txtscript1, txtshell1, cmbformat1)
  Else If sInt = 1 Then
    ShowCustColumn(TabPanel1, cmbvariable2, txtsql2, txtfiroption2, txtsecoption2, txtthirdoption2, txttitle2, chkarry2, txtscript2, txtshell2, cmbformat2)
  Else If sInt = 2 Then
    ShowCustColumn(TabPanel1, cmbvariable3, txtsql3, txtfiroption3, txtsecoption3, txtthirdoption3, txttitle3, chkarry3, txtscript3, txtshell3, cmbformat3)
  Else If sInt = 3 Then
    ShowCustColumn(TabPanel1, cmbvariable4, txtsql4, txtfiroption4, txtsecoption4, txtthirdoption4, txttitle4, chkarry4, txtscript4, txtshell4, cmbformat4)
  Else If sInt = 4 Then
    ShowCustColumn(TabPanel1, cmbvariable5, txtsql5, txtfiroption5, txtsecoption5, txtthirdoption5, txttitle5, chkarry5, txtscript5, txtshell5, cmbformat5)
  Endif

End

' Public Sub txtsql1_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtsql1)
'
' End
'
' Public Sub txtsql2_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtsql2)
'
' End
'
' Public Sub txtsql3_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtsql3)
'
' End
'
' Public Sub txtsql4_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtsql4)
'
' End
'
' Public Sub txtsql5_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtsql5)
'
' End

Private Sub ClearAll(cmbvariable As WebComboBox, txtsqlx As WebTextArea, txtoptx1 As WebTextBox, txtoptx2 As WebTextBox, txtoptx3 As WebTextBox, txttitlex As WebTextBox, chkarray As WebCheckBox, txtscript As WebButtonBox, txtshell As WebTextBox, cmbformat As WebComboBox)

  cmbvariable.Text = ""
  txtsqlx.Text = ""
  txtoptx1.Text = ""
  txtoptx2.Text = ""
  txtoptx3.Text = ""
  txttitlex.Text = ""
  cmbformat.Text = ""
  chkarray.Value = False
  txtscript.Text = ""
  txtshell.Text = ""

End

Public Sub btnclear1_Click()

  ClearAll(cmbvariable1, txtsql1, txtfiroption1, txtsecoption1, txtthirdoption1, txttitle1, chkarry1, txtscript1, txtshell1, cmbformat1)

End

Public Sub btnclear2_Click()

  ClearAll(cmbvariable2, txtsql2, txtfiroption2, txtsecoption2, txtthirdoption2, txttitle2, chkarry2, txtscript2, txtshell2, cmbformat2)

End

Public Sub btnclear3_Click()

  ClearAll(cmbvariable3, txtsql3, txtfiroption3, txtsecoption3, txtthirdoption3, txttitle3, chkarry3, txtscript3, txtshell3, cmbformat3)

End

Public Sub btnclear4_Click()

  ClearAll(cmbvariable4, txtsql4, txtfiroption4, txtsecoption4, txtthirdoption4, txttitle4, chkarry4, txtscript4, txtshell4, cmbformat4)

End

Public Sub btnclear5_Click()

  ClearAll(cmbvariable5, txtsql5, txtfiroption5, txtsecoption5, txtthirdoption5, txttitle5, chkarry5, txtscript5, txtshell5, cmbformat5)

End

Public Sub btnadduni1_Click()

  cmbvariable1.Text = VarDiagnostic()

End

Public Sub btnadduni2_Click()

  cmbvariable2.Text = VarDiagnostic()

End

Public Sub btnadduni3_Click()

  cmbvariable3.Text = VarDiagnostic()

End

Public Sub btnadduni4_Click()

  cmbvariable4.Text = VarDiagnostic()

End

Public Sub btnadduni5_Click()

  cmbvariable5.Text = VarDiagnostic()

End

Public Sub btnclose1_Click()

  Me.Close()

End

Public Sub btnenc1_Click()

  txtfiroption1.Text = "{EncounterID}"

End

Public Sub btnenc2_Click()

  txtfiroption2.Text = "{EncounterID}"

End

Public Sub btnenc3_Click()

  txtfiroption3.Text = "{EncounterID}"

End

Public Sub btnenc4_Click()

  txtfiroption4.Text = "{EncounterID}"

End

Public Sub btnenc5_Click()

  txtfiroption5.Text = "{EncounterID}"

End

Private Sub ColumnTableValue() As String

  Dim xList As String[]
  Dim xval As String
  Dim xxx As String

  xList = modMedicine.GetMedVariables()
  xval = InputCombo("Select Patient Variable", "Clinic", xList, "", False)
  If xval Then
    xxx = "{$ColumnTable:" & xval & "$}"
  Endif

  Return xxx

End

Public Sub btnaddTable1_Click()

  cmbvariable1.Text = ColumnTableValue()

End

Public Sub btnaddTable2_Click()

  cmbvariable2.Text = ColumnTableValue()

End

Public Sub btnaddTable3_Click()

  cmbvariable3.Text = ColumnTableValue()

End

Public Sub btnaddTable4_Click()

  cmbvariable4.Text = ColumnTableValue()

End

Public Sub btnaddTable5_Click()

  cmbvariable5.Text = ColumnTableValue()

End
