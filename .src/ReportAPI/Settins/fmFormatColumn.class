' Gambas class file

Public Sub _new()

  cmbvariable1.List = modLongVar.$RegistVar
  ShowFilecustom()

End

''======================================== Custom Columns ---------------------------------------------------------------
Private Sub SaveCustCol(cmbvariable As WebComboBox, txtsqlx As WebTextArea, txtoptx1 As WebTextBox, txtoptx2 As WebTextBox, txtoptx3 As WebTextBox, txttitlex As WebTextBox, chkarray As WebCheckBox, txtscript As WebButtonBox, txtshell As WebTextBox)                                    ''

  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "Title", txttitlex.Text)
  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "PatVariable", cmbvariable.Text)
  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "SQLText", txtsqlx.Text)
  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "Option1", txtoptx1.Text)
  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "Option2", txtoptx2.Text)
  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "Option3", txtoptx3.Text)
  modSettings.EnterCheckSetting(chkarray, "FormatColumn" & "/" & "ArrayOutput")
  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "FormatScript", txtscript.Text)
  modSettings.SaveSettingsToFile("FormatColumn" & "/" & "FormatShell", txtshell.Text)

  ' If modCustPatient.$extColumnColl Then
  '   modCustPatient.$extColumnColl.Clear()
  ' Endif

End

Private Sub ShowCustColumn(cmbvariable As WebComboBox, txtsqlx As WebTextArea, txtoptx1 As WebTextBox, txtoptx2 As WebTextBox, txtoptx3 As WebTextBox, txttitlex As WebTextBox, chkarray As WebCheckBox, txtscript As WebButtonBox, txtshell As WebTextBox)

  txttitlex.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "Title")
  cmbvariable.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "PatVariable")
  txtsqlx.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "SQLText")
  txtoptx1.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "Option1")
  txtoptx2.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "Option2")
  txtoptx3.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "Option3")
  modSettings.ShowCheckBox(chkarray, "FormatColumn" & "/" & "ArrayOutput")
  txtscript.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "FormatScript")
  txtshell.Text = modSettings.ShowSettingFromFIle("FormatColumn" & "/" & "FormatShell")

End

Public Sub btnsave1_Click()

  SaveCustCol(cmbvariable1, txtsql1, txtfiroption1, txtsecoption1, txtthirdoption1, txttitle1, chkarry1, txtscript1, txtshell1)
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")
  ' Balloon.Delay = modBasic.$BalloonDelay

End

Private Sub ShowFilecustom()

  ShowCustColumn(cmbvariable1, txtsql1, txtfiroption1, txtsecoption1, txtthirdoption1, txttitle1, chkarry1, txtscript1, txtshell1)

End

' Public Sub txtsql1_KeyPress()
'
'   modGeneralMain.InsertTexEditortData(txtsql1)
'
' End

Private Sub ClearAll(cmbvariable As WebComboBox, txtsqlx As WebTextArea, txtoptx1 As WebTextBox, txtoptx2 As WebTextBox, txtoptx3 As WebTextBox, txttitlex As WebButtonBox, chkarray As WebCheckBox)

  cmbvariable.Text = ""
  txtsqlx.Text = ""
  txtoptx1.Text = ""
  txtoptx2.Text = ""
  txtoptx3.Text = ""
  txttitlex.Text = ""
  chkarray.Value = False

End

Public Sub btnclear1_Click()

  ClearAll(cmbvariable1, txtsql1, txtfiroption1, txtsecoption1, txtthirdoption1, txttitle1, chkarry1)

End

Public Sub btnadduni1_Click()

  cmbvariable1.Text = VarDiagnostic()

End

Public Sub btnenc1_Click()

  txtfiroption1.Text = "{EncounterID}"

End
