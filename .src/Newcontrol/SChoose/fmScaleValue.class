' Gambas class file

Private $sList As String[]
Private $sValue As String[]

Public Sub Run(sTitle As String, sList As String[]) As String[]

  txttitle.Text = sTitle
  $sList = sList
  modGeneralMain.GetOpenModalForm(Me)

  $sValue = New String[]
  FillICDGrid()
  If Me.ShowModal() Then Return $sValue

End

Public Sub FillICDGrid()

  GridView1.Clear()
  GridView1.Columns.Count = 2
  GridView1.Count = $sList.Count

  With GridView1
    .Columns[1].Width = CStr(75 * modBasic.$AppWidthRatio) & "px"
    .Columns[0].Text = "Description"
    .Columns[1].Text = "Value"
  End With

End

Public Sub GridView1_Data(Row As Integer, Column As Integer, Data As WebTableData)

  Dim sLip As String[]

  modGridView.GridViewDecoration(Data, Row)
  sLip = Split($sList[Row], "@")
  If Column = 0 Then
    Data.Text = sLip[0]
  Else If Column = 1 Then
    Data.Text = sLip[1]
  Endif

End

Public Sub btnok_Click()

  Dim xxx As String[]
  Dim sLip As String[]

  If GridView1.Selection.Count Then
    sLip = Split($sList[GridView1.Selection[0]], "@")
    xxx = New String[]
    xxx.Add(sLip[1])
    xxx.Add(sLip[0])
    $sValue = xxx
    Me.Close(True)
  Endif

End

Public Sub btnclose_Click()

  Me.Close()

End
