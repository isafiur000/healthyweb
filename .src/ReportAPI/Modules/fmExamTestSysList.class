' Gambas class file

Private $sValue As String

Public Sub Run() As String

  If Me.ShowModal() Then Return $sValue

End

Public Sub _new()

  lstcategory.List = ["Exam", "Test", "Radio", "Demog", "General"]
  cmbgenparam.List = ["Triage", "Discharge", "Left", "Right", "First", "Last"]

End

Public Sub lstcategory_Click()

  Dim xlst As String[]

  If lstcategory.Text = "Demog" Then
    xlst = modBasic.$DemogList
  Else If lstcategory.Text = "Exam" Then
    xlst = modBasic.$sysExamDualList
  Else If lstcategory.Text = "Test" Then
    xlst = modBasic.$sysTestDualList
  Else If lstcategory.Text = "Radio" Then
    xlst = modBasic.$sysRadioList
  Else If lstcategory.Text = "General" Then
    xlst = ["AgeInDays", "Body_Surface_Area", "Ideal_Body_Weight", "Body_Mass_Index"]
    cmbgenparam.Text = "Last"
  Endif
  ListView1.List = xlst

End

Public Sub ListView1_Select()

  Dim xval As String

  If lstcategory.Text And If cmbgenparam.Text Then
    If lstcategory.Text = "General" Then
      xval = "{" & ListView1.Text & "}"
    Else
      xval = "{$" & cmbgenparam.Text & "_" & lstcategory.Text & ":" & ListView1.Text & "$}"
    Endif

    If chkexpress.Value = True Then
      txtexpression.Text = txtexpression.Text & xval
    Else
      txtexpression.Text = xval
    Endif
  Endif

End

Public Sub btnsave_Click()

  If txtexpression.Text Then
    If chkexpress.Value = True Then
      $sValue = "$Calc[" & txtexpression.Text & "]"
    Else
      $sValue = txtexpression.Text
    Endif
    Me.Close(True)
  Endif

End

Public Sub Button1_Click()

  txtexpression.Text = txtexpression.Text & "+"

End

Public Sub Button2_Click()

  txtexpression.Text = txtexpression.Text & "-"

End

Public Sub Button3_Click()

  txtexpression.Text = txtexpression.Text & "^"

End

Public Sub Button4_Click()

  txtexpression.Text = txtexpression.Text & "*"

End

Public Sub Button5_Click()

  txtexpression.Text = txtexpression.Text & "/"

End

Public Sub Button6_Click()

  txtexpression.Text = txtexpression.Text & "Exp"

End

Public Sub Button7_Click()

  txtexpression.Text = txtexpression.Text & "("

End

Public Sub Button8_Click()

  txtexpression.Text = txtexpression.Text & ")"

End

Public Sub Button9_Click()

  txtexpression.Text = txtexpression.Text & "Sqr"

End
