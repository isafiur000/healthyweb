' Gambas class file

Public Sub _new()

  cmbdosrecom.List = ["Yes", "No"]
  cmbdosedisease.List = ["Disease", "History", "None"]
  cmbnoregimen.List = ["Enable", "Disable"]
  cmbrendos.List = ["Yes", "No"]
  DiseaseDisplay()
  ActivateRenalDose()

End

Public Sub IconPanel1_Click()

  If IconPanel1.Index = 0 Then
    cmbdosrecom.List = ["Yes", "No"]
    cmbdosedisease.List = ["Disease", "History", "None"]
    cmbnoregimen.List = ["Enable", "Disable"]
    cmbrendos.List = ["Yes", "No"]
    DiseaseDisplay()
    ActivateRenalDose()

  Else If IconPanel1.Index = 1 Then
    MedicationReview()

  Else If IconPanel1.Index = 2 Then
    cmbdrpenable.List = ["Yes", "No"]
    cmbdrugprob.List = ["Yes", "No"]
    cmballergy.List = ["Yes", "No"]
    cmbrandsubst.List = ["Yes", "No"]
    cmbinjsub.List = ["Enable", "Disable"]
    DisplayGeneral()

  Else If IconPanel1.Index = 3 Then
    cmbqualtext.List = ["Yes", "No"]
    cmbmultisymp.List = ["Yes", "No"]
    cmbexamoption.List = ["Yes", "No"]
    cmbgrouplab.List = ["Group", "Section"]
    cmbgroupradio.List = ["Group", "Section"]
    cmbabnormexam.List = ["Enable", "Disable"]
    ClinGeneralSetting()

  Else If IconPanel1.Index = 4 Then
    cmbgridcateg.List = ["Yes", "No"]
    cmbgrpward.List = ["Separate", "Grouped", "Tabbed"]
    cmbslider.List = ["Enable", "Disable"]
    cmbicdformat.List = ["TreeView", "GridView"]
    cmbdiagnostic.List = ["Enable", "Disable"]
    cmbpastdiagno.List = ["Final Diagnosis", "Provisional Diagnosis", "Nursing Diagnosis", "None"]
    ClinFormSetting()

  Else If IconPanel1.Index = 5 Then

    cmbbodyformat.List = ["Tabular", "Paragraph"]
    cmbshowday.List = ["Date", "User", "Date+User", "None"]
    cmbdiagnoday.List = ["Date", "User", "Date+User", "None"]
    cmbquantchart.List = ["Chart", "FitsrVal", "LastVal", "First-LastVal", "AllValues"]
    cmbqualival.List = ["FitsrVal", "LastVal", "First-LastVal", "AllValues"]
    cmbclinscale.List = ["Summary", "GroupWise"]
    cmbvisithistory.List = ["All Visits", "Last Visit"]

    cmbmedlabel.List = ["Brand", "Generic", "Both"]
    cmbmedicineday.List = ["Yes", "No"]
    cmbdoseformat.List = ["Value", "Label"]
    cmbfreqformat.List = ["Value", "Label"]
    ShowFormatReport()
    MedicineReportSetting()

  Else If IconPanel1.Index = 6 Then
    cmblabelauto.List = ["High Risk", "Low Risk", "All Types"]
    cmblabelregimen.List = ["Yes", "No"]
    cmbprescsource.List = ["LocalDB", "RemoteDB"]
    cmbmedalert.List = ["Patient No", "Patient Code", "Data Repo", "None"]
    cmbphmstatus.List = ["Continue", "Reserve"]
    SHowLabeling()

  Else If IconPanel1.Index = 7 Then
    SMSTextSetting()

  Else If IconPanel1.Index = 8 Then
    cmbmedformul.List = ["Local DB", "Internet"]
    cmbformuldiagno.List = ["Local DB", "Internet"]
    cmbformulpatho.List = ["Local DB", "Internet"]
    cmbdeflab.List = modNonMedical.NonSTockCostingGroupList("Test")
    cmbdefradio.List = modNonMedical.NonSTockCostingGroupList("Radio")
    ShowForulSource()
    ShowDefaultGroup()

  Endif

End

''-------------------------------------- Medication review --------------------------------------------------
Private Sub MedicationReview()

  modSettings.ShowCheckBox(chkagecontra, "MedicationReview/AgeContraindication")
  modSettings.ShowCheckBox(chkallergy, "MedicationReview/DrugAllergy")
  modSettings.ShowCheckBox(chkantibiotic, "MedicationReview/AntibioticResistance")
  modSettings.ShowCheckBox(chkdiseasecontra, "MedicationReview/DiseaseContraindication")
  modSettings.ShowCheckBox(chkdrugintxn, "MedicationReview/DrugInteraction")
  modSettings.ShowCheckBox(chkexamintxn, "MedicationReview/ExaminationInteraction")
  modSettings.ShowCheckBox(chkhepatic, "MedicationReview/HepaticPrecaution")
  modSettings.ShowCheckBox(chkinjincompat, "MedicationReview/InjectionIncompatibility")
  modSettings.ShowCheckBox(chkivfluincompat, "MedicationReview/IVFluidIncompatibility")
  modSettings.ShowCheckBox(chklabintxn, "MedicationReview/LaboratoryInteraction")
  modSettings.ShowCheckBox(chkmaxdaily, "MedicationReview/MaxDailyDose")
  modSettings.ShowCheckBox(chkmaxfreq, "MedicationReview/MaxFrequency")
  modSettings.ShowCheckBox(chkmaxunit, "MedicationReview/MaxUnitDose")
  modSettings.ShowCheckBox(chkmindaily, "MedicationReview/MinDailyDose")
  modSettings.ShowCheckBox(chkpregnancy, "MedicationReview/PregnancyPrecaution")
  modSettings.ShowCheckBox(chkpreservative, "MedicationReview/PreservativePrecaution")
  modSettings.ShowCheckBox(chkPRN, "MedicationReview/PRNRestriction")
  modSettings.ShowCheckBox(chkrenal, "MedicationReview/RenalPrecaution")
  modSettings.ShowCheckBox(chksideeffect, "MedicationReview/SideEffects")
  modSettings.ShowCheckBox(chktabbreak, "MedicationReview/DoseBreak")
  modSettings.ShowCheckBox(chkpremonitor, "MedicationReview/Pre-AdminMonitoring")

End

Public Sub btnmedreport_Click()

  modSettings.EnterCheckSetting(chkagecontra, "MedicationReview/AgeContraindication")
  modSettings.EnterCheckSetting(chkallergy, "MedicationReview/DrugAllergy")
  modSettings.EnterCheckSetting(chkantibiotic, "MedicationReview/AntibioticResistance")
  modSettings.EnterCheckSetting(chkdiseasecontra, "MedicationReview/DiseaseContraindication")
  modSettings.EnterCheckSetting(chkdrugintxn, "MedicationReview/DrugInteraction")
  modSettings.EnterCheckSetting(chkexamintxn, "MedicationReview/ExaminationInteraction")
  modSettings.EnterCheckSetting(chkhepatic, "MedicationReview/HepaticPrecaution")
  modSettings.EnterCheckSetting(chkinjincompat, "MedicationReview/InjectionIncompatibility")
  modSettings.EnterCheckSetting(chkivfluincompat, "MedicationReview/IVFluidIncompatibility")
  modSettings.EnterCheckSetting(chklabintxn, "MedicationReview/LaboratoryInteraction")
  modSettings.EnterCheckSetting(chkmaxdaily, "MedicationReview/MaxDailyDose")
  modSettings.EnterCheckSetting(chkmaxfreq, "MedicationReview/MaxFrequency")
  modSettings.EnterCheckSetting(chkmaxunit, "MedicationReview/MaxUnitDose")
  modSettings.EnterCheckSetting(chkmindaily, "MedicationReview/MinDailyDose")
  modSettings.EnterCheckSetting(chkpregnancy, "MedicationReview/PregnancyPrecaution")
  modSettings.EnterCheckSetting(chkpreservative, "MedicationReview/PreservativePrecaution")
  modSettings.EnterCheckSetting(chkPRN, "MedicationReview/PRNRestriction")
  modSettings.EnterCheckSetting(chkrenal, "MedicationReview/RenalPrecaution")
  modSettings.EnterCheckSetting(chksideeffect, "MedicationReview/SideEffects")
  modSettings.EnterCheckSetting(chktabbreak, "MedicationReview/DoseBreak")
  modSettings.EnterCheckSetting(chkpremonitor, "MedicationReview/Pre-AdminMonitoring")
  modMedError.MedicationReviewSettings()
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub chkall_Click()

  Dim xbool As Boolean

  xbool = chkall.Value
  chkagecontra.Value = xbool
  chkallergy.Value = xbool
  chkantibiotic.Value = xbool
  chkdiseasecontra.Value = xbool
  chkdrugintxn.Value = xbool
  chkexamintxn.Value = xbool
  chkhepatic.Value = xbool
  chkinjincompat.Value = xbool
  chkivfluincompat.Value = xbool
  chklabintxn.Value = xbool
  chkmaxdaily.Value = xbool
  chkmaxfreq.Value = xbool
  chkmaxunit.Value = xbool
  chkmindaily.Value = xbool
  chkpregnancy.Value = xbool
  chkpreservative.Value = xbool
  chkPRN.Value = xbool
  chkrenal.Value = xbool
  chksideeffect.Value = xbool
  chktabbreak.Value = xbool
  chkpremonitor.Value = xbool

End

'''------------------------- Renal dose adjustment ----------------------------------------
Private Sub ActivateRenalDose()

  cmbrendos.Text = modSettings.ShowSettingFromFIle("RenalDoseAdjustment/Activate")
  If modSettings.ShowSettingFromFIle("RenalDoseAdjustment/MaxCrCl") Then
    txtrencrcl.Value = CFloat(modSettings.ShowSettingFromFIle("RenalDoseAdjustment/MaxCrCl"))
  Endif
  If modSettings.ShowSettingFromFIle("RenalDoseAdjustment/MinRenPer") Then
    txtrenper.Value = CFloat(modSettings.ShowSettingFromFIle("RenalDoseAdjustment/MinRenPer"))
  Endif

End

Public Sub btnrendose_Click()

  modSettings.SaveSettingsToFile("RenalDoseAdjustment/Activate", cmbrendos.Text)
  modSettings.SaveSettingsToFile("RenalDoseAdjustment/MaxCrCl", CStr(txtrencrcl.Value))
  modSettings.SaveSettingsToFile("RenalDoseAdjustment/MinRenPer", CStr(txtrenper.Value))
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

'''------------------------------ dose recommendation ---------------------------------------------
Public Sub btnnoregimen_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/DisableDoseRegimen", cmbnoregimen.Text)
  modBasic.$MedNoRegimen = cmbnoregimen.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndosedisease_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/DoseRecommendationByDisease", cmbdosedisease.Text)
  modBasic.$MedDiseaseDose = cmbdosedisease.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Private Sub DiseaseDisplay()

  cmbdosedisease.Text = modSettings.ShowSettingFromFIle("MedicineSetting/DoseRecommendationByDisease")
  cmbdosrecom.Text = modSettings.ShowSettingFromFIle("MedicineSetting/DisplayDoseRecommendation")
  cmbnoregimen.Text = modSettings.ShowSettingFromFIle("MedicineSetting/DisableDoseRegimen")

End

Public Sub btndosrecom_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/DisplayDoseRecommendation", cmbdosrecom.Text)
  modBasic.$MedDoseRecommend = cmbdosrecom.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''================================= Dispensing Label =============================
Private Sub DisplayGeneral()

  cmbdrpenable.Text = modSettings.ShowSettingFromFIle("MedicineSetting/EnableDrugProblems")
  cmbdrugprob.Text = modSettings.ShowSettingFromFIle("MedicineSetting/LogDrugProblems")
  cmballergy.Text = modSettings.ShowSettingFromFIle("MedicineSetting/CheckPreviousSensitivity")
  txtnorevioew.Text = modSettings.ShowSettingFromFIle("MedicineSetting/DisableDrugProblems")

  cmbrandsubst.Text = modSettings.ShowSettingFromFIle("ClinicForms/AllowBrandSubstitution")
  cmbinjsub.Text = modSettings.ShowSettingFromFIle("ClinicForms/ShowInjectionSubRoutes")

End

Public Sub btndrpenable_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/EnableDrugProblems", cmbdrpenable.Text)
  modBasic.$MedErrorEnable = cmbdrpenable.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndrugprob_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/LogDrugProblems", cmbdrugprob.Text)
  modBasic.$MedLogRecommend = cmbdrugprob.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnallergy_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/CheckPreviousSensitivity", cmballergy.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnnoreview_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/DisableDrugProblems", txtnorevioew.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnbrandsubst_Click()

  modSettings.SaveSettingsToFile("ClinicForms/AllowBrandSubstitution", cmbrandsubst.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btninjsub_Click()

  modSettings.SaveSettingsToFile("ClinicForms/ShowInjectionSubRoutes", cmbinjsub.Text)
  modBasic.$ClinInjSubRoutes = cmbinjsub.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''========================= Labeling -----------------------------
Private Sub SHowLabeling()

  cmblabelregimen.Text = modSettings.ShowSettingFromFIle("DispensingLabel/ShowRegimen")
  cmblabelauto.Text = modSettings.ShowSettingFromFIle("DispensingLabel/AutoEnable")

  cmbprescsource.Text = modSettings.ShowSettingFromFIle("Prescription/Source")
  cmbmedalert.Text = modSettings.ShowSettingFromFIle("HistoryAlert/PatientCode")
  cmbphmstatus.Text = modSettings.ShowSettingFromFIle("MedicineRequest/DefaultStatus")

End

Public Sub btnlabelregimen_Click()

  modSettings.SaveSettingsToFile("DispensingLabel/ShowRegimen", cmblabelregimen.Text)
  modBasic.$DispLabelRegimen = cmblabelregimen.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnpressource_Click()

  modSettings.SaveSettingsToFile("Prescription/Source", cmbprescsource.Text)
  modBasic.$DispPrescibeSource = cmbprescsource.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnlabelauto_Click()

  modSettings.SaveSettingsToFile("DispensingLabel/AutoEnable", cmblabelauto.Text)
  modBasic.$DispLabelAutoEnable = cmblabelauto.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnmedalert_Click()

  modSettings.SaveSettingsToFile("HistoryAlert/PatientCode", cmbmedalert.Text)
  modBasic.$SalesHistoryAlert = cmbmedalert.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnphmstatus_Click()

  modSettings.SaveSettingsToFile("MedicineRequest/DefaultStatus", cmbphmstatus.Text)
  modBasic.$DispRequestStatus = cmbphmstatus.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------------formulary -----------------------------------------------
Private Sub ShowForulSource()

  cmbmedformul.Text = modSettings.ShowSettingFromFIle("Formulary/Medicine_Source")
  cmbformulpatho.Text = modSettings.ShowSettingFromFIle("Formulary/Pathology_Source")
  cmbformuldiagno.Text = modSettings.ShowSettingFromFIle("Formulary/Diagnostic_Source")

End

Public Sub btnmedformul_Click()

  modSettings.SaveSettingsToFile("Formulary/Medicine_Source", cmbmedformul.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnformulpatho_Click()

  modSettings.SaveSettingsToFile("Formulary/Pathology_Source", cmbformulpatho.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnformuldiagno_Click()

  modSettings.SaveSettingsToFile("Formulary/Diagnostic_Source", cmbformuldiagno.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------------ Examination & Prescribing------------------------------------------

Private Sub ClinGeneralSetting()

  cmbexamoption.Text = modSettings.ShowSettingFromFIle("ClinicForms/Display_Options")

  cmbqualtext.Text = modSettings.ShowSettingFromFIle("ClinicForms/DisplayTextArea")

  cmbmultisymp.Text = modSettings.ShowSettingFromFIle("ClinicForms/MultipleSymptoms")

  cmbgrouplab.Text = modSettings.ShowSettingFromFIle("ClinicForms/TestGrouping")
  cmbgroupradio.Text = modSettings.ShowSettingFromFIle("ClinicForms/RadioGroupings")
  cmbabnormexam.Text = modSettings.ShowSettingFromFIle("ClinicForms/FlagAbnormalExam")

End

Public Sub btnqualtext_Click()

  modSettings.SaveSettingsToFile("ClinicForms/DisplayTextArea", cmbqualtext.Text)
  modBasic.$DisplayQualiArea = cmbqualtext.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnexamoption_Click()

  modSettings.SaveSettingsToFile("ClinicForms/Display_Options", cmbexamoption.Text)
  modBasic.$DisplayExamOption = cmbexamoption.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnmultisymp_Click()

  modSettings.SaveSettingsToFile("ClinicForms/MultipleSymptoms", cmbmultisymp.Text)
  modBasic.$SelectMultiSymptoms = cmbmultisymp.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btngrouplab_Click()

  modSettings.SaveSettingsToFile("ClinicForms/TestGrouping", cmbgrouplab.Text)
  modBasic.$ClinTestGrouping = cmbgrouplab.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btngroupradio_Click()

  modSettings.SaveSettingsToFile("ClinicForms/RadioGroupings", cmbgroupradio.Text)
  modBasic.$ClinRadioGrouping = cmbgroupradio.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnabnormexam_Click()

  modSettings.SaveSettingsToFile("ClinicForms/FlagAbnormalExam", cmbabnormexam.Text)
  modBasic.$ClinFlagAbnormExam = cmbabnormexam.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''--------------------- forms -----------------
Private Sub ClinFormSetting()

  cmbgridcateg.Text = modSettings.ShowSettingFromFIle("ClinicForms/CategoryGridView")
  cmbgrpward.Text = modSettings.ShowSettingFromFIle("ClinicForms/GroupStructuredExams")
  cmbslider.Text = modSettings.ShowSettingFromFIle("ClinicForms/EnableSliderValue")
  cmbicdformat.Text = modSettings.ShowSettingFromFIle("ClinicForms/ICDEntryFormat")
  cmbdiagnostic.Text = modSettings.ShowSettingFromFIle("ClinicForms/DiagnosticReports")
  cmbpastdiagno.Text = modSettings.ShowSettingFromFIle("ClinicForms/PastDiagnosis")

End

Public Sub btngridcateg_Click()

  modSettings.SaveSettingsToFile("ClinicForms/CategoryGridView", cmbgridcateg.Text)
  modBasic.$ClinCategoryGrid = cmbgridcateg.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btngrpward_Click()

  modSettings.SaveSettingsToFile("ClinicForms/GroupStructuredExams", cmbgrpward.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnslider_Click()

  modSettings.SaveSettingsToFile("ClinicForms/EnableSliderValue", cmbslider.Text)
  modBasic.$ClinSliderValue = cmbslider.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnicdformat_Click()

  modSettings.SaveSettingsToFile("ClinicForms/ICDEntryFormat", cmbicdformat.Text)
  modBasic.$ClinICDPunchFormat = cmbicdformat.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndiagnostic_Click()

  modSettings.SaveSettingsToFile("ClinicForms/DiagnosticReports", cmbdiagnostic.Text)
  modBasic.$CliniDiagnosticReport = cmbdiagnostic.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnpastdiagno_Click()

  modSettings.SaveSettingsToFile("ClinicForms/PastDiagnosis", cmbpastdiagno.Text)
  modBasic.$ClinPastDiagnosis = cmbpastdiagno.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''---------------------------------- medical report ---------------------------------------
Private Sub ShowFormatReport()

  cmbbodyformat.Text = modSettings.ShowSettingFromFIle("ClinicalReport/BodyFormat")
  cmbshowday.Text = modSettings.ShowSettingFromFIle("ClinicalReport/ShowDay_Report")
  cmbdiagnoday.Text = modSettings.ShowSettingFromFIle("ClinicalReport/ShowDiagnosticDay_Report")

  cmbquantchart.Text = modSettings.ShowSettingFromFIle("ClinicalReport/QuantiValue_Format")
  cmbqualival.Text = modSettings.ShowSettingFromFIle("ClinicalReport/QualiValue_Format")
  cmbclinscale.Text = modSettings.ShowSettingFromFIle("ClinicalReport/ScaleValue_Format")
  cmbvisithistory.Text = modSettings.ShowSettingFromFIle("ClinicalReport/HistorySource")

End

Public Sub btnquantchart_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/QuantiValue_Format", cmbquantchart.Text)
  modBasic.$ShowQuantiMedReport = cmbquantchart.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnqualival_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/QualiValue_Format", cmbqualival.Text)
  modBasic.$ShowQualiMedReport = cmbqualival.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnclinscale_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/ScaleValue_Format", cmbclinscale.Text)
  modBasic.$ShowScaleMedFormat = cmbclinscale.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnvisithistory_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/HistorySource", cmbvisithistory.Text)
  modBasic.$ShowHistorySource = cmbvisithistory.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnshowday_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/ShowDay_Report", cmbshowday.Text)
  modBasic.$ShowDayMedReport = cmbshowday.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndiagnoday_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/ShowDiagnosticDay_Report", cmbdiagnoday.Text)
  modBasic.$SHowDayDiagnosticReport = cmbdiagnoday.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnbodyformat_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/BodyFormat", cmbbodyformat.Text)
  modBasic.$MedRepoBody = cmbbodyformat.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------------ Medicine ------------------
Private Sub MedicineReportSetting()

  cmbmedlabel.Text = modSettings.ShowSettingFromFIle("ClinicalReport/MedicineName_Format")
  cmbmedicineday.Text = modSettings.ShowSettingFromFIle("ClinicalReport/ShowMedicineStartDate_Report")
  cmbdoseformat.Text = modSettings.ShowSettingFromFIle("ClinicalReport/MedicineDose_Format")
  cmbfreqformat.Text = modSettings.ShowSettingFromFIle("ClinicalReport/MedicineFrequency_Format")

End

Public Sub btnmedlabel_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/MedicineName_Format", cmbmedlabel.Text)
  modBasic.$MedicineNameFormat = cmbmedlabel.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnmedicineday_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/ShowMedicineStartDate_Report", cmbmedicineday.Text)
  modBasic.$ShowDayMesStartReport = cmbmedicineday.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndoseformat_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/MedicineDose_Format", cmbdoseformat.Text)
  modBasic.$MedicineDoseFormat = cmbdoseformat.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnfreqformat_Click()

  modSettings.SaveSettingsToFile("ClinicalReport/MedicineFrequency_Format", cmbfreqformat.Text)
  modBasic.$MedicineFrequencyFormat = cmbfreqformat.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------ SMS ----------------------
Public Sub btnsavesmsphy_Click()

  modSettings.SaveSettingsToFile("InpatientSMS/PhysicianSMSText", txtsmsphy.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Private Sub SMSTextSetting()

  txtsmsphy.Text = modSettings.ShowSettingFromFIle("InpatientSMS/PhysicianSMSText")

End

''-------------------------------------------- Default values -------------------------------------------
Private Sub ShowDefaultGroup()

  cmbdeflab.Text = modSettings.ShowSettingFromFIle("ClinicForms/Default_TestGroup")
  cmbdefradio.Text = modSettings.ShowSettingFromFIle("ClinicForms/Default_RadioGroup")
  txtmedadvice.Text = modSettings.ShowSettingFromFIle("PharmacyForm/AdviceList")

End

Public Sub btndeflab_Click()

  modSettings.SaveSettingsToFile("ClinicForms/Default_TestGroup", cmbdeflab.Text)
  modBasic.$DefaultTestList = cmbdeflab.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndefradio_Click()

  modSettings.SaveSettingsToFile("ClinicForms/Default_RadioGroup", cmbdefradio.Text)
  modBasic.$DefaultRadioList = cmbdefradio.Text
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnmedadvice_Click()

  modSettings.SaveSettingsToFile("PharmacyForm/AdviceList", txtmedadvice.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''---------------- Buttons ---------------------------
Public Sub WebButtonL1_Click()

  GetNormalButtons()
  IconPanel1.Index = 0
  WebButtonL1.Background = Color.LightGray

End

Public Sub WebButtonL2_Click()

  GetNormalButtons()
  IconPanel1.Index = 1
  WebButtonL2.Background = Color.LightGray

End

Public Sub WebButtonL3_Click()

  GetNormalButtons()
  IconPanel1.Index = 2
  WebButtonL3.Background = Color.LightGray

End

Public Sub WebButtonL4_Click()

  GetNormalButtons()
  IconPanel1.Index = 3
  WebButtonL4.Background = Color.LightGray

End

Public Sub WebButtonL5_Click()

  GetNormalButtons()
  IconPanel1.Index = 4
  WebButtonL5.Background = Color.LightGray

End

Public Sub WebButtonL6_Click()

  GetNormalButtons()
  IconPanel1.Index = 5
  WebButtonL6.Background = Color.LightGray

End

Public Sub WebButtonL7_Click()

  GetNormalButtons()
  IconPanel1.Index = 6
  WebButtonL7.Background = Color.LightGray

End

Public Sub WebButtonL8_Click()

  GetNormalButtons()
  IconPanel1.Index = 7
  WebButtonL8.Background = Color.LightGray

End

Public Sub WebButtonL9_Click()

  GetNormalButtons()
  IconPanel1.Index = 8
  WebButtonL9.Background = Color.LightGray

End

Private Sub GetNormalButtons()

  WebButtonL1.Background = Color.Default
  WebButtonL2.Background = Color.Default
  WebButtonL3.Background = Color.Default
  WebButtonL4.Background = Color.Default
  WebButtonL5.Background = Color.Default
  WebButtonL6.Background = Color.Default
  WebButtonL7.Background = Color.Default
  WebButtonL8.Background = Color.Default
  WebButtonL9.Background = Color.Default

End

Public Sub btnclose_Click()

  Me.Close()

End
