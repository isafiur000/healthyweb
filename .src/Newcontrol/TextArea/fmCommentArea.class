' Gambas class file

Private $sDefault As String
Private $sValue As String

Public Sub Run(Optional sTitle As String, Optional sDefault As String) As String

  txttitle.Text = "<b>" & sTitle & "</b>"
  If sDefault Then
    $sDefault = sDefault
    TextArea1.Text = sDefault
  Endif
  modGeneralMain.GetOpenModalForm(Me)

  If modBasic.$TabletModeEnable = "Yes" Then
  Else
    TextArea1.SetFocus
  Endif

  If Me.ShowModal() Then Return $sValue

End

Public Sub btnok_Click()

  If chkreport.Value = True Then
    $sValue = TextArea1.Text & gb.NewLine & "[Report Required]"
  Else
    $sValue = TextArea1.Text
  Endif
  Me.Close(True)

End

Public Sub btnclose_Click()

  Me.Close()

End
