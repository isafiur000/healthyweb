' Gambas class file

Private $BillingReport As CReportHTML

Public Sub _new()

  Dim xlist As String[]

  cmbtarget.List = modBasic.$AllCompList
  cmbtarget.Text = modBasic.$compID

  cmbfixbill.List = ["Credit", "Cash", "None"]
  cmblockmode.List = ["Yes", "No"]
  cmbrounding.List = ["Yes", "No"]
  cmbextrabill.List = ["Print", "Print+Print", "Save", "Print+Save", "None"]
  cmbverifyret.List = ["Enable", "Disable"]
  cmbsavpayble.List = ["Yes", "No"]
  cmbnulledger.List = ["Yes", "No"]

  cmbdisctype.List = ["Encounter", "Department", "FixedValue"]
  cmbdisc.List = ["Yes", "No"]
  cmbdiscsave.List = ["Yes", "No"]
  cmbsumdisc.List = ["Yes", "No"]
  cmbsubsidy.List = ["Enable", "Disable"]

  cmbtaxtype.List = ["ItemWise", "FixedValue"]
  cmbtax.List = ["Yes", "No"]
  cmbtaxsave.List = ["Yes", "No"]
  cmbsumtax.List = ["Yes", "No"]

  cmbdefmode.List = modNonMedical.FillCashModeCombo()
  cmbfixmode.List = ["Yes", "No"]
  cmbeditrate.List = ["Yes", "No"]
  cmbeditratesave.List = ["Yes", "No"]

  cmbpackage.List = ["Encounter", "Scheduled", "Department", "Fixed"]
  cmbfixpackage.List = modNonMedical.FillDiscountCombo()
  cmbeditpackage.List = ["Yes", "Partial", "No"]
  cmbpackagenew.List = ["Yes", "Partial", "No"]
  xlist = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select distinct(fldpackgroup) as col from tblpackgroup"))
  cmbcashpack.List = xlist
  cmbfullpack.List = xlist

  cmbalterpharm.List = ["Yes", "No"]
  cmbmedicinestock.List = modBasic.$AllCompList
  cmbsurgistock.List = modBasic.$AllCompList
  cmbsuturestock.List = modBasic.$AllCompList
  cmborthostock.List = modBasic.$AllCompList
  cmbextrastock.List = modBasic.$AllCompList
  cmblabelgeneric.List = modBasic.$AllCompList
  cmblabelbrand.List = modBasic.$AllCompList

  cmbcasbill.List = ["All", "Yes", "No"]
  cmbcasretn.List = ["All", "Yes", "No"]
  cmbdeposit.List = ["Yes", "No"]
  cmbphmsale.List = ["OPD", "All", "None"]
  cmbphmret.List = ["OPD", "All", "None"]
  cmbdischarge.List = ["Separate", "Mixed"]
  cmbautolock.List = ["Enable", "Disable"]

  cmbhandinvoice.List = ["Enable", "Disable", "Free"]
  cmbhandsubmit.List = ["Enable", "Disable", "Free"]
  cmbzerosubmit.List = ["Enable", "Disable"]
  cmbhandothercash.List = ["Enable", "Disable"]

  cmbinvoiceprint.List = ["Immediate", "Later"]
  cmbreprint.List = ["Original", "Aggregate"]
  cmbsumreport.List = ["Visible", "Hidden"]
  cmblockcategory.List = ["Diagnostic Tests", "General Services", "Procedures", "Equipment", "Radio Diagnostics", "Other Items", "Medicines", "Surgicals", "Extra Items", "%"]
  cmbsepbill.List = ["Yes", "No"]
  cmbtwostep.List = ["Yes", "No"]
  cmbinvoreturn.List = ["Yes", "No"]
  cmbpastyear.List = ["Enable", "Disable"]

  cmbgroupentry.List = ["Yes", "No"]
  cmbduplicate.List = ["Inform", "Warn", "Disable", "None"]
  cmbfixedrate.List = ["Generic", "Brand"]
  cmbautoretn.List = ["Yes", "No"]
  cmbbedcharge.List = ["Force", "Auto", "Free"]
  cmbdiagnosis.List = ["Force", "ForceAll", "Yes", "No"]
  cmblockdiagno.List = ["Yes", "No"]
  cmbcashformat.List = ["Enable", "Disable"]
  cmblowdeposit.List = ["Warn", "Disable", "None"]
  cmbfraction.List = ["Enable", "Disable"]
  cmbexpired.List = ["Enable", "Disable"]

  cmbcatequip.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldsection as col from tblbillsection where fldcateg=&1", "Equipment"))
  cmbcatequip.Add("%")
  cmbcatgeneral.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldsection as col from tblbillsection where fldcateg=&1", "General Services"))                            ''
  cmbcatgeneral.Add("%")
  cmbcatlab.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldsection as col from tblbillsection where fldcateg=&1", "Diagnostic Tests"))
  cmbcatlab.Add("%")
  cmbcatother.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldsection as col from tblbillsection where fldcateg=&1", "Other Items"))
  cmbcatother.Add("%")
  cmbcatproc.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldsection as col from tblbillsection where fldcateg=&1", "Procedures"))
  cmbcatproc.Add("%")
  cmbcatradio.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldsection as col from tblbillsection where fldcateg=&1", "Radio Diagnostics"))
  cmbcatradio.Add("%")

  cmbformlock.List = ["Yes", "No"]
  cmbadmitlock.List = ["Yes", "No"]
  ' cmbrestown.List = ["Yes", "Partial", "No"]
  cmbownout.List = ["Yes", "Partial", "No"]
  cmbownindoor.List = ["Yes", "Partial", "No"]
  cmbadmitcash.List = ["Both", "Credit", "RefOnly", "No"]
  cmnadmitrecep.List = ["Both", "Credit", "RefOnly", "No"]
  cmbdepolock.List = ["Enable", "Disable"]
  cmbpharmorigin.List = modBasic.$AllCompPerList

  cmbsharecalc.List = ["Mixed", "Groups"]
  cmbsharetds.List = ["User", "Item"]
  cmbmanpayverify.List = ["Enable", "Disable"]
  cmbautopayverify.List = ["Enable", "Disable"]
  cmbgroupsource.List = ["All Billed", "Accepted"]
  cmbcategorypay.List = ["Complete", "Restricted"]

  cmbreturnentry.List = ["Enable", "Disable"]
  cmbreturnpharm.List = ["Enable", "Disable"]
  cmbretnencid.List = ["Yes", "No"]
  cmbretclear.List = ["Enable", "Disable"]
  cmbadmitdepo.List = ["Immediate", "NextDay", "None"]
  cmbdischreturn.List = ["Enable", "Disable"]

End

Public Sub btnshowsetting_Click()

  IconPanel1.Enabled = True

  ShowGeneralOPCash()
  ShowCashBill()
  ShowRateSetting()
  UpdateAllowSaved()
  ShowBillOption()
  ShowBillGroup()
  SHowPharmacyStock()
  InvPrintSetting()
  ShowBillEntry()
  BillingRestrictions()
  SetSharingRules()
  SetReturnAccess()

End

Public Sub cmbtarget_Click()

  lblcomp.Text = modGeneral.GetCompNameFromCompID(cmbtarget.Text)

End

''XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXx
Private Sub ShowCashBill()

  Dim xtaxval As String
  Dim xdiscval As String

  cmbtax.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixTax", cmbtarget.Text)
  cmbdisc.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixDisc", cmbtarget.Text)

  cmbtaxsave.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixTaxSaved", cmbtarget.Text)
  cmbdiscsave.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixDiscSaved", cmbtarget.Text)

  cmbsumtax.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixSumTax", cmbtarget.Text)
  cmbsumdisc.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixSumDisc", cmbtarget.Text)

  xtaxval = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixedTaxValue", cmbtarget.Text)
  If xtaxval Then
    txtfixtax.Value = CFloat(xtaxval)
  Else
    txtfixtax.Value = 0
  Endif
  xdiscval = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixedDiscValue", cmbtarget.Text)
  If xdiscval Then
    txtfixdiscount.Value = CFloat(xdiscval)
  Else
    txtfixdiscount.Value = 0
  Endif

  cmbdisctype.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DiscMode", cmbtarget.Text)
  cmbtaxtype.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TaxMode", cmbtarget.Text)

  cmbsubsidy.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/SubsidyMode", cmbtarget.Text)

End

Public Sub btncasbill_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/FixTax", cmbtax.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("CashBilling/FixDisc", cmbdisc.Text, cmbtarget.Text)

  modGlobalSetting.SaveSettingToDB("CashBilling/FixTaxSaved", cmbtaxsave.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("CashBilling/FixDiscSaved", cmbdiscsave.Text, cmbtarget.Text)

  modGlobalSetting.SaveSettingToDB("CashBilling/FixSumTax", cmbsumtax.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("CashBilling/FixSumDisc", cmbsumdisc.Text, cmbtarget.Text)

  modGlobalSetting.SaveSettingToDB("CashBilling/FixedTaxValue", CStr(txtfixtax.Value), cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("CashBilling/FixedDiscValue", CStr(txtfixdiscount.Value), cmbtarget.Text)

  modGlobalSetting.SaveSettingToDB("CashBilling/DiscMode", cmbdisctype.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("CashBilling/TaxMode", cmbtaxtype.Text, cmbtarget.Text)

  modGlobalSetting.SaveSettingToDB("CashBilling/SubsidyMode", cmbsubsidy.Text, cmbtarget.Text)

  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Private Sub ShowBillOption()

  cmbphmsale.Text = modGlobalSetting.ShowSettingFromDBAny("BillingOption/PharmacySales", cmbtarget.Text)
  cmbphmret.Text = modGlobalSetting.ShowSettingFromDBAny("BillingOption/PharmacyReturn", cmbtarget.Text)
  cmbcasbill.Text = modGlobalSetting.ShowSettingFromDBAny("BillingOption/CashierBilling", cmbtarget.Text)
  cmbcasretn.Text = modGlobalSetting.ShowSettingFromDBAny("BillingOption/CashierReturn", cmbtarget.Text)
  cmbdeposit.Text = modGlobalSetting.ShowSettingFromDBAny("BillingOption/DepositBilling", cmbtarget.Text)

  cmbdischarge.Text = modGlobalSetting.ShowSettingFromDBAny("BillingOption/DischargeBilling", cmbtarget.Text)
  cmbautolock.Text = modGlobalSetting.ShowSettingFromDBAny("BillingOption/DischargeAutoLock", cmbtarget.Text)

  cmbhandinvoice.Text = modGlobalSetting.ShowSettingFromDBAny("CashHandover/LockInvoice", cmbtarget.Text)
  cmbhandsubmit.Text = modGlobalSetting.ShowSettingFromDBAny("CashHandover/LockSubmission", cmbtarget.Text)
  cmbzerosubmit.Text = modGlobalSetting.ShowSettingFromDBAny("CashHandover/ZeroSubmission", cmbtarget.Text)
  cmbhandothercash.Text = modGlobalSetting.ShowSettingFromDBAny("CashHandover/OtherCash", cmbtarget.Text)

End

Public Sub btnbillav_Click()

  modGlobalSetting.SaveSettingToDB("BillingOption/PharmacySales", cmbphmsale.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("BillingOption/PharmacyReturn", cmbphmret.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("BillingOption/CashierBilling", cmbcasbill.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("BillingOption/CashierReturn", cmbcasretn.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("BillingOption/DepositBilling", cmbdeposit.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndischarge_Click()

  modGlobalSetting.SaveSettingToDB("BillingOption/DischargeBilling", cmbdischarge.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnautolock_Click()

  modGlobalSetting.SaveSettingToDB("BillingOption/DischargeAutoLock", cmbautolock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnhandinvoice_Click()

  modGlobalSetting.SaveSettingToDB("CashHandover/LockInvoice", cmbhandinvoice.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnhandsubmit_Click()

  modGlobalSetting.SaveSettingToDB("CashHandover/LockSubmission", cmbhandsubmit.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnzerosubmit_Click()

  modGlobalSetting.SaveSettingToDB("CashHandover/ZeroSubmission", cmbzerosubmit.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnhandothercash_Click()

  modGlobalSetting.SaveSettingToDB("CashHandover/OtherCash", cmbhandothercash.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------------------ Billing restrictions -------------------------------
Private Sub BillingRestrictions()

  cmbformlock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/LockToOwnEntry", cmbtarget.Text)
  ' cmbrestown.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/RestrictToOwnItems", cmbtarget.Text)
  cmbownout.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/RestrictToOwn_OutPatients", cmbtarget.Text)
  cmbownindoor.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/RestrictToOwn_Inpatients", cmbtarget.Text)

  cmbadmitlock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/LockAdmitted", cmbtarget.Text)
  cmbadmitcash.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DisableIPCreditInvoice", cmbtarget.Text)
  cmnadmitrecep.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DisableIPCreditReceipt", cmbtarget.Text)
  cmbdepolock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/AdmissionDeposit", cmbtarget.Text)
  cmbpharmorigin.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/PharmacyOrigin", cmbtarget.Text)

End

Public Sub btnformlock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/LockToOwnEntry", cmbformlock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnadmitlock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/LockAdmitted", cmbadmitlock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

' Public Sub btnrestown_Click()
'
'   modGlobalSetting.SaveSettingToDB("CashBilling/RestrictToOwnItems", cmbrestown.Text, cmbtarget.Text)
'   Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))
'
' End

Public Sub btnownout_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/RestrictToOwn_OutPatients", cmbownout.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnownindoor_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/RestrictToOwn_Inpatients", cmbownindoor.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnadmitcash_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/DisableIPCreditInvoice", cmbadmitcash.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnadmitrecep_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/DisableIPCreditReceipt", cmnadmitrecep.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndepolock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/AdmissionDeposit", cmbdepolock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnpharmorigin_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/PharmacyOrigin", cmbpharmorigin.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''-----------------------------Rate Plan--------------------------------------------------------------
Public Sub btnbilmode_Click()

  modGlobalSetting.SaveSettingToDB("BillingGroup/DefaultMode", cmbdefmode.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("BillingGroup/FixMode", cmbfixmode.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Private Sub ShowBillGroup()

  cmbdefmode.Text = modGlobalSetting.ShowSettingFromDBAny("BillingGroup/DefaultMode", cmbtarget.Text)
  cmbfixmode.Text = modGlobalSetting.ShowSettingFromDBAny("BillingGroup/FixMode", cmbtarget.Text)

End

''--------------------------------- Rate------------------------------------
Private Sub ShowRateSetting()

  cmbeditrate.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/EditRate", cmbtarget.Text)
  cmbeditratesave.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/EditRateSaved", cmbtarget.Text)

End

Public Sub btneditrate_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/EditRate", cmbeditrate.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("CashBilling/EditRateSaved", cmbeditratesave.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''-------------------------------- Saved items --------------------------------
Private Sub UpdateAllowSaved()

  cmbpackage.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/SchedulePackage", cmbtarget.Text)
  cmbfixpackage.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixedPackage", cmbtarget.Text)
  cmbpackagenew.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/AlterPackage", cmbtarget.Text)
  cmbeditpackage.Text = modGlobalSetting.ShowSettingFromDBAny("SavedBillingEntry/EditPackageSaved", cmbtarget.Text)
  cmbcashpack.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DefaultPackage", cmbtarget.Text)
  cmbfullpack.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DefaultFullPackage", cmbtarget.Text)

End

Public Sub btnpackageset_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/SchedulePackage", cmbpackage.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnfixpackage_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/FixedPackage", cmbfixpackage.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnpackagenew_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/AlterPackage", cmbpackagenew.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btneditpackage_Click()

  modGlobalSetting.SaveSettingToDB("SavedBillingEntry/EditPackageSaved", cmbeditpackage.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncashpack_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/DefaultPackage", cmbcashpack.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnfullpack_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/DefaultFullPackage", cmbfullpack.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndiscgroup_Click()

  Dim hForm As FmAddVarTwo
  Dim xx As String[]
  Dim yy As String[]

  xx = New String[]
  yy = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldtype from tbldiscount where fldbilltype=&1 and fldreserved IS &2", "Cash", Null))
  hForm = New FmAddVarTwo("fldpackgroup", "fldpackage", "tblpackgroup", xx, yy)
  hForm.ShowModal
  cmbcashpack.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select distinct(fldpackgroup) as col from tblpackgroup"))

End

Public Sub btndiscfullgroup_Click()

  Dim hForm As FmAddVarTwo
  Dim xx As String[]
  Dim yy As String[]

  xx = New String[]
  yy = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select fldtype from tbldiscount where fldreserved IS &1", Null))
  hForm = New FmAddVarTwo("fldpackgroup", "fldpackage", "tblpackgroup", xx, yy)
  hForm.ShowModal
  cmbfullpack.List = modControlSub.GetDirectFillresult(modDatabase.$myConn.Exec("select distinct(fldpackgroup) as col from tblpackgroup"))

End

''-------------------------------------- General Setting ----------------------------
Private Sub ShowGeneralOPCash()

  txtdollar.Text = modGlobalSetting.ShowSettingFromDBAny("Currency/HundredUnit", cmbtarget.Text)
  txtpenny.Text = modGlobalSetting.ShowSettingFromDBAny("Currency/Unit", cmbtarget.Text)

  cmbrounding.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/AmountRounding", cmbtarget.Text)
  cmbextrabill.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/InvoiceExtraCopy", cmbtarget.Text)
  cmbfixbill.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixBilling", cmbtarget.Text)
  cmblockmode.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/LockBilling", cmbtarget.Text)
  cmbverifyret.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/VerifyReturn", cmbtarget.Text)
  cmbsavpayble.Text = modGlobalSetting.ShowSettingFromDBAny("SavedBillingEntry/EditPayable", cmbtarget.Text)

  cmbnulledger.Text = modGlobalSetting.ShowSettingFromDBAny("BillingReport/ShowNullLedger", cmbtarget.Text)

End

Public Sub btnunitset_Click()

  modGlobalSetting.SaveSettingToDB("Currency/HundredUnit", Trim(txtdollar.Text), cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("Currency/Unit", Trim(txtpenny.Text), cmbtarget.Text)
  modBasic.$currency = modString.GetCurrency()
  modBasic.$centUnit = modString.GetCentUnit()
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnrounding_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/AmountRounding", cmbrounding.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnextrabill_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/InvoiceExtraCopy", cmbextrabill.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnfixbill_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/FixBilling", cmbfixbill.Text, cmbtarget.Text)
  modGlobalSetting.SaveSettingToDB("CashBilling/LockBilling", cmblockmode.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnverifyret_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/VerifyReturn", cmbverifyret.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnsaventry_Click()

  modGlobalSetting.SaveSettingToDB("SavedBillingEntry/EditPayable", cmbsavpayble.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnnulledger_Click()

  modGlobalSetting.SaveSettingToDB("BillingReport/ShowNullLedger", cmbnulledger.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------------------ Invoice Print ---------------------------
Private Sub InvPrintSetting()

  cmbinvoiceprint.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/BillPrintTime", cmbtarget.Text)
  cmbreprint.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/InvoiceReprintFormat", cmbtarget.Text)
  cmbsumreport.Text = modGlobalSetting.ShowSettingFromDBAny("BillingReport/SummaryPanel", cmbtarget.Text)
  cmblockcategory.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixReceiptCategory", cmbtarget.Text)
  cmbsepbill.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/SeparateReturns", cmbtarget.Text)
  cmbtwostep.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TwoStepBilling", cmbtarget.Text)
  cmbinvoreturn.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/InvoiceWiseReturn", cmbtarget.Text)
  cmbpastyear.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/PastInvoices", cmbtarget.Text)

End

Public Sub btninvoiceprint_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/BillPrintTime", cmbinvoiceprint.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnreprint_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/InvoiceReprintFormat", cmbreprint.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnsumreport_Click()

  modGlobalSetting.SaveSettingToDB("BillingReport/SummaryPanel", cmbsumreport.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnlockcategory_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/FixReceiptCategory", cmblockcategory.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnsepbill_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/SeparateReturns", cmbsepbill.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btntwostep_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TwoStepBilling", cmbtwostep.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btninvoreturn_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/InvoiceWiseReturn", cmbinvoreturn.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnpastyear_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/PastInvoices", cmbpastyear.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''--------------------------------- Pharmacy stock ------------------------
Private Sub SHowPharmacyStock()

  cmbalterpharm.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/AlterPharmacyStock", cmbtarget.Text)
  cmbmedicinestock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TargetPharmacyStock", cmbtarget.Text)
  cmbsurgistock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TargetSurgicalStock", cmbtarget.Text)
  cmbsuturestock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TargetSutureStock", cmbtarget.Text)
  cmborthostock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TargetOrthopedicStock", cmbtarget.Text)
  cmbextrastock.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TargetExtraItemStock", cmbtarget.Text)

  cmblabelgeneric.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TargetGenericLabel", cmbtarget.Text)
  cmblabelbrand.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/TargetBrandLabel", cmbtarget.Text)

End

Public Sub btnalterpharm_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/AlterPharmacyStock", cmbalterpharm.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnpharmstock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TargetPharmacyStock", cmbmedicinestock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnsurgistock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TargetSurgicalStock", cmbsurgistock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnsuturestock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TargetSutureStock", cmbsuturestock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnorthostock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TargetOrthopedicStock", cmborthostock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnextrastock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TargetExtraItemStock", cmbextrastock.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnlabelgeneric_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TargetGenericLabel", cmblabelgeneric.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnlabelbrand_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/TargetBrandLabel", cmblabelbrand.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------------------------ Billing Entry ---------------------------------------
Private Sub ShowBillEntry()

  Dim xpunch As String

  cmbgroupentry.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/GroupPunchingItems", cmbtarget.Text)
  cmbduplicate.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DuplicateEntry", cmbtarget.Text)
  cmbfixedrate.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FixedRateSale", cmbtarget.Text)
  cmbautoretn.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/AutoReturn", cmbtarget.Text)
  cmbbedcharge.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/BedCharges", cmbtarget.Text)
  cmbdiagnosis.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/AddDiagnosis", cmbtarget.Text)
  cmblockdiagno.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/LockDiagnosis", cmbtarget.Text)
  cmbcashformat.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/CashRecording", cmbtarget.Text)
  cmblowdeposit.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/LowDeposit", cmbtarget.Text)
  cmbfraction.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/FractionQuantity", cmbtarget.Text)
  cmbexpired.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/ExpiredPunching", cmbtarget.Text)

  xpunch = modGlobalSetting.ShowSettingFromDBAny("CashBilling/LockPunchingAfter", cmbtarget.Text)
  If xpunch Then
    txtpunchlock.Value = CInt(xpunch)
  Else
    txtpunchlock.Value = 0
  Endif

  cmbcatgeneral.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/Section_Service", cmbtarget.Text)
  cmbcatequip.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/Section_Equipment", cmbtarget.Text)
  cmbcatradio.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/Section_Radio", cmbtarget.Text)
  cmbcatlab.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/Section_Test", cmbtarget.Text)
  cmbcatproc.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/Section_Procedure", cmbtarget.Text)
  cmbcatother.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/Section_Others", cmbtarget.Text)
  cmbcatall.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/Section_AllItems", cmbtarget.Text)

End

Public Sub btngroupentry_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/GroupPunchingItems", cmbgroupentry.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnduplicate_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/DuplicateEntry", cmbduplicate.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndupliexcept_Click()

  Dim xType As String
  Dim hForm As FmSettingList

  xType = "CashBilling/DuplicateEntry"
  hForm = New FmSettingList("Duplication Allowed Items", "Service List", xType, cmbtarget.Text)
  hForm.ShowModal

End

Public Sub btnautoretn_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/AutoReturn", cmbautoretn.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnfixedrate_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/FixedRateSale", cmbfixedrate.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnbedcharge_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/BedCharges", cmbbedcharge.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndiagnosis_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/AddDiagnosis", cmbdiagnosis.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnlockdiagno_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/LockDiagnosis", cmblockdiagno.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncashformat_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/CashRecording", cmbcashformat.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnlowdeposit_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/LowDeposit", cmblowdeposit.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnfraction_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/FractionQuantity", cmbfraction.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnexpired_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/ExpiredPunching", cmbexpired.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnpunchlock_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/LockPunchingAfter", CStr(txtpunchlock.Value), cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''Section for billing
Public Sub btncatservice_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/Section_Service", cmbcatgeneral.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncatequip_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/Section_Equipment", cmbcatequip.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncatradio_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/Section_Radio", cmbcatradio.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncatlab_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/Section_Test", cmbcatlab.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncatproc_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/Section_Procedure", cmbcatproc.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncatother_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/Section_Others", cmbcatother.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncatall_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/Section_AllItems", cmbcatall.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''--------------------- Sharing Rules ----------------
Private Sub SetSharingRules()

  cmbsharecalc.Text = modGlobalSetting.ShowSettingFromDBAny("PayableCalculation/Formula", cmbtarget.Text)
  cmbsharetds.Text = modGlobalSetting.ShowSettingFromDBAny("PayableCalculation/TDSMode", cmbtarget.Text)

  cmbmanpayverify.Text = modGlobalSetting.ShowSettingFromDBAny("PayableVerification/Manual", cmbtarget.Text)
  cmbautopayverify.Text = modGlobalSetting.ShowSettingFromDBAny("PayableVerification/Setting", cmbtarget.Text)
  cmbgroupsource.Text = modGlobalSetting.ShowSettingFromDBAny("PayableDataSource/Group", cmbtarget.Text)

  modGlobalSetting.ShowCheckBoxFromDBAny(chkshareradio, "ShareEntryAccess/Radiology", cmbtarget.Text)
  modGlobalSetting.ShowCheckBoxFromDBAny(chkshareproc, "ShareEntryAccess/Procedure", cmbtarget.Text)

  cmbcategorypay.Text = modGlobalSetting.ShowSettingFromDBAny("PayableUsers/Format", cmbtarget.Text)

End

Public Sub btnmanpayverify_Click()

  modGlobalSetting.SaveSettingToDB("PayableVerification/Manual", cmbmanpayverify.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnautopayverify_Click()

  modGlobalSetting.SaveSettingToDB("PayableVerification/Setting", cmbautopayverify.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btngroupsource_Click()

  modGlobalSetting.SaveSettingToDB("PayableDataSource/Group", cmbgroupsource.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnsharecalc_Click()

  modGlobalSetting.SaveSettingToDB("PayableCalculation/Formula", cmbsharecalc.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnsharetds_Click()

  modGlobalSetting.SaveSettingToDB("PayableCalculation/TDSMode", cmbsharetds.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnshareentry_Click()

  modGlobalSetting.EnterSettingFromDB(chkshareradio, "ShareEntryAccess/Radiology", cmbtarget.Text)
  modGlobalSetting.EnterSettingFromDB(chkshareproc, "ShareEntryAccess/Procedure", cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btncategorypay_Click()

  modGlobalSetting.SaveSettingToDB("PayableUsers/Format", cmbcategorypay.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''-------------------- Return access -----------------
Private Sub SetReturnAccess()

  cmbreturnentry.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/ServiceReturnPunching", cmbtarget.Text)
  cmbreturnpharm.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/PharmacyReturnPunching", cmbtarget.Text)
  cmbretnencid.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/ReturnByEncID", cmbtarget.Text)
  cmbretclear.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/ReturnDueClearance", cmbtarget.Text)
  cmbadmitdepo.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DisableIPDepositReturn", cmbtarget.Text)
  cmbdischreturn.Text = modGlobalSetting.ShowSettingFromDBAny("CashBilling/DischargeReturnSeparate", cmbtarget.Text)

End

Public Sub btnreturnentry_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/ServiceReturnPunching", cmbreturnentry.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnreturnpharm_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/PharmacyReturnPunching", cmbreturnpharm.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnretnencid_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/ReturnByEncID", cmbretnencid.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnretclear_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/ReturnDueClearance", cmbretclear.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btnadmitdepo_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/DisableIPDepositReturn", cmbadmitdepo.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

Public Sub btndischreturn_Click()

  modGlobalSetting.SaveSettingToDB("CashBilling/DischargeReturnSeparate", cmbdischreturn.Text, cmbtarget.Text)
  Me.Exec(Subst("Toastify({text: '&1', duration: &2}).showToast()", "Information saved", modBasic.$BalloonDelay))

End

''------------------------- List -----------------------------
Public Sub btnsettall_Click()

  Dim xList As String[]
  Dim xPath As String

  xList = New String[]
  xList.Add("Currency/HundredUnit")
  xList.Add("Currency/Unit")
  xList.Add("CashBilling/AmountRounding")
  xList.Add("CashBilling/FixBilling")
  xList.Add("CashBilling/InvoiceExtraCopy")

  xList.Add("CashBilling/VerifyReturn")
  xList.Add("SavedBillingEntry/EditPayable")
  xList.Add("BillingReport/ShowNullLedger")

  xList.Add("CashBilling/FixTax")
  xList.Add("CashBilling/FixDisc")
  xList.Add("CashBilling/FixTaxSaved")
  xList.Add("CashBilling/FixDiscSaved")
  xList.Add("CashBilling/FixSumTax")
  xList.Add("CashBilling/FixSumDisc")
  xList.Add("CashBilling/FixedTaxValue")
  xList.Add("CashBilling/FixedDiscValue")
  xList.Add("CashBilling/DiscMode")
  xList.Add("CashBilling/TaxMode")
  xList.Add("CashBilling/SubsidyMode")

  xList.Add("BillingGroup/DefaultMode")
  xList.Add("BillingGroup/FixMode")
  xList.Add("CashBilling/EditRate")
  xList.Add("CashBilling/EditRateSaved")
  xList.Add("CashBilling/DefaultPackage")
  xList.Add("CashBilling/DefaultFullPackage")

  xList.Add("CashBilling/SchedulePackage")
  xList.Add("CashBilling/AlterPackage")
  xList.Add("SavedBillingEntry/EditPackageSaved")

  xList.Add("BillingOption/PharmacySales")
  xList.Add("BillingOption/PharmacyReturn")
  xList.Add("BillingOption/CashierBilling")
  xList.Add("BillingOption/CashierReturn")
  xList.Add("BillingOption/DepositBilling")
  xList.Add("BillingOption/DischargeBilling")
  xList.Add("BillingOption/DischargeAutoLock")

  xList.Add("CashHandover/LockInvoice")
  xList.Add("CashHandover/LockSubmission")
  xList.Add("CashHandover/ZeroSubmission")
  xList.Add("CashHandover/OtherCash")

  xList.Add("CashBilling/LockToOwnEntry")
  xList.Add("CashBilling/LockAdmitted")
  ' xList.Add("CashBilling/RestrictToOwnItems")
  xList.Add("CashBilling/RestrictToOwn_OutPatients")
  xList.Add("CashBilling/RestrictToOwn_Inpatients")
  xList.Add("CashBilling/DisableIPCreditInvoice")
  xList.Add("CashBilling/DisableIPCreditReceipt")
  xList.Add("CashBilling/AdmissionDeposit")
  xList.Add("CashBilling/PharmacyOrigin")

  xList.Add("CashBilling/BillPrintTime")
  xList.Add("CashBilling/InvoiceReprintFormat")
  xList.Add("BillingReport/SummaryPanel")
  xList.Add("CashBilling/FixReceiptCategory")
  xList.Add("CashBilling/SeparateReturns")
  xList.Add("CashBilling/TwoStepBilling")
  xList.Add("CashBilling/InvoiceWiseReturn")
  xList.Add("CashBilling/PastInvoices")

  xList.Add("CashBilling/AlterPharmacyStock")
  xList.Add("CashBilling/TargetPharmacyStock")
  xList.Add("CashBilling/TargetSurgicalStock")
  xList.Add("CashBilling/TargetSutureStock")
  xList.Add("CashBilling/TargetOrthopedicStock")
  xList.Add("CashBilling/TargetExtraItemStock")
  xList.Add("CashBilling/TargetGenericLabel")
  xList.Add("CashBilling/TargetBrandLabel")

  xList.Add("CashBilling/GroupPunchingItems")
  xList.Add("CashBilling/DuplicateEntry")
  xList.Add("CashBilling/FixedRateSale")
  xList.Add("CashBilling/AutoReturn")
  xList.Add("CashBilling/BedCharges")
  xList.Add("CashBilling/AddDiagnosis")
  xList.Add("CashBilling/LockDiagnosis")
  xList.Add("CashBilling/CashRecording")
  xList.Add("CashBilling/LowDeposit")
  xList.Add("CashBilling/FractionQuantity")
  xList.Add("CashBilling/ExpiredPunching")
  xList.Add("CashBilling/LockPunchingAfter")

  xList.Add("CashBilling/Section_Service")
  xList.Add("CashBilling/Section_Equipment")
  xList.Add("CashBilling/Section_Radio")
  xList.Add("CashBilling/Section_Test")
  xList.Add("CashBilling/Section_Procedure")
  xList.Add("CashBilling/Section_Others")
  xList.Add("CashBilling/Section_AllItems")

  xList.Add("CashBilling/ServiceReturnPunching")
  xList.Add("CashBilling/PharmacyReturnPunching")
  xList.Add("CashBilling/ReturnByEncID")
  xList.Add("CashBilling/ReturnDueClearance")
  xList.Add("CashBilling/DisableIPDepositReturn")
  xList.Add("CashBilling/DischargeReturnSeparate")

  xList.Add("PayableCalculation/Formula")
  xList.Add("PayableCalculation/TDSMode")
  xList.Add("PayableVerification/Manual")
  xList.Add("PayableVerification/Setting")
  xList.Add("PayableDataSource/Group")
  xList.Add("ShareEntryAccess/Radiology")
  xList.Add("ShareEntryAccess/Procedure")
  xList.Add("PayableUsers/Format")

  xPath = modGENReport.ShowSelectSetting(xList)
  modControlSub.OpenHTMLPreview("", xPath, "ReportSize")

End

Public Sub btnreport_Click()

  PrintableSettings()

End

Private Sub PrintableSettings()

  Dim xPath As String

  $BillingReport = New CReportHTML([("Setting Code"), ("Description"), ("Options"), ("Value")], "", "")
  $BillingReport.UserData.Add("BILLING RULES: " & cmbtarget.Text, "PARAM1")
  $BillingReport.UserData.Add(modReportVar.GetDateTimeReport(Now(), gb.GeneralDate), "PARAM2")

  $BillingReport.AddChapter("General")
  AddSettingReport("Currency/HundredUnit", cmbtarget.Text, txtdollar.Tooltip, "")
  AddSettingReport("Currency/Unit", cmbtarget.Text, txtpenny.Tooltip, "")
  AddSettingReport("CashBilling/FixBilling", cmbtarget.Text, cmbfixbill.Tooltip, cmbfixbill.List.Join("; "))
  AddSettingReport("CashBilling/LockBilling", cmbtarget.Text, cmblockmode.Tooltip, cmblockmode.List.Join("; "))
  AddSettingReport("CashBilling/AmountRounding", cmbtarget.Text, cmbrounding.Tooltip, cmbrounding.List.Join("; "))
  AddSettingReport("CashBilling/InvoiceExtraCopy", cmbtarget.Text, cmbextrabill.Tooltip, cmbextrabill.List.Join("; "))

  AddSettingReport("CashBilling/VerifyReturn", cmbtarget.Text, cmbverifyret.Tooltip, cmbverifyret.List.Join("; "))
  AddSettingReport("SavedBillingEntry/EditPayable", cmbtarget.Text, cmbsavpayble.Tooltip, cmbsavpayble.List.Join("; "))
  AddSettingReport("BillingReport/ShowNullLedger", cmbtarget.Text, cmbnulledger.Tooltip, cmbnulledger.List.Join("; "))

  $BillingReport.AddChapter("Discount")
  AddSettingReport("CashBilling/DiscMode", cmbtarget.Text, cmbdisctype.Tooltip, cmbdisctype.List.Join("; "))
  AddSettingReport("CashBilling/FixDisc", cmbtarget.Text, cmbdisc.Tooltip, cmbdisc.List.Join("; "))
  AddSettingReport("CashBilling/FixDiscSaved", cmbtarget.Text, cmbdiscsave.Tooltip, cmbdiscsave.List.Join("; "))
  AddSettingReport("CashBilling/FixSumDisc", cmbtarget.Text, cmbsumdisc.Tooltip, cmbsumdisc.List.Join("; "))
  AddSettingReport("CashBilling/FixedDiscValue", cmbtarget.Text, txtfixdiscount.Tooltip, "")
  AddSettingReport("CashBilling/SubsidyMode", cmbtarget.Text, cmbsubsidy.Tooltip, cmbsubsidy.List.Join("; "))

  $BillingReport.AddChapter("Tax")
  AddSettingReport("CashBilling/TaxMode", cmbtarget.Text, cmbtaxtype.Tooltip, cmbtaxtype.List.Join("; "))
  AddSettingReport("CashBilling/FixTax", cmbtarget.Text, cmbtax.Tooltip, cmbtax.List.Join("; "))
  AddSettingReport("CashBilling/FixTaxSaved", cmbtarget.Text, cmbtaxsave.Tooltip, cmbtaxsave.List.Join("; "))
  AddSettingReport("CashBilling/FixSumTax", cmbtarget.Text, cmbsumtax.Tooltip, cmbsumtax.List.Join("; "))
  AddSettingReport("CashBilling/FixedTaxValue", cmbtarget.Text, txtfixtax.Tooltip, "")

  $BillingReport.AddChapter("Rate Plan")
  AddSettingReport("BillingGroup/DefaultMode", cmbtarget.Text, cmbdefmode.Tooltip, "")
  AddSettingReport("BillingGroup/FixMode", cmbtarget.Text, cmbfixmode.Tooltip, cmbfixmode.List.Join("; "))

  $BillingReport.AddChapter("Item Rate")
  AddSettingReport("CashBilling/EditRate", cmbtarget.Text, cmbeditrate.Tooltip, cmbeditrate.List.Join("; "))
  AddSettingReport("CashBilling/EditRateSaved", cmbtarget.Text, cmbeditratesave.Tooltip, cmbeditratesave.List.Join("; "))

  $BillingReport.AddChapter("Package")
  AddSettingReport("CashBilling/SchedulePackage", cmbtarget.Text, cmbpackage.Tooltip, cmbpackage.List.Join("; "))
  AddSettingReport("CashBilling/AlterPackage", cmbtarget.Text, cmbpackagenew.Tooltip, cmbpackagenew.List.Join("; "))
  AddSettingReport("SavedBillingEntry/EditPackageSaved", cmbtarget.Text, cmbeditpackage.Tooltip, cmbeditpackage.List.Join("; "))
  AddSettingReport("CashBilling/DefaultPackage", cmbtarget.Text, cmbcashpack.Tooltip, cmbcashpack.List.Join("; "))
  AddSettingReport("CashBilling/DefaultFullPackage", cmbtarget.Text, cmbfullpack.Tooltip, cmbfullpack.List.Join("; "))

  $BillingReport.AddChapter("Billing Access")
  AddSettingReport("BillingOption/CashierBilling", cmbtarget.Text, cmbcasbill.Tooltip, cmbcasbill.List.Join("; "))
  AddSettingReport("BillingOption/CashierReturn", cmbtarget.Text, cmbcasretn.Tooltip, cmbcasretn.List.Join("; "))
  AddSettingReport("BillingOption/DepositBilling", cmbtarget.Text, cmbdeposit.Tooltip, cmbdeposit.List.Join("; "))
  AddSettingReport("BillingOption/PharmacySales", cmbtarget.Text, cmbphmsale.Tooltip, cmbphmsale.List.Join("; "))
  AddSettingReport("BillingOption/PharmacyReturn", cmbtarget.Text, cmbphmret.Tooltip, cmbphmret.List.Join("; "))
  AddSettingReport("BillingOption/DischargeBilling", cmbtarget.Text, cmbdischarge.Tooltip, cmbdischarge.List.Join("; "))
  AddSettingReport("BillingOption/DischargeAutoLock", cmbtarget.Text, cmbautolock.Tooltip, cmbautolock.List.Join("; "))

  $BillingReport.AddChapter("Cash Submission")
  AddSettingReport("CashHandover/LockInvoice", cmbtarget.Text, cmbhandinvoice.Tooltip, cmbhandinvoice.List.Join("; "))
  AddSettingReport("CashHandover/LockSubmission", cmbtarget.Text, cmbhandsubmit.Tooltip, cmbhandsubmit.List.Join("; "))
  AddSettingReport("CashHandover/ZeroSubmission", cmbtarget.Text, cmbzerosubmit.Tooltip, cmbzerosubmit.List.Join("; "))
  AddSettingReport("CashHandover/OtherCash", cmbtarget.Text, cmbhandothercash.Tooltip, cmbhandothercash.List.Join("; "))

  $BillingReport.AddChapter("Restrictions")
  AddSettingReport("CashBilling/LockToOwnEntry", cmbtarget.Text, cmbformlock.Tooltip, cmbformlock.List.Join("; "))
  AddSettingReport("CashBilling/LockAdmitted", cmbtarget.Text, cmbadmitlock.Tooltip, cmbadmitlock.List.Join("; "))
  ' AddSettingReport("CashBilling/RestrictToOwnItems", cmbtarget.Text, cmbrestown.Tooltip, cmbrestown.List.Join("; "))
  AddSettingReport("CashBilling/RestrictToOwn_OutPatients", cmbtarget.Text, cmbownout.Tooltip, cmbownout.List.Join("; "))
  AddSettingReport("CashBilling/RestrictToOwn_Inpatients", cmbtarget.Text, cmbownindoor.Tooltip, cmbownindoor.List.Join("; "))
  AddSettingReport("CashBilling/DisableIPCreditInvoice", cmbtarget.Text, cmbadmitcash.Tooltip, cmbadmitcash.List.Join("; "))
  AddSettingReport("CashBilling/DisableIPCreditReceipt", cmbtarget.Text, cmnadmitrecep.Tooltip, cmnadmitrecep.List.Join("; "))
  AddSettingReport("CashBilling/AdmissionDeposit", cmbtarget.Text, cmbdepolock.Tooltip, cmbdepolock.List.Join("; "))
  AddSettingReport("CashBilling/PharmacyOrigin", cmbtarget.Text, cmbpharmorigin.Tooltip, cmbpharmorigin.List.Join("; "))

  $BillingReport.AddChapter("Invoice Print")
  AddSettingReport("CashBilling/BillPrintTime", cmbtarget.Text, cmbinvoiceprint.Tooltip, cmbinvoiceprint.List.Join("; "))
  AddSettingReport("CashBilling/InvoiceReprintFormat", cmbtarget.Text, cmbreprint.Tooltip, cmbreprint.List.Join("; "))
  AddSettingReport("BillingReport/SummaryPanel", cmbtarget.Text, cmbsumreport.Tooltip, cmbsumreport.List.Join("; "))
  AddSettingReport("CashBilling/FixReceiptCategory", cmbtarget.Text, cmblockcategory.Tooltip, cmblockcategory.List.Join("; "))
  AddSettingReport("CashBilling/SeparateReturns", cmbtarget.Text, cmbsepbill.Tooltip, cmbsepbill.List.Join("; "))
  AddSettingReport("CashBilling/TwoStepBilling", cmbtarget.Text, cmbtwostep.Tooltip, cmbtwostep.List.Join("; "))
  AddSettingReport("CashBilling/InvoiceWiseReturn", cmbtarget.Text, cmbinvoreturn.Tooltip, cmbinvoreturn.List.Join("; "))
  AddSettingReport("CashBilling/PastInvoices", cmbtarget.Text, cmbpastyear.Tooltip, cmbpastyear.List.Join("; "))

  $BillingReport.AddChapter("Pharmacy Source")
  AddSettingReport("CashBilling/AlterPharmacyStock", cmbtarget.Text, cmbalterpharm.Tooltip, cmbalterpharm.List.Join("; "))
  AddSettingReport("CashBilling/TargetPharmacyStock", cmbtarget.Text, cmbmedicinestock.Tooltip, "")
  AddSettingReport("CashBilling/TargetSurgicalStock", cmbtarget.Text, cmbsurgistock.Tooltip, "")
  AddSettingReport("CashBilling/TargetSutureStock", cmbtarget.Text, cmbsuturestock.Tooltip, "")
  AddSettingReport("CashBilling/TargetOrthopedicStock", cmbtarget.Text, cmborthostock.Tooltip, "")
  AddSettingReport("CashBilling/TargetExtraItemStock", cmbtarget.Text, cmbextrastock.Tooltip, "")
  AddSettingReport("CashBilling/TargetGenericLabel", cmbtarget.Text, cmblabelgeneric.Tooltip, "")
  AddSettingReport("CashBilling/TargetBrandLabel", cmbtarget.Text, cmblabelbrand.Tooltip, "")

  $BillingReport.AddChapter("Bill Punching")
  AddSettingReport("CashBilling/GroupPunchingItems", cmbtarget.Text, cmbgroupentry.Tooltip, cmbgroupentry.List.Join("; "))
  AddSettingReport("CashBilling/DuplicateEntry", cmbtarget.Text, cmbduplicate.Tooltip, cmbduplicate.List.Join("; "))
  AddSettingReport("CashBilling/FixedRateSale", cmbtarget.Text, cmbfixedrate.Tooltip, cmbfixedrate.List.Join("; "))
  AddSettingReport("CashBilling/AutoReturn", cmbtarget.Text, cmbautoretn.Tooltip, cmbautoretn.List.Join("; "))
  AddSettingReport("CashBilling/BedCharges", cmbtarget.Text, cmbbedcharge.Tooltip, cmbbedcharge.List.Join("; "))
  AddSettingReport("CashBilling/AddDiagnosis", cmbtarget.Text, cmbdiagnosis.Tooltip, cmbdiagnosis.List.Join("; "))
  AddSettingReport("CashBilling/LockDiagnosis", cmbtarget.Text, cmblockdiagno.Tooltip, cmblockdiagno.List.Join("; "))
  AddSettingReport("CashBilling/CashRecording", cmbtarget.Text, cmbcashformat.Tooltip, cmbcashformat.List.Join("; "))
  AddSettingReport("CashBilling/LowDeposit", cmbtarget.Text, cmblowdeposit.Tooltip, cmblowdeposit.List.Join("; "))
  AddSettingReport("CashBilling/FractionQuantity", cmbtarget.Text, cmbfraction.Tooltip, cmbfraction.List.Join("; "))
  AddSettingReport("CashBilling/ExpiredPunching", cmbtarget.Text, cmbexpired.Tooltip, cmbexpired.List.Join("; "))
  AddSettingReport("CashBilling/LockPunchingAfter", cmbtarget.Text, txtpunchlock.Tooltip, "")

  $BillingReport.AddChapter("Billing Section")
  AddSettingReport("CashBilling/Section_Service", cmbtarget.Text, cmbcatgeneral.Tooltip, "")
  AddSettingReport("CashBilling/Section_Equipment", cmbtarget.Text, cmbcatequip.Tooltip, "")
  AddSettingReport("CashBilling/Section_Radio", cmbtarget.Text, cmbcatradio.Tooltip, "")
  AddSettingReport("CashBilling/Section_Test", cmbtarget.Text, cmbcatlab.Tooltip, "")
  AddSettingReport("CashBilling/Section_Procedure", cmbtarget.Text, cmbcatproc.Tooltip, "")
  AddSettingReport("CashBilling/Section_Others", cmbtarget.Text, cmbcatother.Tooltip, "")
  AddSettingReport("CashBilling/Section_AllItems", cmbtarget.Text, cmbcatall.Tooltip, "")

  $BillingReport.AddChapter("Return Access Rules")
  AddSettingReport("CashBilling/ServiceReturnPunching", cmbtarget.Text, cmbreturnentry.Tooltip, cmbreturnentry.List.Join("; "))
  AddSettingReport("CashBilling/PharmacyReturnPunching", cmbtarget.Text, cmbreturnpharm.Tooltip, cmbreturnpharm.List.Join("; "))
  AddSettingReport("CashBilling/ReturnByEncID", cmbtarget.Text, cmbretnencid.Tooltip, cmbretnencid.List.Join("; "))
  AddSettingReport("CashBilling/ReturnDueClearance", cmbtarget.Text, cmbretclear.Tooltip, cmbretclear.List.Join("; "))
  AddSettingReport("CashBilling/DisableIPDepositReturn", cmbtarget.Text, cmbadmitdepo.Tooltip, cmbadmitdepo.List.Join("; "))
  AddSettingReport("CashBilling/DischargeReturnSeparate", cmbtarget.Text, cmbdischreturn.Tooltip, cmbdischreturn.List.Join("; "))

  $BillingReport.AddChapter("Sharing Rules")
  AddSettingReport("PayableCalculation/Formula", cmbtarget.Text, cmbsharecalc.Tooltip, cmbsharecalc.List.Join("; "))
  AddSettingReport("PayableCalculation/TDSMode", cmbtarget.Text, cmbsharetds.Tooltip, cmbsharetds.List.Join("; "))
  AddSettingReport("PayableVerification/Manual", cmbtarget.Text, cmbmanpayverify.Tooltip, cmbmanpayverify.List.Join("; "))
  AddSettingReport("PayableVerification/Setting", cmbtarget.Text, cmbautopayverify.Tooltip, cmbautopayverify.List.Join("; "))
  AddSettingReport("PayableDataSource/Group", cmbtarget.Text, cmbgroupsource.Tooltip, cmbgroupsource.List.Join("; "))
  AddSettingReport("ShareEntryAccess/Radiology", cmbtarget.Text, chkshareradio.Tooltip, "Yes; No")
  AddSettingReport("ShareEntryAccess/Procedure", cmbtarget.Text, chkshareproc.Tooltip, "Yes; No")
  AddSettingReport("PayableUsers/Format", cmbtarget.Text, cmbcategorypay.Tooltip, cmbcategorypay.List.Join("; "))

  xPath = $BillingReport.NewHTMLPath()
  modControlSub.OpenHTMLPreview("", xPath, "ReportSize")

End

Private Sub AddSettingReport(sCode As String, starget As String, sToolTip As String, sOptions As String)

  Dim res As Result
  Dim xval As String
  Dim asx As New String[0]

  res = modDatabase.$myConn.Exec("select fldvalue from tblsettings where fldindex=&1", starget & ":" & sCode)
  If res.Available Then
    If res["fldvalue"] Then
      xval = res["fldvalue"]
    Else
      xval = ""
    Endif
  Else
    xval = ""
  Endif
  With asx
    .Add(sCode)
    .Add(sToolTip)
    .Add(sOptions)
    .Add(xval)
  End With
  $BillingReport.Add(asx)
  asx.Clear()

End

Public Sub WebButtonL1_Click()

  GetNormalButtons()
  IconPanel1.Index = 0
  WebButtonL1.Background = Color.LightGray

End

Public Sub WebButtonL2_Click()

  GetNormalButtons()
  IconPanel1.Index = 1
  WebButtonL2.Background = Color.LightGray

End

Public Sub WebButtonL3_Click()

  GetNormalButtons()
  IconPanel1.Index = 2
  WebButtonL3.Background = Color.LightGray

End

Public Sub WebButtonL4_Click()

  GetNormalButtons()
  IconPanel1.Index = 3
  WebButtonL4.Background = Color.LightGray

End

Public Sub WebButtonL5_Click()

  GetNormalButtons()
  IconPanel1.Index = 4
  WebButtonL5.Background = Color.LightGray

End

Public Sub WebButtonL6_Click()

  GetNormalButtons()
  IconPanel1.Index = 5
  WebButtonL6.Background = Color.LightGray

End

Public Sub WebButtonL7_Click()

  GetNormalButtons()
  IconPanel1.Index = 6
  WebButtonL7.Background = Color.LightGray

End

Public Sub WebButtonL8_Click()

  GetNormalButtons()
  IconPanel1.Index = 7
  WebButtonL8.Background = Color.LightGray

End

Public Sub WebButtonL9_Click()

  GetNormalButtons()
  IconPanel1.Index = 8
  WebButtonL9.Background = Color.LightGray

End

Public Sub WebButtonL10_Click()

  GetNormalButtons()
  IconPanel1.Index = 9
  WebButtonL10.Background = Color.LightGray

End

Private Sub GetNormalButtons()

  WebButtonL1.Background = Color.Default
  WebButtonL2.Background = Color.Default
  WebButtonL3.Background = Color.Default
  WebButtonL4.Background = Color.Default
  WebButtonL5.Background = Color.Default
  WebButtonL6.Background = Color.Default
  WebButtonL7.Background = Color.Default
  WebButtonL8.Background = Color.Default
  WebButtonL9.Background = Color.Default
  WebButtonL10.Background = Color.Default

End

Public Sub btnclose_Click()

  Me.Close

End
