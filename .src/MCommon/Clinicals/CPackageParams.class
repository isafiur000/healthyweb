' Gambas class file

Private $sBillMode As String
Private $LedgerAC As String
Private $xBillType As String
Private $ClaimCode As String
Private $ClaimState As String

Private $encid As String
Private $discType As String

Public Sub _new(encid As String, DiscType As String)

  $encid = encid
  $discType = DiscType
  ShowBillingParam()

End

Private Sub ShowBillingParam()

  Dim resx As Result

  $sBillMode = ""
  $LedgerAC = ""
  $xBillType = ""
  $ClaimCode = ""
  $ClaimState = ""

  resx = modDatabase.$myConn.Exec("select fldmode,fldbillingmode,fldacledger,fldbilltype,fldreference,fldlimit,fldlockstate from tbldiscount where fldtype=&1", $discType)
  If resx.Available Then
    ''billingmode
    If resx["fldbillingmode"] Then
      $sBillMode = resx["fldbillingmode"]
    Else
      $sBillMode = modPatient.GetPatBillingMode($encid)
    Endif
    ''claim code button
    If resx["fldreference"] Then
      If resx["fldreference"] = "Claim Code" Then
        $ClaimCode = modClaim.GetClaimCidePatient($encid, modNonMedical.GetLastCLaimType($encid))
        If $ClaimCode Then
          $ClaimState = modClaim.GetHIClaimState($ClaimCode)
        Endif
      Endif
    Else If resx["fldreference"] = "Accident SSF" Then
      $ClaimCode = modSSF.GetSSFClaimCodePatient($encid, "Accident SSF")
    Else If resx["fldreference"] = "Critical SSF" Then
      $ClaimCode = modSSF.GetSSFClaimCodePatient($encid, "Critical SSF")
    Else If resx["fldreference"] = "MedExtra SSF" Then
      $ClaimCode = modSSF.GetSSFClaimCodePatient($encid, "MedExtra SSF")
    Else If resx["fldreference"] = "Medical SSF" Then
      $ClaimCode = modSSF.GetSSFClaimCodePatient($encid, "Medical SSF")
    Endif
    ''ledger A/C
    $LedgerAC = resx["fldacledger"]
    ''BillType
    $xBillType = resx["fldbilltype"]
    If Not $xBillType Then
      $xBillType = "Cash"
    Endif
  Endif

End

Public Function GetBillingMode() As String

  Return $sBillMode

End

Public Function GetBillType() As String

  Return $xBillType

End

Public Function GetLedgerAC() As String

  Return $LedgerAC

End

Public Function GetClaimCode() As String

  Return $ClaimCode

End

Public Function GetClaimState() As String

  Return $ClaimState

End
