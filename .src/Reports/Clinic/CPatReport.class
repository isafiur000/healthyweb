' Gambas class file

Private encid As String
' Private $status As String

Public Sub _new(xencid As String)

  encid = xencid
  ' $status = modPatient.CurrentAdmissionStatus(encid)

End

Public Function AddCustomReport(stChapter As String, stObservation As String) As String[]

  Dim asx As New String[0]

  If Len(Trim(stObservation)) Then
    With asx
      If modBasic.$MedRepoBody = "Paragraph" Then
        .Add("<b>" & stChapter & "</b><br>" & modString.TextToHTML(stObservation))
      Else
        .Add(stChapter)
        .Add(modString.TextToHTML(stObservation))
      Endif
    End With
  Endif

  Return asx

End

Public Function AddCourseOfTreatment(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Course of Treatment"
  Endif
  stObservation = modString.GetHTMLListFormat(modClinicReport.GetCourseOfTreatment(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddBedTransition(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Bed Transitions"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientTransition(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddPresentingComplaints(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Presenting Complaints"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientPresentingSymptomReport(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddGenComplaints(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "General Complaints"
  Endif
  stObservation = modString.TextToHTML(modPatReports.GetPatientHistoryReport(encid, "General Complaints"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddChiefComplaints(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Chief Complaints"
  Endif
  stObservation = modString.GetHTMLListFormat(modClinicReport.GetPatientChiefComplaintsReport(encid, False))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddPatDemographics(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Demographics"
  Endif
  stObservation = modString.GetHTMLListFormat(modClinicReport.GetPatientDemographicReport(encid, False))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddCauseofAdmission(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Cause of Admission"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Cause of Admission")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddHistoryOfIllness(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "History of Illness"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "History of Illness")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''=================== For backward compatibility only ===================
Public Function AddPastHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Past History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Past History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddTreatmentHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Treatment History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Treatment History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddMedicatHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Medication History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Medication History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddPersonalHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Personal History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Personal History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddSurgicalHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Surgical History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Surgical History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddOccupationalHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Occupational History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Occupational History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddSocialHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Social History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Social History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddFamilyHistory(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Family History"
  Endif
  stObservation = modPatReports.GetPatientHistoryReport(encid, "Family History")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End
''===================== End backward Compatibility ======================

Public Function AddSelectedHistory(sType As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  stChapter = sType
  stObservation = modPatReports.GetPatientHistoryReport(encid, sType)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddConsultationAll(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Consultations"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatient.GetPatientCOnsultList(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddProvisionalDiagnosis(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Provisional Diagnosis"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatient.PatientFindingList(encid, "Provisional Diagnosis"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddFinalDiagnosis(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Final Diagnosis"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatient.PatientFindingList(encid, "Final Diagnosis"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDrugAllergy(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Drug Allergy"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatient.PatientFindingList(encid, "Allergic Drugs"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddOutpatientAdvice(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Outpatient Advice"
  Endif
  stObservation = modString.TextToHTML(modPatReports.GetPatientNotesAllTypes(encid, "Outpatient Notes").Join(gb.NewLine))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddOPDAdvice(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "OPD Advice"
  Endif
  stObservation = modPatReports.GetPatientNoteReport(encid, "Initial Planning")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddExpertAdvice(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Expert Advice"
  Endif
  stObservation = modPatReports.GetPatientNoteReport(encid, "Expert Planning")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddOrderForNewVisit(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Orders for New Visit"
  Endif
  stObservation = modPatReports.GetPastBillingOrders(encid)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddPlannedProcedures(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Planned Procedures"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatProcedureList(encid, "Procedures", "Planned"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddInvestigationAdvised(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Investigation Advised"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.OPDOrderLabRequest(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''--------------------- Medicines --------------------------
Public Function AddTreatmentAdvised(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Treatment Advised"
  Endif
  stObservation = modClinicReport.GetRequestMedString(encid, "Medicines", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddSurgicalsRequests(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Surgical Requests"
  Endif
  stObservation = modClinicReport.GetRequestMedString(encid, "Surgicals", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddExtraItemsRequests(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Extra Requests"
  Endif
  stObservation = modClinicReport.GetRequestMedString(encid, "Extra Items", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddUnavailableMeds(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Unavailable Medicines"
  Endif
  stObservation = modClinicReport.NonAvailableMedString(encid, "Medicines", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddPendingMeds(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Pending Medicines"
  Endif
  stObservation = modClinicReport.PendingRequestMedString(encid, "Medicines", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddMedicineDispensed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Medicines Dispensed"
  Endif
  stObservation = modClinicReport.GetDispensedPharm(encid, "Medicines", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddSurgicalsDispensed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Surgicals Dispensed"
  Endif
  stObservation = modClinicReport.GetDispensedPharm(encid, "Surgicals", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddExtraDispensed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Extra Items Dispensed"
  Endif
  stObservation = modClinicReport.GetDispensedPharm(encid, "Extra Items", False)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddIndoorMedication(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Indoor Medication"
  Endif
  stObservation = modClinicReport.AdmittedMedString(encid)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDischargeMedication(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Discharge Medication"
  Endif
  stObservation = modClinicReport.DischargeMedString(encid)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''------------------ Attached: Lab/Radio/Exam
Public Function AddExaminationsAll(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim categList As String[]
  Dim xcateg As String
  Dim xlist As String[]
  Dim xexams As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Clinical Findings"
  Endif

  xexams = New String[]
  categList = ["ABC Examinations", "Essential Examinations", "Physician Examinations", "Nursing Examinations", "Discharge Examinations"]
  For Each xcateg In categList
    xlist = modPatReports.PaientSelExamNameArray(encid, xcateg)
    If xlist And If xlist.Count Then
      xexams.Add(xcateg & gb.NewLine & modClinicReport.GetExaminationHTMLProfile(encid, xlist))
    Endif
  Next

  stObservation = modString.GetHTMLListFormat(xexams)
  asx = AddCustomReport(stChapter, stObservation)

  Return asx

End

Public Function AddPhysicianFindings(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim xlist As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Physician Examinations"
  Endif
  xlist = modPatReports.PaientSelExamNameArray(encid, "Physician Examinations")
  If xlist Then
    stObservation = modClinicReport.GetExaminationHTMLProfile(encid, xlist)
    asx = AddCustomReport(stChapter, stObservation)
  Endif
  Return asx

End

Public Function AddNursingFindings(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim xlist As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Nursing Examinations"
  Endif
  xlist = modPatReports.PaientSelExamNameArray(encid, "Nursing Examinations")
  If xlist Then
    stObservation = modClinicReport.GetExaminationHTMLProfile(encid, xlist)
    asx = AddCustomReport(stChapter, stObservation)
  Endif
  Return asx

End

Public Function AddEssentialFindings(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim xlist As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Essential Examinations"
  Endif
  xlist = modPatReports.PaientSelExamNameArray(encid, "Essential Examinations")
  If xlist Then
    stObservation = modClinicReport.GetExaminationHTMLProfile(encid, xlist)
    asx = AddCustomReport(stChapter, stObservation)
  Endif
  Return asx

End

Public Function AddTriageFindings(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim xlist As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "ABC Examinations"
  Endif
  xlist = modPatReports.PaientSelExamNameArray(encid, "ABC Examinations")
  If xlist Then
    stObservation = modClinicReport.GetExaminationHTMLProfile(encid, xlist)
    asx = AddCustomReport(stChapter, stObservation)
  Endif
  Return asx

End

Public Function AddDischargeFindings(Optional sTitle As String) As String[]

  Dim asx As New String[0]
  Dim xlist As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Discharge Examinations"
  Endif
  xlist = modPatReports.PaientSelExamNameArray(encid, "Discharge Examinations")
  If xlist Then
    stObservation = modClinicReport.GetExaminationHTMLProfile(encid, xlist)
    asx = AddCustomReport(stChapter, stObservation)
  Endif
  Return asx

End

Public Function AddPhysicianStructured(Optional sTitle As String) As String[]

  Dim asx As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Physician Examinations"
  Endif
  stObservation = modClinicReport.GetRecommendedExam(encid, "Physician Examinations")
  asx = AddCustomReport(stChapter, stObservation)

  Return asx

End

Public Function AddDepartmentStructured(Optional sTitle As String) As String[]

  Dim asx As String[]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Departmental Examinations"
  Endif
  stObservation = modClinicReport.GetRecommendedExam(encid, "Departmental")
  asx = AddCustomReport(stChapter, stObservation)

  Return asx

End

Public Function AddSelectedExamination(examList As String[]) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  stChapter = "Examinations"
  stObservation = modClinicReport.GetExaminationHTMLProfile(encid, examList)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddSelectedTest(testList As String[], sUnit As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  stChapter = "Laboratory"
  stObservation = modPatReports.GetlaboratoryHTMLProfile(encid, testList, sUnit)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddCompleteTest(sUnit As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  stChapter = "Laboratory"
  stObservation = modPatReports.GetCompleteLabTestByEnc(encid, sUnit)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddSelectedRadio(examList As String[]) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  stChapter = "Radio Diagnostics"
  stObservation = modPatReports.GetRadiologyHTMLProfile(encid, examList)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddCompleteRadio() As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  stChapter = "Radio Diagnostics"
  stObservation = modPatReports.GetCompleteRadioTestByEnc(encid)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''---------------------- Attached: Services ------------------------------
Public Function AddMajorProcedures(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Major Procedures"
  Endif
  stObservation = modPatSurgery.PatSelectProcedureString(encid, "Procedures", "Done")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddMinorProcedures(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Minor Procedures"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatProcedureList(encid, "Minor Procedures", "Done"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddEquipmentsUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Equipments Used"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientEquipmentUse(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddEventProfile(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Event Timings"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientEventProfile(encid, "Events"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDevicesUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Devices Used"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatPatho.GetPatientEventProfile(encid, "Devices"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddMedicationUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Medication Used"
  Endif
  stObservation = modPharmacy.NurDosingString(encid)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddNutritionUsed(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Nutrition Consumed"
  Endif
  ''stObservation = modPharmacy.NurDosingString(encid)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddNutritionApproved(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Nutrition Approved"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetDietApprovedList(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddProminientSymptoms(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Prominent Symptoms"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientSymptomReport(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddMajorProceduresCustom(sReport As String, Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Major Procedures"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatSurgery.GetCustomProcedureMajor(encid, sReport))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

''-------------------------- Attached: Inpatient -------------------
Public Function AddInpatientNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Inpatient Notes"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientNotesAllTypes(encid, "Inpatient Notes"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddProgressNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Progress Note"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetClinNoteSpecificReport(encid, "Progress Note"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddCliniciansNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Clinicians Note"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetClinNoteSpecificReport(encid, "Clinicians Note"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddNursesNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Nurses Note"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetClinNoteSpecificReport(encid, "Nurses Note"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddTransferNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Transfer Note"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetClinNoteSpecificReport(encid, "Transfer Note"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddTherapeuticPlanning(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Medical Planning"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientPlanningReport(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddIPMonitoring(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "IP Monitoring"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientMonitorReport(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDeliveryProfile(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Delivery Profile"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.DeliveryReportbyMother(encid))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddDischargeNotes(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Discharge Notes"
  Endif
  stObservation = modString.GetHTMLListFormat(modPatReports.GetPatientNotesAllTypes(encid, "Discharge Notes"))
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddConditionAtDischarge(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Condition at Discharge"
  Endif
  stObservation = modPatReports.GetPatientNoteReport(encid, "Condition of Discharge")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddAdviceDischarge(Optional sTitle As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  If sTitle Then
    stChapter = sTitle
  Else
    stChapter = "Advice on Discharge"
  Endif
  stObservation = modPatReports.GetPatientNoteReport(encid, "Advice on Discharge")
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End

Public Function AddSelectedDischarge(sType As String) As String[]

  Dim asx As New String[0]

  Dim stChapter As String
  Dim stObservation As String

  stChapter = sType
  stObservation = modPatPatho.ShowSelectedNotes(encid, sType)
  asx = AddCustomReport(stChapter, stObservation)
  Return asx

End
