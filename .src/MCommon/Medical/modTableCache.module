' Gambas module file

Public $SymptomMasterVar As Variant[]
Public $SymptomCompVar As Variant[]
Public $ExaminationCompVar As Variant[]

Public $MedicineDataVar As Variant[]
Public $UserProfileVar As Variant[]
Public $ServiceDataVar As Variant[]

''----------------- Patho --------------------------------
Public Sub LoadSymptomsMasterData(sCon As Connection)

  Dim res As Result
  Dim sColl As Collection

  $SymptomMasterVar = New Variant[]
  res = sCon.Exec("select fldsymptom,fldcategory,fldcode,fldsymdetail from tblsymptoms")     ''
  If res.Available Then
    For Each res
      sColl = New Collection
      sColl.Add(res["fldsymptom"], "fldsymptom")
      sColl.Add(res["fldcategory"], "fldcategory")
      sColl.Add(res["fldcode"], "fldcode")
      sColl.Add(res["fldsymdetail"], "fldsymdetail")
      $SymptomMasterVar.Add(sColl)
    Next
  Endif

End

Public Sub LoadSymptomsCompwiseData(sCon As Connection)

  Dim res As Result
  Dim sColl As Collection

  $SymptomCompVar = New Variant[]
  res = sCon.Exec("select fldsymptom,fldtype,fldflag from tblcomplaints where fldcomp=&1 or fldcomp=&2", modBasic.$compID, "%")     ''
  If res.Available Then
    For Each res
      sColl = New Collection
      sColl.Add(res["fldsymptom"], "fldsymptom")
      sColl.Add(res["fldtype"], "fldtype")
      sColl.Add(res["fldflag"], "fldflag")
      $SymptomCompVar.Add(sColl)
    Next
  Endif

End

Public Sub LoadExamsCompwiseData(sCon As Connection)

  Dim res As Result
  Dim sColl As Collection

  $ExaminationCompVar = New Variant[]
  res = sCon.Exec("select fldcategory,fldexamid,fldsysconst,fldtype,fldtanswertype,fldoptionlist,fldgroupname,fldexamorder,fldflag from tblcompexam where fldcomp=&1 or fldcomp=&2 ORDER BY fldexamorder", modBasic.$compID, "%")     ''
  If res.Available Then
    For Each res
      sColl = New Collection
      sColl.Add(res["fldcategory"], "fldcategory")
      sColl.Add(res["fldexamid"], "fldexamid")
      sColl.Add(res["fldsysconst"], "fldsysconst")
      sColl.Add(res["fldtype"], "fldtype")
      sColl.Add(res["fldtanswertype"], "fldtanswertype")
      sColl.Add(res["fldoptionlist"], "fldoptionlist")
      sColl.Add(res["fldgroupname"], "fldgroupname")
      sColl.Add(res["fldexamorder"], "fldexamorder")
      sColl.Add(res["fldflag"], "fldflag")
      $ExaminationCompVar.Add(sColl)
    Next
  Endif

End

''===================== Medicine ===============================================
Public Sub LoadMedicineMasterData(sCon As Connection)

  Dim res As Result
  Dim sColl As Collection

  $MedicineDataVar = New Variant[]
  res = sCon.Exec("select tblmedbrand.fldbrandid as fldbrandid,tblmedbrand.fldbrand as fldbrand,tbldrug.flddrug as flddrug,tblcode.fldcodename as fldcodename,tblmedbrand.flddosageform as flddosageform,tblmedbrand.fldmanufacturer as fldmanufacturer,tblmedbrand.flddetail as flddetail,tblmedbrand.fldstandard as fldstandard,tblmedbrand.fldpackvol as fldpackvol,tblmedbrand.fldvolunit as fldvolunit,tblmedbrand.fldpacksize as fldpacksize,tblmedbrand.fldmaxqty as fldmaxqty,tblmedbrand.fldminqty as fldminqty,tblmedbrand.fldleadtime as fldleadtime,tblmedbrand.fldpreservative as fldpreservative,tblmedbrand.fldnarcotic as fldnarcotic,tblmedbrand.fldtabbreak as fldtabbreak,tblmedbrand.flddeflabel as flddeflabel,tblmedbrand.fldactive as fldactive,tblmedbrand.fldtaxcode as fldtaxcode,tbldrug.fldstrength as fldstrength,tbldrug.fldstrunit as fldstrunit,tbldrug.fldroute as fldroute,tbldrug.flddoseunit as flddoseunit,tbldrug.fldhelppage as fldhelppage,tbldrug.fldciyear as fldciyear,tblcode.fldrecaddose as fldrecaddose,tblcode.fldrecaddoseunit as fldrecaddoseunit,tblcode.fldrecadfreq as fldrecadfreq,tblcode.fldrecpeddose as fldrecpeddose,tblcode.fldrecpeddoseunit as fldrecpeddoseunit,tblcode.fldrecpedfreq as fldrecpedfreq,tblcode.fldchemclass as fldchemclass,tblcode.fldcategory as fldcategory,tblcode.fldprn as fldprn,tblcode.flddrugdetail as flddrugdetail,tblcode.fldhelppage as fldhelppage,tblcode.fldreference as fldreference,tblcode.fldplasmaprotein as fldplasmaprotein,tblcode.fldeliminhalflife as fldeliminhalflife,tblcode.fldvoldistribution as fldvoldistribution,tblcode.fldeliminhepatic as fldeliminhepatic,tblcode.fldeliminrenal as fldeliminrenal,tblcode.fldmechaction as fldmechaction,tblcode.fldsensname as fldsensname,tblcode.fldrisklevel as fldrisklevel,tblcode.fldvaccine as fldvaccine from (tblmedbrand inner join tbldrug on tblmedbrand.flddrug=tbldrug.flddrug) inner join tblcode on tbldrug.fldcodename=tblcode.fldcodename")            ''
  If res.Available Then
    For Each res
      sColl = New Collection
      sColl.Add(res["fldbrandid"], "fldbrandid")
      sColl.Add(res["flddrug"], "flddrug")
      sColl.Add(res["fldcodename"], "fldcodename")
      sColl.Add(res["fldbrand"], "fldbrand")
      sColl.Add(res["fldpackvol"], "fldpackvol")
      sColl.Add(res["fldvolunit"], "fldvolunit")
      sColl.Add(res["fldstrength"], "fldstrength")
      sColl.Add(res["fldstrunit"], "fldstrunit")
      sColl.Add(res["fldroute"], "fldroute")
      sColl.Add(res["fldcodename"], "fldcodename")

      sColl.Add(res["flddosageform"], "flddosageform")
      sColl.Add(res["fldmanufacturer"], "fldmanufacturer")
      sColl.Add(res["flddetail"], "flddetail")
      sColl.Add(res["fldstandard"], "fldstandard")
      sColl.Add(res["fldpacksize"], "fldpacksize")
      sColl.Add(res["fldmaxqty"], "fldmaxqty")
      sColl.Add(res["fldminqty"], "fldminqty")
      sColl.Add(res["fldleadtime"], "fldleadtime")
      sColl.Add(res["fldpreservative"], "fldpreservative")
      sColl.Add(res["fldnarcotic"], "fldnarcotic")
      sColl.Add(res["fldtabbreak"], "fldtabbreak")
      sColl.Add(res["flddeflabel"], "flddeflabel")
      sColl.Add(res["fldactive"], "fldactive")
      sColl.Add(res["fldtaxcode"], "fldtaxcode")

      sColl.Add(res["flddoseunit"], "flddoseunit")
      sColl.Add(res["fldhelppage"], "fldhelppage")
      sColl.Add(res["fldciyear"], "fldciyear")

      sColl.Add(res["fldrecaddose"], "fldrecaddose")
      sColl.Add(res["fldrecaddoseunit"], "fldrecaddoseunit")
      sColl.Add(res["fldrecadfreq"], "fldrecadfreq")
      sColl.Add(res["fldrecpeddose"], "fldrecpeddose")
      sColl.Add(res["fldrecpeddoseunit"], "fldrecpeddoseunit")
      sColl.Add(res["fldrecpedfreq"], "fldrecpedfreq")
      sColl.Add(res["fldchemclass"], "fldchemclass")
      sColl.Add(res["fldcategory"], "fldcategory")
      sColl.Add(res["fldprn"], "fldprn")
      sColl.Add(res["flddrugdetail"], "flddrugdetail")
      sColl.Add(res["fldhelppage"], "fldhelppage")
      sColl.Add(res["fldreference"], "fldreference")
      sColl.Add(res["fldplasmaprotein"], "fldplasmaprotein")
      sColl.Add(res["fldeliminhalflife"], "fldeliminhalflife")
      sColl.Add(res["fldvoldistribution"], "fldvoldistribution")
      sColl.Add(res["fldeliminhepatic"], "fldeliminhepatic")
      sColl.Add(res["fldeliminrenal"], "fldeliminrenal")
      sColl.Add(res["fldmechaction"], "fldmechaction")
      sColl.Add(res["fldsensname"], "fldsensname")
      sColl.Add(res["fldrisklevel"], "fldrisklevel")
      sColl.Add(res["fldvaccine"], "fldvaccine")

      $MedicineDataVar.Add(sColl)
    Next
  Endif

End

''============ User Profile ============
Public Sub LoadUserProfileData(sCon As Connection)

  Dim res As Result
  Dim sColl As Collection

  $UserProfileVar = New Variant[]
  res = sCon.Exec("select flduserid,fldusername,fldusercode,fldcategory,fldcontact,fldemail from tbluser")            ''
  If res.Available Then
    For Each res
      sColl = New Collection
      sColl.Add(res["flduserid"], "flduserid")
      sColl.Add(res["fldusername"], "fldusername")
      sColl.Add(res["fldusercode"], "fldusercode")
      sColl.Add(res["fldcategory"], "fldcategory")
      sColl.Add(res["fldcontact"], "fldcontact")
      sColl.Add(res["fldemail"], "fldemail")
      sColl.Add(res["fldstatus"], "fldstatus")

      $UserProfileVar.Add(sColl)
    Next
  Endif

End

''============ Service Cost ============
Public Sub LoadServiceCostData(sCon As Connection)

  Dim res As Result
  Dim sColl As Collection

  $ServiceDataVar = New Variant[]
  res = sCon.Exec("select flditemname,flditemcode,fldcode,fldid,fldbillitem,flditemtype,fldtarget,fldstatus,fldwaitday,fldgetcomment,fldgroup,fldreport,fldtaxcode,fldeditrate,fldeditdisc,fldpayable,fldpatentry,fldhospitalshare,fldinstrumshare,flddepartshare,fldanesthshare,fldothershare from tblservicecost")            ''
  If res.Available Then
    For Each res
      sColl = New Collection
      sColl.Add(res["flditemname"], "flditemname")
      sColl.Add(res["flditemcode"], "flditemcode")
      sColl.Add(res["fldcode"], "fldcode")
      sColl.Add(res["fldid"], "fldid")
      sColl.Add(res["fldbillitem"], "fldbillitem")
      sColl.Add(res["flditemtype"], "flditemtype")
      sColl.Add(res["fldtarget"], "fldtarget")
      sColl.Add(res["fldstatus"], "fldstatus")
      sColl.Add(res["fldwaitday"], "fldwaitday")
      sColl.Add(res["fldgetcomment"], "fldgetcomment")

      sColl.Add(res["fldgroup"], "fldgroup")
      sColl.Add(res["fldreport"], "fldreport")
      sColl.Add(res["fldtaxcode"], "fldtaxcode")
      sColl.Add(res["fldeditrate"], "fldeditrate")
      sColl.Add(res["fldeditdisc"], "fldeditdisc")
      sColl.Add(res["fldpayable"], "fldpayable")
      sColl.Add(res["fldpatentry"], "fldpatentry")

      sColl.Add(res["fldhospitalshare"], "fldhospitalshare")
      sColl.Add(res["fldinstrumshare"], "fldinstrumshare")
      sColl.Add(res["flddepartshare"], "flddepartshare")
      sColl.Add(res["fldanesthshare"], "fldanesthshare")
      sColl.Add(res["fldothershare"], "fldothershare")

      $ServiceDataVar.Add(sColl)
    Next
  Endif

End
