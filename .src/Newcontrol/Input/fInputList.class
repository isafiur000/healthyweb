' Gambas class file

Private $sValue As String[]
Private $sTitle As String

Public Sub Run(sTitle As String, Optional sDefault As String[]) As String[]

  Me.Title = $sTitle
  $sTitle = sTitle
  If sDefault Then
    ListBox1.List = sDefault
  Endif
  $sValue = ListBox1.List
  modGeneralMain.GetOpenModalForm(Me)
  txtnew.SetFocus

  If Me.ShowModal() Then Return $sValue

End

Public Sub btnadd_Click()

  If txtnew.Text Then
    ListBox1.Add(txtnew.Text)
    txtnew.Text = ""
  Endif
  txtnew.SetFocus

End

Public Sub btndel_Click()

  ListBox1.Remove(ListBox1.Index)

End

Public Sub btnok_Click()

  $sValue = ListBox1.List
  Me.Close(True)

End

Public Sub btnclose_Click()

  Me.Close()

End
