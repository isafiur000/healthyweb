' Gambas class file

Private $queryList As String[]
Private $TextData As String
Private $sValue As String

Public Sub Run(sQueryList As String[], sText As String) As String

  $queryList = sQueryList
  $TextData = sText

  cmbquery.List = $queryList
  If Me.ShowModal() Then Return $sValue

End

Public Sub chktext_Click()

  If chktext.Value = True Then
    TextArea1.Text = $TextData
  Else
    TextArea1.Text = ""
  Endif

End

Public Sub btnquery_Click()

  Dim xargs As String
  Dim cForm As CGroqAPI
  Dim xansw As String

  If cmbquery.Text Then
    If chktext.Value = True Then
      If rbefore.Value = True Then
        xargs = TextArea1.Text & gb.NewLine & cmbquery.Text
      Else If rbafter.Value = True Then
        xargs = cmbquery.Text & gb.NewLine & TextArea1.Text
      Endif
    Else
      xargs = cmbquery.Text
    Endif

    If xargs Then
      cForm = New CGroqAPI(modBasic.$CloudAIModel, xargs)
      xansw = cForm.GetAPIAnswer()
    Endif

    If xansw Then
      $sValue = xansw
      Me.Close(True)
    Endif
  Endif

End

Public Sub btnclose_Click()

  Me.Close()

End
