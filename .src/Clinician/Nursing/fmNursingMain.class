' Gambas class file

Public Sub _new()

  Me.AddHeader("<meta name='viewport' content='width=device-width, initial-scale=1'>")
  Me.AddHeader("<link rel=\"stylesheet\" href=\"" & modHelpVariable.$AppCssPath & "\">")
  Me.AddJavascriptFile("js/jquery.min.js")
  Me.AddJavascriptFile("js/print.min.js")
  Me.AddJavascriptFile("js/toastify.js")
  Me.AddJavascriptFile("js/Chart.js")
  Me.AddJavascriptFile("js/tribute.js")
  Me.AddJavascriptFile("js/download.js")
  Me.AddJavascriptFile("js/select2.min.js")

  Me.AddJavascriptFile("js/sketchpad.js")
  Me.AddJavascriptFile("js/html5-qrcode.min.js")
  Me.AddJavascriptFile("js/webcodecamjs.js")
  Me.AddJavascriptFile("js/webcontrols.js")
  ''slow js
  Me.AddJavascriptFile("js/html2pdf.bundle.min.js")
  Me.AddJavascriptFile("js/xlsx.full.min.js")
  Me.Font = MMain.$AppFontName
  WebImage1.Image = modHelpVariable.$headerImage
  WebForm.Debug = MMain.$isdebug

End

Public Sub WebForm_Open()

  If MMain.$WebEntry = True Then
    modDataRepo.$RepositoryMode = MMain.$AppLogCategory
    modBasic.$HospCode = MMain.$AppLogString
  Endif
  modHelpVariable.SetApplicationGUI()
  MMain.GetApplVersionType()

  modBasic.GlobalClinicSettings()
  modBasic.ClinicalCommentSett()
  modBasic.LoadRegistrationSetting()
  modBasic.DisplayPatientSettings()
  modBasic.SetClinicalProcedures()
  modBasic.LoadClinicalChartSetting()
  modBasic.InventorySettings()
  modLinkDB.LoadExtraDBSettings()
  modBasic.MedicineDoseSetting()
  modBasic.LoadClinicalLists()
  modBasic.LoadClinicalExtras()
  modBasic.LoadCashierBillingSettings()
  modBasic.LoadInvoicingSetting()
  modBasic.LoadBillingLists()
  modBasic.LoadAutoBillingOptions()
  modBasic.SetAccountRules()
  modBasic.LoadClaimParametes()
  modBasic.LoadSSFClaim()
  modBasic.RemoteLogInSetting()

  modBasic.InventoryUserAccessList()
  modBasic.ChartSettingsAll()
  modBasic.DispLabelSettings()
  modBasic.LoadLargeLists()
  modBasic.CloudAISettings()

  modBasic.$IPDDepartmentsAll = modGeneral.GetDepartmentWithBedList()

End

Public Sub mnuexit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub btnquit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub WebForm_Close()

  modDevice.CamOnClose()
  modDatabase.CloseDatabase()
  modExternal.DeleteFolderRecursive("/tmp" &/ modHelpVariable.AppName &/ "docs" &/ modHelpVariable.$SessionCode)
  modExternal.DeleteFolderRecursive(modHelpVariable.AppCacheDir)

End

Public Sub btnfullscreen_Click()

  If btnfullscreen.Image = "icon:/small/zoom-normal" Then
    btnfullscreen.Image = "icon:/small/zoom-fit"
    modBasic.$TabletModeEnable = "Yes"
    Me.Exec("openFullscreen()")

  Else If btnfullscreen.Image = "icon:/small/zoom-fit" Then
    btnfullscreen.Image = "icon:/small/zoom-normal"
    modBasic.$TabletModeEnable = "No"
    Me.Exec("closeFullscreen()")

  Endif

End

Public Sub btnqrcode_Click()

  Dim hForm As FmClinMobileList

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmClinMobileList(Workspace1)

End
