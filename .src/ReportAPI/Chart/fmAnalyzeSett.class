' Gambas class file

Private $sType As String
Private $sColm As String[]

Public Sub _new(sType As String, sColm As String[])

  Dim hForm As FmUnivariate
  Dim hForm1 As FmBivariate
  Dim hForm2 As FmGridSummary
  Dim hForm3 As FmCrossTabChart
  Dim hForm4 As FmRegression
  Dim hForm5 As FmTimeSeries

  $sType = sType
  $sColm = sColm

  Me.Title = $sType
  If $sType = "Univariate" Then
    hForm = New FmUnivariate(Panel1)
  Else If $sType = "Bivariate" Then
    hForm1 = New FmBivariate(Panel1)
  Else If $sType = "GridSummary" Then
    hForm2 = New FmGridSummary(Panel1)
  Else If $sType = "GridCrossTab" Then
    hForm3 = New FmCrossTabChart(Panel1)
  Else If $sType = "Regression" Then
    hForm4 = New FmRegression(Panel1)
  Else If $sType = "Time-Series" Then
    hForm5 = New FmTimeSeries(Panel1)
  Endif
  GetListData()

End

Private Sub GetListData()

  Dim xList As String[]
  Dim Row As Integer

  xList = New String[]
  Row = 1
  For Row = 0 To $sColm.Count - 1
    If $sColm[Row] Then
      xList.Add(CStr(Row + 1) & ". " & $sColm[Row])
    Else
      xList.Add(CStr(Row + 1) & ". X")
    Endif
  Next
  ListBox1.List = xList

End

Public Sub btngenerate_Click()

  Me.Close

End
