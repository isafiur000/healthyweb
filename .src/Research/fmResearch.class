' Gambas class file

' Export

Public Sub _new()

  Me.AddHeader("<meta name='viewport' content='width=device-width, initial-scale=1'>")
  Me.AddHeader("<link rel=\"stylesheet\" href=\"" & modHelpVariable.$AppCssPath & "\">")
  Me.AddJavascriptFile("js/jquery.min.js")
  Me.AddJavascriptFile("js/print.min.js")
  Me.AddJavascriptFile("js/toastify.js")
  Me.AddJavascriptFile("js/Chart.js")
  Me.AddJavascriptFile("js/tribute.js")
  Me.AddJavascriptFile("js/download.js")
  Me.AddJavascriptFile("js/select2.min.js")

  ' Me.AddJavascriptFile("js/sketchpad.js")
  ' Me.AddJavascriptFile("js/html5-qrcode.min.js")
  ' Me.AddJavascriptFile("js/webcodecamjs.js")
  Me.AddJavascriptFile("js/html2pdf.bundle.min.js")
  Me.AddJavascriptFile("js/xlsx.full.min.js")
  Me.AddJavascriptFile("js/webcontrols.js")
  Me.Font = MMain.$AppFontName
  WebImage1.Image = modHelpVariable.$headerImage
  WebForm.Debug = MMain.$isdebug
  mnucuruserid.Text = modBasic.$lbluser

End

Public Sub WebForm_Open()

  If MMain.$WebEntry = True Then
    modDataRepo.$RepositoryMode = MMain.$AppLogCategory
    modBasic.$HospCode = MMain.$AppLogString
  Endif
  modHelpVariable.SetApplicationGUI()
  MMain.GetApplVersionType()
  If modBasic.$LocalTableCaching = "Disable" Then
  Else
    ''table cache
    modTableCache.LoadServiceCostData(modDatabase.$myConn)
    modTableCache.LoadMedicineMasterData(modDatabase.$myConn)
    modTableCache.LoadSurgicalMasterData(modDatabase.$myConn)
    modTableCache.LoadStockEntryData(modDatabase.$myConn)
  Endif

  DiaplayCustMenu()
  ' ' DisplayExportData()
  ' ' DisplaySummaryData()
  modBasic.LoadClinicalChartSetting()
  modBasic.LoadClinicalLists()
  modBasic.ClinicalCommentSett()
  ' modBasic.LoadRegistrationSetting()
  ' modBasic.SetClinicalProcedures()
  ' modBasic.LoadLabRadioList()
  modBasic.FillMunicipalList()

  modBasic.SetAccountRules()
  modBasic.InventorySettings()
  modBasic.ChartSettingsAll()

  modLinkDB.LoadExtraDBSettings()
  If modHelpVariable.$IRDLevel = "Yes" Then
    mnuyearly.Visible = True
  Else
    mnuyearly.Visible = False
  Endif
  If MMain.$CustomFormat = "Nobel" Then
    mnuspecial.Visible = True
  Else
    mnuspecial.Visible = False
  Endif
  If modBasic.$ExpoRepoUser = True Then
  Else
    modBasic.$PatNameFormat = "***SurName"
  Endif

  modBasic.$ClinDietApprove = modGlobalSetting.ShowSettingFromDB("ClinicForms/User_DietApproval")
  modAyurv.$AyurvedicDiagnosis = modHelpVariable.$docsDirectory &/ "ayurvedicdisease.csv"
  SetFormAccess()
  DefaultFormLoad()

End

Private Sub DefaultFormLoad()

  Dim hForm As FmSummaryChart

  If Not Workspace1.Children.Count Then
    hForm = New FmSummaryChart(Workspace1)
  Endif

End

Private Sub SetFormAccess()

  modGeneralMain.ShowSelectedFormMenu(mnuhmis)
  modGeneralMain.ShowSelectedFormMenu(fmpatlist)
  modGeneralMain.ShowSelectedFormMenu(mnudept)
  modGeneralMain.ShowSelectedFormMenu(mnubedocc)
  modGeneralMain.ShowSelectedFormMenu(mnuopdlist)
  modGeneralMain.ShowSelectedFormMenu(mnuopvisits)

  modGeneralMain.ShowSelectedFormMenu(mnuconsreport)
  modGeneralMain.ShowSelectedFormMenu(mnuopvisit)
  modGeneralMain.ShowSelectedFormMenu(mnuipdates)
  modGeneralMain.ShowSelectedFormMenu(mnutrans)
  modGeneralMain.ShowSelectedFormMenu(mnuconfine)

  modGeneralMain.ShowSelectedFormMenu(mnudiagnosis)
  modGeneralMain.ShowSelectedFormMenu(mnuprocerepo)
  modGeneralMain.ShowSelectedFormMenu(mnuequiprepo)
  modGeneralMain.ShowSelectedFormMenu(mnudeviceuse)
  modGeneralMain.ShowSelectedFormMenu(mnumedquery)
  modGeneralMain.ShowSelectedFormMenu(mnunutrition)

  modGeneralMain.ShowSelectedFormMenu(mnuexamall)
  modGeneralMain.ShowSelectedFormMenu(mnucustdept)
  modGeneralMain.ShowSelectedFormMenu(mnulabrep)
  modGeneralMain.ShowSelectedFormMenu(mnusensireport)
  modGeneralMain.ShowSelectedFormMenu(mnuradiorep)

  modGeneralMain.ShowSelectedFormMenu(mnurecord)
  modGeneralMain.ShowSelectedFormMenu(mnuquery)
  modGeneralMain.ShowSelectedFormMenu(mnuclinsearch)
  modGeneralMain.ShowSelectedFormMenu(mnuimagesearch)
  modGeneralMain.ShowSelectedFormMenu(mnupacsrepo)
  modGeneralMain.ShowSelectedFormMenu(mnusearchdb)

  modGeneralMain.ShowSelectedFormMenu(mnuaccrepoall)
  modGeneralMain.ShowSelectedFormMenu(mnuserv)
  modGeneralMain.ShowSelectedFormMenu(mnugrpreport)
  modGeneralMain.ShowSelectedFormMenu(mnufacultyrepo)
  modGeneralMain.ShowSelectedFormMenu(mnugeneric)
  modGeneralMain.ShowSelectedFormMenu(mnusharing)
  modGeneralMain.ShowSelectedFormMenu(mnubill)
  modGeneralMain.ShowSelectedFormMenu(mnubillsummary)
  modGeneralMain.ShowSelectedFormMenu(mnudeposit)
  modGeneralMain.ShowSelectedFormMenu(mnuvouchers)
  modGeneralMain.ShowSelectedFormMenu(mnupur)
  modGeneralMain.ShowSelectedFormMenu(mnuinventory)
  modGeneralMain.ShowSelectedFormMenu(mnutransfer)
  modGeneralMain.ShowSelectedFormMenu(mnumedsales)
  modGeneralMain.ShowSelectedFormMenu(mnuarchive)

  modGeneralMain.ShowSelectedFormMenu(mnucustreport)
  modGeneralMain.ShowSelectedFormMenu(mnupersonal)

End

Public Sub mnuexit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub WebForm_Close()

  modDevice.CamOnClose()
  modDatabase.CloseDatabase()
  modExternal.DeleteFolderRecursive("/tmp" &/ modHelpVariable.AppName &/ "docs" &/ modHelpVariable.$SessionCode)
  modExternal.DeleteFolderRecursive(modHelpVariable.AppCacheDir)

End

Public Sub mnunewextra_Click()

  Dim xLink As String = "http://bitnepal.safiur.com.np/healthybit/help/" & modHelpVariable.$LogInCategory & "/"

  Me.Exec("window.open('" & xLink & "'); ")

End

Public Sub mnuclearcache_Click()

  modGeneralMain.CLearUserCollection()

End

Public Sub mnubugrepo_Click()

  modGeneralMain.SendBugReport(modBasic.$lbluser)

End

' Public Sub WebContainer2_Render()
'
'   Print "<iframe src='" & modBasic.$FormLeftURL & "' width='100%' height='100%'></iframe>";
'
' End
'
' Public Sub WebContainer3_Render()
'
'   Print "<iframe src='" & modBasic.$FormRightURL & "' width='100%' height='100%'></iframe>";
'
' End

Public Sub btnquit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub btnfullscreen_Click()

  If btnfullscreen.Image = "icon:/small/zoom-normal" Then
    btnfullscreen.Image = "icon:/small/zoom-fit"
    Me.Exec("openFullscreen()")

  Else If btnfullscreen.Image = "icon:/small/zoom-fit" Then
    btnfullscreen.Image = "icon:/small/zoom-normal"
    Me.Exec("closeFullscreen()")

  Endif

End

''---------------------------------------- CustomAccount Reports -------------------------------------
Private Sub DiaplayCustMenu()

  If modSettings.ShowSettingForReport("Research.CustomQuery1/Name") Then
    mnucust1.Title = modSettings.ShowSettingForReport("Research.CustomQuery1/Name")
    mnucust1.Tag = "Research.CustomQuery1"
    mnucust1.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Research.CustomQuery2/Name") Then
    mnucust2.Title = modSettings.ShowSettingForReport("Research.CustomQuery2/Name")
    mnucust2.Tag = "Research.CustomQuery2"
    mnucust2.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Research.CustomQuery3/Name") Then
    mnucust3.Title = modSettings.ShowSettingForReport("Research.CustomQuery3/Name")
    mnucust3.Tag = "Research.CustomQuery3"
    mnucust3.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Research.CustomQuery4/Name") Then
    mnucust4.Title = modSettings.ShowSettingForReport("Research.CustomQuery4/Name")
    mnucust4.Tag = "Research.CustomQuery4"
    mnucust4.Visible = True
  Endif

  If modSettings.ShowSettingForReport("Research.CustomQuery5/Name") Then
    mnucust5.Title = modSettings.ShowSettingForReport("Research.CustomQuery5/Name")
    mnucust5.Tag = "Research.CustomQuery5"
    mnucust5.Visible = True
  Endif

End

Public Sub mnucust1_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust1.Tag, Workspace1)

End

Public Sub mnucust2_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust2.Tag, Workspace1)

End

Public Sub mnucust3_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust3.Tag, Workspace1)

End

Public Sub mnucust4_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust4.Tag, Workspace1)

End

Public Sub mnucust5_Click()

  Dim hForm As FmCustQueryTable

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustQueryTable(modDatabase.$syConn, mnucust5.Tag, Workspace1)

End

Public Sub mnucustsetting_Click()

  fmCusAccReport.ShowModal

End

''=======================================
Public Sub mnudashmain_Click()

  Dim hForm As FmSummaryChart

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmSummaryChart(Workspace1)

End

Public Sub mnuhmis_Click()

  Dim hForm As FmHMISRepo
  ' Dim hForm1 As FmAMISRepo

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  If MMain.$Ayurveda = "Yes" Then
    ' hForm1 = New FmAMISRepo(Workspace1)
  Else
    hForm = New FmHMISRepo(Workspace1)
  Endif

End

Public Sub mnubedocc_Click()

  Dim hForm As FmClinBedList

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmClinBedList(Workspace1)

End

Public Sub mnuopdlist_Click()

  Dim hForm As FmClinOPDList

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmClinOPDList("tblconsult", Workspace1)

End

Public Sub mnuopvisits_Click()

  Dim hForm As FmClinOPDList

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmClinOPDList("tblopvisit", Workspace1)

End

Public Sub fmpatlist_Click()

  Dim hForm As FmPatIdentity

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmPatIdentity(Workspace1)

End

Public Sub mnuaccrepoall_Click()

  Dim hForm As FmSummryReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmSummryReport(Workspace1)

End

Public Sub mnudept_Click()

  Dim hForm As FmPatAdmit

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmPatAdmit(Workspace1)

End

Public Sub mnuipdates_Click()

  Dim hForm As FmClinSummary

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmClinSummary(Workspace1)

End

Public Sub mnutrans_Click()

  Dim hForm As FmBedReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmBedReport(Workspace1)

End

Public Sub mnuconsreport_Click()

  Dim hForm As FmConsultReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmConsultReport(Workspace1)

End

Public Sub mnuopvisit_Click()

  Dim hForm As FmOpVisitReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmOpVisitReport(Workspace1)

End

Public Sub mnudiagnosis_Click()

  Dim hForm As FmDiagnosisReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmDiagnosisReport(Workspace1)

End

Public Sub mnuprocerepo_Click()

  Dim hForm As FmProcedReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmProcedReport(Workspace1)

End

Public Sub mnuequiprepo_Click()

  Dim hForm As FmEquipReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmEquipReport(Workspace1)

End

Public Sub mnudeviceuse_Click()

  Dim hForm As FmEventReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmEventReport("Devices", Workspace1)

End

Public Sub mnumedquery_Click()

  Dim hForm As FmDrugSearch

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmDrugSearch(Workspace1)

End

Public Sub mnunutrition_Click()

  Dim hForm As FmDietReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmDietReport(Workspace1)

End

Public Sub mnuconfine_Click()

  Dim hForm As FmConfinement

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmConfinement(Workspace1)

End

Public Sub mnuexamall_Click()

  Dim hForm As FmExamAll

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmExamAll(Workspace1)

End

Public Sub mnucustdept_Click()

  Dim hForm As FmCustExamReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmCustExamReport(Workspace1)

End

Public Sub mnulabrep_Click()

  Dim hForm As FmSampReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmSampReport(Workspace1)

End

Public Sub mnusensireport_Click()

  Dim hForm As FmSensiReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmSensiReport(Workspace1)

End

Public Sub mnuradiorep_Click()

  Dim hForm As FmSampRadio

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmSampRadio(Workspace1)

End

Public Sub mnurecord_Click()

  Dim hForm As FmMedSearch

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmMedSearch(Workspace1)

End

Public Sub mnuquery_Click()

  Dim hForm As FmMedStat

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmMedStat(Workspace1)

End

Public Sub mnuclinsearch_Click()

  Dim hForm As FmPatclinSearch

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmPatclinSearch(Workspace1)

End

Public Sub mnuimagesearch_Click()

  Dim hForm As FmImageSearch

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmImageSearch(Workspace1)

End

Public Sub mnupacsrepo_Click()

  Dim hForm As FmPacsReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmPacsReport(Workspace1)

End

Public Sub mnuarchive_Click()

  Dim hForm As FmPatReports

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmPatReports("", Workspace1)

End

Public Sub mnusearchdb_Click()

  Dim hForm As FmFIndRecord

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmFIndRecord(Workspace1)

End

Public Sub mnuchartset_Click()

  fmChartSetting.ShowModal

End

Public Sub mnureposetting_Click()

  fmReportSetting.ShowModal

End

''=============== Special Reports =============
' Public Sub mnuspecreport_Click()
'
'   fmNobelHospital.ShowModal
'
' End
'
' Public Sub mnulabreceipt_Click()
'
'   Dim hForm As FmTempBillRecordNobel
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmTempBillRecordNobel(Workspace1)
'
' End
'
' Public Sub mnundcinvoice_Click()
'
'   Dim hForm As FmPatBillRecordNDC
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmPatBillRecordNDC(Workspace1)
'
' End
'
' Public Sub mnunlnpinvoice_Click()
'
'   Dim hForm As FmPatBillRecordNLNP
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmPatBillRecordNLNP(Workspace1)
'
' End

''=============== Reports ================
Public Sub mnugeneric_Click()

  Dim hForm As FmGroupCateg

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmGroupCateg(Workspace1)

End

Public Sub mnuserv_Click()

  Dim hForm As Fmservreport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New Fmservreport(Workspace1)

End

Public Sub mnugrpreport_Click()

  Dim hForm As FmGroupReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmGroupReport(Workspace1)

End

Public Sub mnufacultyrepo_Click()

  Dim hForm As FmMasterReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmMasterReport(Workspace1)

End

Public Sub mnusharing_Click()

  Dim hForm As Fmsharereport
  Dim hForm1 As FmshareGroup

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  If modBasic.$PayableCalculation = "Mixed" Then
    hForm = New Fmsharereport(Workspace1)
  Else
    hForm1 = New FmshareGroup(Workspace1)
  Endif

End

Public Sub mnubill_Click()

  Dim hForm As FmPatBillRecord

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmPatBillRecord(Workspace1)

End

Public Sub mnudeposit_Click()

  Dim hForm As FmDepositReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmDepositReport(Workspace1)

End

Public Sub mnuvouchers_Click()

  Dim hForm As FmVoucherReport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmVoucherReport(Workspace1)

End

Public Sub mnusalesreport_Click()

  Dim xType As String
  Dim xdate As Date[]
  Dim inidate As Date
  Dim lstdate As Date
  Dim xPath As String

  xType = InputCombo("Select Sales Book Format", "Sales Book", ["Sales Book", "Sales Return", "Sales Book(All)"], "Sales Book(All)", True)
  If xType Then
    xdate = DoubleDates("Select Dates", "Sales Book", [Now(), Now()])
    If xdate Then
      inidate = xdate[0]
      lstdate = xdate[1]

      If inidate And If lstdate Then
        xPath = modHTMLStock.GetIRDSalesBook(xType, inidate, lstdate)
        modControlSub.DisplayReportExport(xPath)
      Endif
    Endif
  Endif

End

Public Sub mnuyearly_Click()

  Dim xdate As Date[]
  Dim inidate As Date
  Dim lstdate As Date
  Dim res As Result
  Dim hForm As FRequest

  xdate = DoubleDates("Select Dates", "Yearly Report", [Now(), Now()])
  If xdate Then
    inidate = xdate[0]
    lstdate = xdate[1]

    If inidate And If lstdate Then
      res = modDatabase.$syConn.Exec("select fldfiscal,fldbillno,fldpatname,fldpan,flddate,flditemamt,flddiscountamt,fldtaxable,fldtaxamt,fldtotamt,fldsync,fldprinted,fldactive,flddate,fldpunch,fldprint,xyz from tblfiscal where flddate>=&1 and flddate<=&2", modDate.StartSqlDate(inidate), modDate.EndSqlDate(lstdate))                                                                ''
      hForm = New FRequest(res, "Yearly Report", "YearReport", True)
      hForm.ShowModal
    Endif
  Endif

End

Public Sub mnupur_Click()

  Dim hForm As FmSupplier

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmSupplier(Workspace1)

End

Public Sub mnuinventory_Click()

  Dim hForm As Fmmedreport

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New Fmmedreport(Workspace1)

End

Public Sub mnutransfer_Click()

  Dim hForm As FmmedTransfer

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmmedTransfer(Workspace1)

End

Public Sub mnupersonal_Click()

  Dim hForm As FmPersonal

  If Workspace1.Children.Count Then
    Workspace1.DeleteChildren()
  Endif
  hForm = New FmPersonal(Workspace1)

End

Public Sub mnucuruserid_Click()

  Dim hForm As FmReportUsers

  If modBasic.$lbluser Then
    hForm = New FmReportUsers(modBasic.$lbluser)
    hForm.ShowModal
  Endif

End

Public Sub mnudarkmode_Click()

  Me.Exec("changeScreenMode();")

End

Public Sub mnupassword_Click()

  modGeneral.GetUpdatePassword()

End

Public Sub mnudashupload_Click()

  Dim sDate As Date

  ' sDate = Date("2025", "01", "02")
  sDate = Now()
  modBagmatiDash.LoadBagmatiDash(sDate)

End
