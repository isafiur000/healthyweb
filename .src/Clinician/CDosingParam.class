' Gambas class file

Private $encid As String
Private $patGender As String
Private $patAge As Float
Private $serumCreat As Float

Private $actualWeight As Float
Private $patHeight As Float
Private $idealWeight As Float
Private $bodySurArea As Float
Private $creatClear As Float

Public Sub _new(encid As String)

  $encid = encid
  CalculateValues()

End

Private Sub CalculateValues()

  Dim xcreat As Variant

  $actualWeight = modClinic.GetBodyWeight($encid)
  $patHeight = modClinic.GetPatientHeightinCm($encid)
  $patGender = modPatient.GetPatientSex($encid)
  $patAge = DateDiff(modPatient.GetPatientBirthDay($encid), Now(), gb.Year)
  xcreat = modLabTest.GetCurrTesValuePos("Last", $encid, modFixLab.GetLabTestIDFromSysConst("Creatinine_Serum"), MMain.$defUnit)
  If xcreat Then
    $serumCreat = xcreat
  Else
    $serumCreat = 0
  Endif

  $idealWeight = modSysCons.GetCalculationForSetA("Ideal_Body_Weight", $patGender, $patAge, $actualWeight, $patHeight, 0)
  $bodySurArea = modSysCons.GetCalculationForSetA("Body_Surface_Area", $patGender, $patAge, $actualWeight, $patHeight, 0)
  $creatClear = modSysCons.GetCalculationForSetA("Creatinine_Clearance", $patGender, $patAge, $actualWeight, $patHeight, $serumCreat)

End

Public Function GetActualWeight() As Float

  Return $actualWeight

End

Public Function GetPatientHeight() As Float

  Return $patHeight

End

Public Function GetIdealBodyWeight() As Float

  Return $idealWeight

End

Public Function GetBodySurfaceArea() As Float

  Return $bodySurArea

End

Public Function GetCreatinineClearance() As Float

  Return $creatClear

End
